<!DOCTYPE html><html  lang="en" data-capo=""><head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Stripe Integration in Nuxt 3</title>
<meta property="og:image" content="https://codybontecou.com/__og-image__/static/stripe-integration-in-nuxt-3/og.png">
<meta property="og:image:type" content="image/png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://codybontecou.com/__og-image__/static/stripe-integration-in-nuxt-3/og.png">
<meta name="twitter:image:src" content="https://codybontecou.com/__og-image__/static/stripe-integration-in-nuxt-3/og.png">
<meta property="og:image:width" content="1200">
<meta name="twitter:image:width" content="1200">
<meta property="og:image:height" content="600">
<meta name="twitter:image:height" content="600">
<style>p:has(img){align-items:center;display:flex;justify-content:center}img{border-radius:20px;box-shadow:0 7px 29px 0 hsla(240,5%,41%,.2);max-height:600px}@media screen and (max-width:768px){img{max-height:400px}}code{white-space:pre-wrap;word-wrap:break-word;max-width:100%;overflow-wrap:break-word}</style>
<style>*,:after,:before{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/*! tailwindcss v3.4.14 | MIT License | https://tailwindcss.com*/*,:after,:before{border:0 solid #e5e7eb;box-sizing:border-box}:after,:before{--tw-content:""}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;font-family:ui-sans-serif,system-ui,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;font-feature-settings:normal;font-variation-settings:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-tap-highlight-color:transparent}body{line-height:inherit;margin:0}hr{border-top-width:1px;color:inherit;height:0}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-feature-settings:normal;font-size:1em;font-variation-settings:normal}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{border-collapse:collapse;border-color:inherit;text-indent:0}button,input,optgroup,select,textarea{color:inherit;font-family:inherit;font-feature-settings:inherit;font-size:100%;font-variation-settings:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0}fieldset,legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{color:#9ca3af;opacity:1}input::placeholder,textarea::placeholder{color:#9ca3af;opacity:1}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{height:auto;max-width:100%}[hidden]:where(:not([hidden=until-found])){display:none}:root{--background:rgba(121,248,252,.15);--foreground:222.2 84% 4.9%;--muted:210 40% 96.1%;--muted-foreground:215.4 16.3% 46.9%;--popover:0 0% 100%;--popover-foreground:222.2 84% 4.9%;--card:0 0% 100%;--card-foreground:222.2 84% 4.9%;--border:214.3 31.8% 91.4%;--input:214.3 31.8% 91.4%;--primary:222.2 47.4% 11.2%;--primary-foreground:210 40% 98%;--secondary:210 40% 96.1%;--secondary-foreground:222.2 47.4% 11.2%;--accent:210 40% 96.1%;--accent-foreground:222.2 47.4% 11.2%;--destructive:0 84.2% 60.2%;--destructive-foreground:210 40% 98%;--ring:222.2 84% 4.9%;--radius:0.5rem}.dark{--background:rgba(121,248,252,.15);--foreground:210 40% 98%;--muted:217.2 32.6% 17.5%;--muted-foreground:215 20.2% 65.1%;--popover:222.2 84% 4.9%;--popover-foreground:210 40% 98%;--card:222.2 84% 4.9%;--card-foreground:210 40% 98%;--border:217.2 32.6% 17.5%;--input:217.2 32.6% 17.5%;--primary:210 40% 98%;--primary-foreground:222.2 47.4% 11.2%;--secondary:217.2 32.6% 17.5%;--secondary-foreground:210 40% 98%;--accent:217.2 32.6% 17.5%;--accent-foreground:210 40% 98%;--destructive:0 62.8% 30.6%;--destructive-foreground:210 40% 98%;--ring:212.7 26.8% 83.9%}*{border-color:hsl(var(--border))}body{color:hsl(var(--foreground))}.container{margin-left:auto;margin-right:auto;padding-left:2rem;padding-right:2rem;width:100%}@media (min-width:1400px){.container{max-width:1400px}}.prose{color:var(--tw-prose-body);max-width:65ch}.prose :where(p):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.25em;margin-top:1.25em}.prose :where([class~=lead]):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-lead);font-size:1.25em;line-height:1.6;margin-bottom:1.2em;margin-top:1.2em}.prose :where(a):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-links);font-weight:500;text-decoration:underline}.prose :where(strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-bold);font-weight:600}.prose :where(a strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(blockquote strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(thead th strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(ol):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:decimal;margin-bottom:1.25em;margin-top:1.25em;padding-inline-start:1.625em}.prose :where(ol[type=A]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:upper-alpha}.prose :where(ol[type=a]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:lower-alpha}.prose :where(ol[type=A s]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:upper-alpha}.prose :where(ol[type=a s]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:lower-alpha}.prose :where(ol[type=I]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:upper-roman}.prose :where(ol[type=i]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:lower-roman}.prose :where(ol[type=I s]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:upper-roman}.prose :where(ol[type=i s]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:lower-roman}.prose :where(ol[type="1"]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:decimal}.prose :where(ul):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:disc;margin-bottom:1.25em;margin-top:1.25em;padding-inline-start:1.625em}.prose :where(ol>li):not(:where([class~=not-prose],[class~=not-prose] *))::marker{color:var(--tw-prose-counters);font-weight:400}.prose :where(ul>li):not(:where([class~=not-prose],[class~=not-prose] *))::marker{color:var(--tw-prose-bullets)}.prose :where(dt):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);font-weight:600;margin-top:1.25em}.prose :where(hr):not(:where([class~=not-prose],[class~=not-prose] *)){border-color:var(--tw-prose-hr);border-top-width:1px;margin-bottom:3em;margin-top:3em}.prose :where(blockquote):not(:where([class~=not-prose],[class~=not-prose] *)){border-inline-start-color:var(--tw-prose-quote-borders);border-inline-start-width:.25rem;color:var(--tw-prose-quotes);font-style:italic;font-weight:500;margin-bottom:1.6em;margin-top:1.6em;padding-inline-start:1em;quotes:"\201C""\201D""\2018""\2019"}.prose :where(blockquote p:first-of-type):not(:where([class~=not-prose],[class~=not-prose] *)):before{content:open-quote}.prose :where(blockquote p:last-of-type):not(:where([class~=not-prose],[class~=not-prose] *)):after{content:close-quote}.prose :where(h1):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);font-size:2.25em;font-weight:800;line-height:1.1111111;margin-bottom:.8888889em;margin-top:0}.prose :where(h1 strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit;font-weight:900}.prose :where(h2):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);font-size:1.5em;font-weight:700;line-height:1.3333333;margin-bottom:1em;margin-top:2em}.prose :where(h2 strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit;font-weight:800}.prose :where(h3):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);font-size:1.25em;font-weight:600;line-height:1.6;margin-bottom:.6em;margin-top:1.6em}.prose :where(h3 strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit;font-weight:700}.prose :where(h4):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);font-weight:600;line-height:1.5;margin-bottom:.5em;margin-top:1.5em}.prose :where(h4 strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit;font-weight:700}.prose :where(img):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:2em;margin-top:2em}.prose :where(picture):not(:where([class~=not-prose],[class~=not-prose] *)){display:block;margin-bottom:2em;margin-top:2em}.prose :where(video):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:2em;margin-top:2em}.prose :where(kbd):not(:where([class~=not-prose],[class~=not-prose] *)){border-radius:.3125rem;box-shadow:0 0 0 1px rgb(var(--tw-prose-kbd-shadows)/10%),0 3px 0 rgb(var(--tw-prose-kbd-shadows)/10%);color:var(--tw-prose-kbd);font-family:inherit;font-size:.875em;font-weight:500;padding-inline-end:.375em;padding-bottom:.1875em;padding-top:.1875em;padding-inline-start:.375em}.prose :where(code):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-code);font-size:.875em;font-weight:600}.prose :where(code):not(:where([class~=not-prose],[class~=not-prose] *)):before{content:"`"}.prose :where(code):not(:where([class~=not-prose],[class~=not-prose] *)):after{content:"`"}.prose :where(a code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(h1 code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(h2 code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit;font-size:.875em}.prose :where(h3 code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit;font-size:.9em}.prose :where(h4 code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(blockquote code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(thead th code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(pre):not(:where([class~=not-prose],[class~=not-prose] *)){background-color:var(--tw-prose-pre-bg);border-radius:.375rem;color:var(--tw-prose-pre-code);font-size:.875em;font-weight:400;line-height:1.7142857;margin-bottom:1.7142857em;margin-top:1.7142857em;overflow-x:auto;padding-inline-end:1.1428571em;padding-bottom:.8571429em;padding-top:.8571429em;padding-inline-start:1.1428571em}.prose :where(pre code):not(:where([class~=not-prose],[class~=not-prose] *)){background-color:transparent;border-radius:0;border-width:0;color:inherit;font-family:inherit;font-size:inherit;font-weight:inherit;line-height:inherit;padding:0}.prose :where(pre code):not(:where([class~=not-prose],[class~=not-prose] *)):before{content:none}.prose :where(pre code):not(:where([class~=not-prose],[class~=not-prose] *)):after{content:none}.prose :where(table):not(:where([class~=not-prose],[class~=not-prose] *)){font-size:.875em;line-height:1.7142857;margin-bottom:2em;margin-top:2em;table-layout:auto;width:100%}.prose :where(thead):not(:where([class~=not-prose],[class~=not-prose] *)){border-bottom-color:var(--tw-prose-th-borders);border-bottom-width:1px}.prose :where(thead th):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);font-weight:600;padding-inline-end:.5714286em;padding-bottom:.5714286em;padding-inline-start:.5714286em;vertical-align:bottom}.prose :where(tbody tr):not(:where([class~=not-prose],[class~=not-prose] *)){border-bottom-color:var(--tw-prose-td-borders);border-bottom-width:1px}.prose :where(tbody tr:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){border-bottom-width:0}.prose :where(tbody td):not(:where([class~=not-prose],[class~=not-prose] *)){vertical-align:baseline}.prose :where(tfoot):not(:where([class~=not-prose],[class~=not-prose] *)){border-top-color:var(--tw-prose-th-borders);border-top-width:1px}.prose :where(tfoot td):not(:where([class~=not-prose],[class~=not-prose] *)){vertical-align:top}.prose :where(th,td):not(:where([class~=not-prose],[class~=not-prose] *)){text-align:start}.prose :where(figure>*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:0;margin-top:0}.prose :where(figcaption):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-captions);font-size:.875em;line-height:1.4285714;margin-top:.8571429em}.prose{--tw-prose-body:#374151;--tw-prose-headings:#111827;--tw-prose-lead:#4b5563;--tw-prose-links:#111827;--tw-prose-bold:#111827;--tw-prose-counters:#6b7280;--tw-prose-bullets:#d1d5db;--tw-prose-hr:#e5e7eb;--tw-prose-quotes:#111827;--tw-prose-quote-borders:#e5e7eb;--tw-prose-captions:#6b7280;--tw-prose-kbd:#111827;--tw-prose-kbd-shadows:17 24 39;--tw-prose-code:#111827;--tw-prose-pre-code:#e5e7eb;--tw-prose-pre-bg:#1f2937;--tw-prose-th-borders:#d1d5db;--tw-prose-td-borders:#e5e7eb;--tw-prose-invert-body:#d1d5db;--tw-prose-invert-headings:#fff;--tw-prose-invert-lead:#9ca3af;--tw-prose-invert-links:#fff;--tw-prose-invert-bold:#fff;--tw-prose-invert-counters:#9ca3af;--tw-prose-invert-bullets:#4b5563;--tw-prose-invert-hr:#374151;--tw-prose-invert-quotes:#f3f4f6;--tw-prose-invert-quote-borders:#374151;--tw-prose-invert-captions:#9ca3af;--tw-prose-invert-kbd:#fff;--tw-prose-invert-kbd-shadows:255 255 255;--tw-prose-invert-code:#fff;--tw-prose-invert-pre-code:#d1d5db;--tw-prose-invert-pre-bg:rgba(0,0,0,.5);--tw-prose-invert-th-borders:#4b5563;--tw-prose-invert-td-borders:#374151;font-size:1rem;line-height:1.75}.prose :where(picture>img):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:0;margin-top:0}.prose :where(li):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:.5em;margin-top:.5em}.prose :where(ol>li):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-start:.375em}.prose :where(ul>li):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-start:.375em}.prose :where(.prose>ul>li p):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:.75em;margin-top:.75em}.prose :where(.prose>ul>li>p:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.25em}.prose :where(.prose>ul>li>p:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.25em}.prose :where(.prose>ol>li>p:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.25em}.prose :where(.prose>ol>li>p:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.25em}.prose :where(ul ul,ul ol,ol ul,ol ol):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:.75em;margin-top:.75em}.prose :where(dl):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.25em;margin-top:1.25em}.prose :where(dd):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:.5em;padding-inline-start:1.625em}.prose :where(hr+*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose :where(h2+*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose :where(h3+*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose :where(h4+*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose :where(thead th:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-start:0}.prose :where(thead th:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-end:0}.prose :where(tbody td,tfoot td):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-end:.5714286em;padding-bottom:.5714286em;padding-top:.5714286em;padding-inline-start:.5714286em}.prose :where(tbody td:first-child,tfoot td:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-start:0}.prose :where(tbody td:last-child,tfoot td:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-end:0}.prose :where(figure):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:2em;margin-top:2em}.prose :where(.prose>:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose :where(.prose>:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:0}.pointer-events-none{pointer-events:none}.pointer-events-auto{pointer-events:auto}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.sticky{position:sticky}.inset-0{inset:0}.inset-x-0{left:0;right:0}.-bottom-1{bottom:-.25rem}.-top-1{top:-.25rem}.bottom-0{bottom:0}.bottom-4{bottom:1rem}.left-0{left:0}.left-1\/2{left:50%}.right-0{right:0}.right-2{right:.5rem}.right-4{right:1rem}.right-8{right:2rem}.top-0{top:0}.top-1\/2{top:50%}.top-2{top:.5rem}.top-32{top:8rem}.top-4{top:1rem}.isolate{isolation:isolate}.z-10{z-index:10}.z-20{z-index:20}.z-30{z-index:30}.z-40{z-index:40}.z-\[100\]{z-index:100}.mx-auto{margin-left:auto;margin-right:auto}.my-10{margin-bottom:2.5rem;margin-top:2.5rem}.my-20{margin-bottom:5rem;margin-top:5rem}.my-4{margin-bottom:1rem;margin-top:1rem}.-mb-14{margin-bottom:-3.5rem}.-mt-2{margin-top:-.5rem}.mb-0{margin-bottom:0}.mb-1{margin-bottom:.25rem}.mb-10{margin-bottom:2.5rem}.mb-12{margin-bottom:3rem}.mb-16{margin-bottom:4rem}.mb-2{margin-bottom:.5rem}.mb-4{margin-bottom:1rem}.mb-6{margin-bottom:1.5rem}.mb-8{margin-bottom:2rem}.ml-1{margin-left:.25rem}.ml-2{margin-left:.5rem}.ml-3{margin-left:.75rem}.mr-2{margin-right:.5rem}.mt-10{margin-top:2.5rem}.mt-16{margin-top:4rem}.mt-2{margin-top:.5rem}.mt-4{margin-top:1rem}.mt-6{margin-top:1.5rem}.mt-8{margin-top:2rem}.block{display:block}.inline-block{display:inline-block}.inline{display:inline}.flex{display:flex}.inline-flex{display:inline-flex}.table{display:table}.grid{display:grid}.contents{display:contents}.hidden{display:none}.h-10{height:2.5rem}.h-4{height:1rem}.h-5{height:1.25rem}.h-6{height:1.5rem}.h-8{height:2rem}.h-9{height:2.25rem}.h-\[1px\]{height:1px}.h-full{height:100%}.h-px{height:1px}.h-screen{height:100vh}.max-h-\[75vh\]{max-height:75vh}.max-h-\[80vh\]{max-height:80vh}.max-h-\[calc\(100vh-200px\)\]{max-height:calc(100vh - 200px)}.max-h-screen{max-height:100vh}.w-1\/2{width:50%}.w-1\/4{width:25%}.w-10{width:2.5rem}.w-11{width:2.75rem}.w-2\/3{width:66.666667%}.w-3\/4{width:75%}.w-3\/6{width:50%}.w-4{width:1rem}.w-4\/6{width:66.666667%}.w-44{width:11rem}.w-5{width:1.25rem}.w-5\/6{width:83.333333%}.w-6{width:1.5rem}.w-64{width:16rem}.w-9{width:2.25rem}.w-\[1px\]{width:1px}.w-full{width:100%}.w-px{width:1px}.w-screen{width:100vw}.max-w-2xl{max-width:42rem}.max-w-3xl{max-width:48rem}.max-w-4xl{max-width:56rem}.max-w-7xl{max-width:80rem}.max-w-lg{max-width:32rem}.max-w-md{max-width:28rem}.max-w-min{max-width:-moz-min-content;max-width:min-content}.flex-none{flex:none}.flex-shrink-0{flex-shrink:0}.shrink{flex-shrink:1}.shrink-0{flex-shrink:0}.grow{flex-grow:1}.-translate-x-1\/2{--tw-translate-x:-50%}.-translate-x-1\/2,.-translate-x-\[90\%\]{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-translate-x-\[90\%\]{--tw-translate-x:-90%}.-translate-y-1\/2{--tw-translate-y:-50%}.-translate-y-1\/2,.translate-x-0{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-x-0{--tw-translate-x:0px}.translate-x-5{--tw-translate-x:1.25rem}.translate-x-5,.translate-y-0{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-y-0{--tw-translate-y:0px}.translate-y-1{--tw-translate-y:0.25rem}.translate-y-1,.translate-y-full{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-y-full{--tw-translate-y:100%}.transform{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}@keyframes pulse{50%{opacity:.5}}.animate-pulse{animation:pulse 2s cubic-bezier(.4,0,.6,1) infinite}.cursor-pointer{cursor:pointer}.list-inside{list-style-position:inside}.list-decimal{list-style-type:decimal}.list-disc{list-style-type:disc}.list-none{list-style-type:none}.grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.flex-col{flex-direction:column}.flex-col-reverse{flex-direction:column-reverse}.flex-wrap{flex-wrap:wrap}.items-start{align-items:flex-start}.items-center{align-items:center}.items-baseline{align-items:baseline}.justify-start{justify-content:flex-start}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-1{gap:.25rem}.gap-2{gap:.5rem}.gap-4{gap:1rem}.gap-6{gap:1.5rem}.gap-x-1{-moz-column-gap:.25rem;column-gap:.25rem}.gap-x-2{-moz-column-gap:.5rem;column-gap:.5rem}.gap-x-2\.5{-moz-column-gap:.625rem;column-gap:.625rem}.gap-x-3{-moz-column-gap:.75rem;column-gap:.75rem}.gap-x-4{-moz-column-gap:1rem;column-gap:1rem}.gap-y-1\.5{row-gap:.375rem}.gap-y-8{row-gap:2rem}.space-x-1\.5>:not([hidden])~:not([hidden]){--tw-space-x-reverse:0;margin-left:calc(.375rem*(1 - var(--tw-space-x-reverse)));margin-right:calc(.375rem*var(--tw-space-x-reverse))}.space-x-4>:not([hidden])~:not([hidden]){--tw-space-x-reverse:0;margin-left:calc(1rem*(1 - var(--tw-space-x-reverse)));margin-right:calc(1rem*var(--tw-space-x-reverse))}.space-y-1>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(.25rem*var(--tw-space-y-reverse));margin-top:calc(.25rem*(1 - var(--tw-space-y-reverse)))}.space-y-2>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(.5rem*var(--tw-space-y-reverse));margin-top:calc(.5rem*(1 - var(--tw-space-y-reverse)))}.space-y-3>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(.75rem*var(--tw-space-y-reverse));margin-top:calc(.75rem*(1 - var(--tw-space-y-reverse)))}.space-y-4>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(1rem*var(--tw-space-y-reverse));margin-top:calc(1rem*(1 - var(--tw-space-y-reverse)))}.self-end{align-self:flex-end}.overflow-hidden{overflow:hidden}.overflow-y-auto{overflow-y:auto}.truncate{overflow:hidden;text-overflow:ellipsis}.truncate,.whitespace-nowrap{white-space:nowrap}.break-keep{word-break:keep-all}.rounded{border-radius:.25rem}.rounded-3xl{border-radius:1.5rem}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:var(--radius)}.rounded-md{border-radius:calc(var(--radius) - 2px)}.rounded-xl{border-radius:calc(var(--radius) + 4px)}.rounded-t-xl{border-top-left-radius:calc(var(--radius) + 4px);border-top-right-radius:calc(var(--radius) + 4px)}.border{border-width:1px}.border-2{border-width:2px}.border-\[12px\]{border-width:12px}.border-b{border-bottom-width:1px}.border-solid{border-style:solid}.border-destructive{border-color:hsl(var(--destructive))}.border-gray-200{--tw-border-opacity:1;border-color:rgb(229 231 235/var(--tw-border-opacity))}.border-green-500{--tw-border-opacity:1;border-color:rgb(34 197 94/var(--tw-border-opacity))}.border-indigo-500{--tw-border-opacity:1;border-color:rgb(99 102 241/var(--tw-border-opacity))}.border-input{border-color:hsl(var(--input))}.border-red-500{--tw-border-opacity:1;border-color:rgb(239 68 68/var(--tw-border-opacity))}.border-transparent{border-color:transparent}.bg-background{background-color:hsl(var(--background))}.bg-black{--tw-bg-opacity:1;background-color:rgb(0 0 0/var(--tw-bg-opacity))}.bg-border{background-color:hsl(var(--border))}.bg-card{background-color:hsl(var(--card))}.bg-destructive{background-color:hsl(var(--destructive))}.bg-gray-100{--tw-bg-opacity:1;background-color:rgb(243 244 246/var(--tw-bg-opacity))}.bg-gray-200{--tw-bg-opacity:1;background-color:rgb(229 231 235/var(--tw-bg-opacity))}.bg-gray-50{--tw-bg-opacity:1;background-color:rgb(249 250 251/var(--tw-bg-opacity))}.bg-gray-500{--tw-bg-opacity:1;background-color:rgb(107 114 128/var(--tw-bg-opacity))}.bg-gray-900{--tw-bg-opacity:1;background-color:rgb(17 24 39/var(--tw-bg-opacity))}.bg-indigo-600{--tw-bg-opacity:1;background-color:rgb(79 70 229/var(--tw-bg-opacity))}.bg-indigo-600\/10{background-color:rgba(79,70,229,.1)}.bg-primary{background-color:hsl(var(--primary))}.bg-secondary{background-color:hsl(var(--secondary))}.bg-transparent{background-color:transparent}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255/var(--tw-bg-opacity))}.bg-opacity-50{--tw-bg-opacity:0.5}.bg-gradient-to-b{background-image:linear-gradient(to bottom,var(--tw-gradient-stops))}.bg-gradient-to-t{background-image:linear-gradient(to top,var(--tw-gradient-stops))}.from-\[\#FBFCFF\]{--tw-gradient-from:#fbfcff var(--tw-gradient-from-position);--tw-gradient-to:rgba(251,252,255,0) var(--tw-gradient-to-position);--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-to)}.to-transparent{--tw-gradient-to:transparent var(--tw-gradient-to-position)}.p-1{padding:.25rem}.p-2{padding:.5rem}.p-20{padding:5rem}.p-3{padding:.75rem}.p-4{padding:1rem}.p-6{padding:1.5rem}.p-8{padding:2rem}.px-1{padding-left:.25rem;padding-right:.25rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-2\.5{padding-left:.625rem;padding-right:.625rem}.px-20{padding-left:5rem;padding-right:5rem}.px-3{padding-left:.75rem;padding-right:.75rem}.px-4{padding-left:1rem;padding-right:1rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.px-8{padding-left:2rem;padding-right:2rem}.py-1{padding-bottom:.25rem;padding-top:.25rem}.py-10{padding-bottom:2.5rem;padding-top:2.5rem}.py-16{padding-bottom:4rem;padding-top:4rem}.py-2{padding-bottom:.5rem;padding-top:.5rem}.py-3{padding-bottom:.75rem;padding-top:.75rem}.py-8{padding-bottom:2rem;padding-top:2rem}.pb-10{padding-bottom:2.5rem}.pr-6{padding-right:1.5rem}.pr-8{padding-right:2rem}.pt-0{padding-top:0}.text-left{text-align:left}.text-center{text-align:center}.font-mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace}.text-2xl{font-size:1.5rem;line-height:2rem}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-4xl{font-size:2.25rem;line-height:2.5rem}.text-\[80px\]{font-size:80px}.text-base{font-size:1rem;line-height:1.5rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:.75rem;line-height:1rem}.font-black{font-weight:900}.font-bold{font-weight:700}.font-light{font-weight:300}.font-medium{font-weight:500}.font-normal{font-weight:400}.font-semibold{font-weight:600}.uppercase{text-transform:uppercase}.italic{font-style:italic}.leading-5{line-height:1.25rem}.leading-6{line-height:1.5rem}.leading-7{line-height:1.75rem}.leading-8{line-height:2rem}.leading-none{line-height:1}.leading-tight{line-height:1.25}.tracking-tight{letter-spacing:-.025em}.text-black{--tw-text-opacity:1;color:rgb(0 0 0/var(--tw-text-opacity))}.text-card-foreground{color:hsl(var(--card-foreground))}.text-destructive{color:hsl(var(--destructive))}.text-destructive-foreground{color:hsl(var(--destructive-foreground))}.text-foreground{color:hsl(var(--foreground))}.text-foreground\/50{color:hsl(var(--foreground)/.5)}.text-gray-300{--tw-text-opacity:1;color:rgb(209 213 219/var(--tw-text-opacity))}.text-gray-400{--tw-text-opacity:1;color:rgb(156 163 175/var(--tw-text-opacity))}.text-gray-500{--tw-text-opacity:1;color:rgb(107 114 128/var(--tw-text-opacity))}.text-gray-600{--tw-text-opacity:1;color:rgb(75 85 99/var(--tw-text-opacity))}.text-gray-800{--tw-text-opacity:1;color:rgb(31 41 55/var(--tw-text-opacity))}.text-gray-900{--tw-text-opacity:1;color:rgb(17 24 39/var(--tw-text-opacity))}.text-indigo-600{--tw-text-opacity:1;color:rgb(79 70 229/var(--tw-text-opacity))}.text-muted-foreground{color:hsl(var(--muted-foreground))}.text-primary{color:hsl(var(--primary))}.text-primary-foreground{color:hsl(var(--primary-foreground))}.text-secondary-foreground{color:hsl(var(--secondary-foreground))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255/var(--tw-text-opacity))}.underline{text-decoration-line:underline}.underline-offset-4{text-underline-offset:4px}.opacity-0{opacity:0}.opacity-100{opacity:1}.opacity-50{opacity:.5}.opacity-90{opacity:.9}.shadow{--tw-shadow:0 1px 3px 0 rgba(0,0,0,.1),0 1px 2px -1px rgba(0,0,0,.1);--tw-shadow-colored:0 1px 3px 0 var(--tw-shadow-color),0 1px 2px -1px var(--tw-shadow-color)}.shadow,.shadow-lg{box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.shadow-lg{--tw-shadow:0 10px 15px -3px rgba(0,0,0,.1),0 4px 6px -4px rgba(0,0,0,.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color),0 4px 6px -4px var(--tw-shadow-color)}.shadow-sm{--tw-shadow:0 1px 2px 0 rgba(0,0,0,.05);--tw-shadow-colored:0 1px 2px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.outline{outline-style:solid}.ring-0{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(var(--tw-ring-offset-width)) var(--tw-ring-color)}.ring-0,.ring-1{box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow,0 0 #0000)}.ring-1{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color)}.ring-inset{--tw-ring-inset:inset}.ring-gray-200{--tw-ring-opacity:1;--tw-ring-color:rgb(229 231 235/var(--tw-ring-opacity))}.ring-gray-900\/5{--tw-ring-color:rgba(17,24,39,.05)}.ring-indigo-200{--tw-ring-opacity:1;--tw-ring-color:rgb(199 210 254/var(--tw-ring-opacity))}.ring-offset-background{--tw-ring-offset-color:hsl(var(--background))}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.transition{transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1)}.transition-all{transition-duration:.15s;transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1)}.transition-colors{transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1)}.transition-opacity{transition-duration:.15s;transition-property:opacity;transition-timing-function:cubic-bezier(.4,0,.2,1)}.transition-transform{transition-property:transform;transition-timing-function:cubic-bezier(.4,0,.2,1)}.duration-150,.transition-transform{transition-duration:.15s}.duration-200{transition-duration:.2s}.duration-300{transition-duration:.3s}.ease-in{transition-timing-function:cubic-bezier(.4,0,1,1)}.ease-in-out{transition-timing-function:cubic-bezier(.4,0,.2,1)}.ease-out{transition-timing-function:cubic-bezier(0,0,.2,1)}@keyframes enter{0%{opacity:var(--tw-enter-opacity,1);transform:translate3d(var(--tw-enter-translate-x,0),var(--tw-enter-translate-y,0),0) scale3d(var(--tw-enter-scale,1),var(--tw-enter-scale,1),var(--tw-enter-scale,1)) rotate(var(--tw-enter-rotate,0))}}@keyframes exit{to{opacity:var(--tw-exit-opacity,1);transform:translate3d(var(--tw-exit-translate-x,0),var(--tw-exit-translate-y,0),0) scale3d(var(--tw-exit-scale,1),var(--tw-exit-scale,1),var(--tw-exit-scale,1)) rotate(var(--tw-exit-rotate,0))}}.duration-150{animation-duration:.15s}.duration-200{animation-duration:.2s}.duration-300{animation-duration:.3s}.ease-in{animation-timing-function:cubic-bezier(.4,0,1,1)}.ease-in-out{animation-timing-function:cubic-bezier(.4,0,.2,1)}.ease-out{animation-timing-function:cubic-bezier(0,0,.2,1)}.running{animation-play-state:running}@media (min-width:1024px){.lg\:prose-lg{font-size:1.125rem;line-height:1.7777778}.lg\:prose-lg :where(p):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.3333333em;margin-top:1.3333333em}.lg\:prose-lg :where([class~=lead]):not(:where([class~=not-prose],[class~=not-prose] *)){font-size:1.2222222em;line-height:1.4545455;margin-bottom:1.0909091em;margin-top:1.0909091em}.lg\:prose-lg :where(blockquote):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.6666667em;margin-top:1.6666667em;padding-inline-start:1em}.lg\:prose-lg :where(h1):not(:where([class~=not-prose],[class~=not-prose] *)){font-size:2.6666667em;line-height:1;margin-bottom:.8333333em;margin-top:0}.lg\:prose-lg :where(h2):not(:where([class~=not-prose],[class~=not-prose] *)){font-size:1.6666667em;line-height:1.3333333;margin-bottom:1.0666667em;margin-top:1.8666667em}.lg\:prose-lg :where(h3):not(:where([class~=not-prose],[class~=not-prose] *)){font-size:1.3333333em;line-height:1.5;margin-bottom:.6666667em;margin-top:1.6666667em}.lg\:prose-lg :where(h4):not(:where([class~=not-prose],[class~=not-prose] *)){line-height:1.5555556;margin-bottom:.4444444em;margin-top:1.7777778em}.lg\:prose-lg :where(img):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.7777778em;margin-top:1.7777778em}.lg\:prose-lg :where(picture):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.7777778em;margin-top:1.7777778em}.lg\:prose-lg :where(picture>img):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:0;margin-top:0}.lg\:prose-lg :where(video):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.7777778em;margin-top:1.7777778em}.lg\:prose-lg :where(kbd):not(:where([class~=not-prose],[class~=not-prose] *)){border-radius:.3125rem;font-size:.8888889em;padding-inline-end:.4444444em;padding-bottom:.2222222em;padding-top:.2222222em;padding-inline-start:.4444444em}.lg\:prose-lg :where(code):not(:where([class~=not-prose],[class~=not-prose] *)){font-size:.8888889em}.lg\:prose-lg :where(h2 code):not(:where([class~=not-prose],[class~=not-prose] *)){font-size:.8666667em}.lg\:prose-lg :where(h3 code):not(:where([class~=not-prose],[class~=not-prose] *)){font-size:.875em}.lg\:prose-lg :where(pre):not(:where([class~=not-prose],[class~=not-prose] *)){border-radius:.375rem;font-size:.8888889em;line-height:1.75;margin-bottom:2em;margin-top:2em;padding-inline-end:1.5em;padding-bottom:1em;padding-top:1em;padding-inline-start:1.5em}.lg\:prose-lg :where(ol):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.3333333em;margin-top:1.3333333em;padding-inline-start:1.5555556em}.lg\:prose-lg :where(ul):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.3333333em;margin-top:1.3333333em;padding-inline-start:1.5555556em}.lg\:prose-lg :where(li):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:.6666667em;margin-top:.6666667em}.lg\:prose-lg :where(ol>li):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-start:.4444444em}.lg\:prose-lg :where(ul>li):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-start:.4444444em}.lg\:prose-lg :where(.lg\:prose-lg>ul>li p):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:.8888889em;margin-top:.8888889em}.lg\:prose-lg :where(.lg\:prose-lg>ul>li>p:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.3333333em}.lg\:prose-lg :where(.lg\:prose-lg>ul>li>p:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.3333333em}.lg\:prose-lg :where(.lg\:prose-lg>ol>li>p:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.3333333em}.lg\:prose-lg :where(.lg\:prose-lg>ol>li>p:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.3333333em}.lg\:prose-lg :where(ul ul,ul ol,ol ul,ol ol):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:.8888889em;margin-top:.8888889em}.lg\:prose-lg :where(dl):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.3333333em;margin-top:1.3333333em}.lg\:prose-lg :where(dt):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.3333333em}.lg\:prose-lg :where(dd):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:.6666667em;padding-inline-start:1.5555556em}.lg\:prose-lg :where(hr):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:3.1111111em;margin-top:3.1111111em}.lg\:prose-lg :where(hr+*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.lg\:prose-lg :where(h2+*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.lg\:prose-lg :where(h3+*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.lg\:prose-lg :where(h4+*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.lg\:prose-lg :where(table):not(:where([class~=not-prose],[class~=not-prose] *)){font-size:.8888889em;line-height:1.5}.lg\:prose-lg :where(thead th):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-end:.75em;padding-bottom:.75em;padding-inline-start:.75em}.lg\:prose-lg :where(thead th:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-start:0}.lg\:prose-lg :where(thead th:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-end:0}.lg\:prose-lg :where(tbody td,tfoot td):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-end:.75em;padding-bottom:.75em;padding-top:.75em;padding-inline-start:.75em}.lg\:prose-lg :where(tbody td:first-child,tfoot td:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-start:0}.lg\:prose-lg :where(tbody td:last-child,tfoot td:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-end:0}.lg\:prose-lg :where(figure):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.7777778em;margin-top:1.7777778em}.lg\:prose-lg :where(figure>*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:0;margin-top:0}.lg\:prose-lg :where(figcaption):not(:where([class~=not-prose],[class~=not-prose] *)){font-size:.8888889em;line-height:1.5;margin-top:1em}.lg\:prose-lg :where(.lg\:prose-lg>:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.lg\:prose-lg :where(.lg\:prose-lg>:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:0}}.file\:border-0::file-selector-button{border-width:0}.file\:bg-transparent::file-selector-button{background-color:transparent}.file\:text-sm::file-selector-button{font-size:.875rem;line-height:1.25rem}.file\:font-medium::file-selector-button{font-weight:500}.placeholder\:text-muted-foreground::-moz-placeholder{color:hsl(var(--muted-foreground))}.placeholder\:text-muted-foreground::placeholder{color:hsl(var(--muted-foreground))}.hover\:bg-accent:hover{background-color:hsl(var(--accent))}.hover\:bg-destructive\/90:hover{background-color:hsl(var(--destructive)/.9)}.hover\:bg-gray-100:hover{--tw-bg-opacity:1;background-color:rgb(243 244 246/var(--tw-bg-opacity))}.hover\:bg-gray-700:hover{--tw-bg-opacity:1;background-color:rgb(55 65 81/var(--tw-bg-opacity))}.hover\:bg-indigo-500:hover{--tw-bg-opacity:1;background-color:rgb(99 102 241/var(--tw-bg-opacity))}.hover\:bg-primary\/90:hover{background-color:hsl(var(--primary)/.9)}.hover\:bg-secondary:hover{background-color:hsl(var(--secondary))}.hover\:bg-secondary\/80:hover{background-color:hsl(var(--secondary)/.8)}.hover\:text-accent-foreground:hover{color:hsl(var(--accent-foreground))}.hover\:text-foreground:hover{color:hsl(var(--foreground))}.hover\:text-gray-900:hover{--tw-text-opacity:1;color:rgb(17 24 39/var(--tw-text-opacity))}.hover\:text-indigo-600:hover{--tw-text-opacity:1;color:rgb(79 70 229/var(--tw-text-opacity))}.hover\:underline:hover{text-decoration-line:underline}.hover\:opacity-50:hover{opacity:.5}.hover\:opacity-75:hover{opacity:.75}.hover\:ring-indigo-300:hover{--tw-ring-opacity:1;--tw-ring-color:rgb(165 180 252/var(--tw-ring-opacity))}.focus\:opacity-100:focus{opacity:1}.focus\:outline-none:focus{outline:2px solid transparent;outline-offset:2px}.focus\:ring-2:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow,0 0 #0000)}.focus\:ring-gray-500:focus{--tw-ring-opacity:1;--tw-ring-color:rgb(107 114 128/var(--tw-ring-opacity))}.focus\:ring-indigo-600:focus{--tw-ring-opacity:1;--tw-ring-color:rgb(79 70 229/var(--tw-ring-opacity))}.focus\:ring-ring:focus{--tw-ring-color:hsl(var(--ring))}.focus\:ring-offset-2:focus{--tw-ring-offset-width:2px}.focus-visible\:outline-none:focus-visible{outline:2px solid transparent;outline-offset:2px}.focus-visible\:outline:focus-visible{outline-style:solid}.focus-visible\:outline-2:focus-visible{outline-width:2px}.focus-visible\:outline-offset-2:focus-visible{outline-offset:2px}.focus-visible\:outline-indigo-600:focus-visible{outline-color:#4f46e5}.focus-visible\:ring-1:focus-visible{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow,0 0 #0000)}.focus-visible\:ring-2:focus-visible{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow,0 0 #0000)}.focus-visible\:ring-ring:focus-visible{--tw-ring-color:hsl(var(--ring))}.focus-visible\:ring-offset-2:focus-visible{--tw-ring-offset-width:2px}.disabled\:pointer-events-none:disabled{pointer-events:none}.disabled\:cursor-not-allowed:disabled{cursor:not-allowed}.disabled\:opacity-50:disabled{opacity:.5}.group:hover .group-hover\:opacity-100{opacity:1}.group.destructive .group-\[\.destructive\]\:border-muted\/40{border-color:hsl(var(--muted)/.4)}.group.destructive .group-\[\.destructive\]\:text-red-300{--tw-text-opacity:1;color:rgb(252 165 165/var(--tw-text-opacity))}.group.destructive .group-\[\.destructive\]\:hover\:border-destructive\/30:hover{border-color:hsl(var(--destructive)/.3)}.group.destructive .group-\[\.destructive\]\:hover\:bg-destructive:hover{background-color:hsl(var(--destructive))}.group.destructive .group-\[\.destructive\]\:hover\:text-destructive-foreground:hover{color:hsl(var(--destructive-foreground))}.group.destructive .group-\[\.destructive\]\:hover\:text-red-50:hover{--tw-text-opacity:1;color:rgb(254 242 242/var(--tw-text-opacity))}.group.destructive .group-\[\.destructive\]\:focus\:ring-destructive:focus{--tw-ring-color:hsl(var(--destructive))}.group.destructive .group-\[\.destructive\]\:focus\:ring-red-400:focus{--tw-ring-opacity:1;--tw-ring-color:rgb(248 113 113/var(--tw-ring-opacity))}.group.destructive .group-\[\.destructive\]\:focus\:ring-offset-red-600:focus{--tw-ring-offset-color:#dc2626}.peer:disabled~.peer-disabled\:cursor-not-allowed{cursor:not-allowed}.peer:disabled~.peer-disabled\:opacity-70{opacity:.7}.data-\[swipe\=cancel\]\:translate-x-0[data-swipe=cancel]{--tw-translate-x:0px}.data-\[swipe\=cancel\]\:translate-x-0[data-swipe=cancel],.data-\[swipe\=end\]\:translate-x-\[--radix-toast-swipe-end-x\][data-swipe=end]{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.data-\[swipe\=end\]\:translate-x-\[--radix-toast-swipe-end-x\][data-swipe=end]{--tw-translate-x:var(--radix-toast-swipe-end-x)}.data-\[swipe\=move\]\:translate-x-\[--radix-toast-swipe-move-x\][data-swipe=move]{--tw-translate-x:var(--radix-toast-swipe-move-x);transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}@keyframes collapsible-up{0%{height:var(--radix-collapsible-content-height)}to{height:0}}.data-\[state\=closed\]\:animate-collapsible-up[data-state=closed]{animation:collapsible-up .2s ease-in-out}@keyframes collapsible-down{0%{height:0}to{height:var(--radix-collapsible-content-height)}}.data-\[state\=open\]\:animate-collapsible-down[data-state=open]{animation:collapsible-down .2s ease-in-out}.data-\[swipe\=move\]\:transition-none[data-swipe=move]{transition-property:none}.data-\[state\=open\]\:animate-in[data-state=open]{animation-duration:.15s;animation-name:enter;--tw-enter-opacity:initial;--tw-enter-scale:initial;--tw-enter-rotate:initial;--tw-enter-translate-x:initial;--tw-enter-translate-y:initial}.data-\[state\=closed\]\:animate-out[data-state=closed],.data-\[swipe\=end\]\:animate-out[data-swipe=end]{animation-duration:.15s;animation-name:exit;--tw-exit-opacity:initial;--tw-exit-scale:initial;--tw-exit-rotate:initial;--tw-exit-translate-x:initial;--tw-exit-translate-y:initial}.data-\[state\=closed\]\:fade-out-80[data-state=closed]{--tw-exit-opacity:0.8}.data-\[state\=closed\]\:slide-out-to-right-full[data-state=closed]{--tw-exit-translate-x:100%}.data-\[state\=open\]\:slide-in-from-top-full[data-state=open]{--tw-enter-translate-y:-100%}@media (min-width:640px){.sm\:bottom-0{bottom:0}.sm\:right-0{right:0}.sm\:top-auto{top:auto}.sm\:mt-20{margin-top:5rem}.sm\:flex-row{flex-direction:row}.sm\:flex-col{flex-direction:column}.sm\:px-6{padding-left:1.5rem;padding-right:1.5rem}.sm\:text-5xl{font-size:3rem;line-height:1}.sm\:text-6xl{font-size:3.75rem;line-height:1}.data-\[state\=open\]\:sm\:slide-in-from-bottom-full[data-state=open]{--tw-enter-translate-y:100%}}@media (min-width:768px){.md\:max-h-64{max-height:16rem}.md\:w-full{width:100%}.md\:max-w-\[420px\]{max-width:420px}}@media (min-width:1024px){.lg\:fixed{position:fixed}.lg\:z-10{z-index:10}.lg\:mx-0{margin-left:0;margin-right:0}.lg\:mb-0{margin-bottom:0}.lg\:mt-0{margin-top:0}.lg\:mt-8{margin-top:2rem}.lg\:block{display:block}.lg\:grid{display:grid}.lg\:hidden{display:none}.lg\:w-2\/3{width:66.666667%}.lg\:max-w-3xl{max-width:48rem}.lg\:max-w-lg{max-width:32rem}.lg\:max-w-none{max-width:none}.lg\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.lg\:grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.lg\:gap-x-12{-moz-column-gap:3rem;column-gap:3rem}.lg\:rounded-b-none{border-bottom-left-radius:0;border-bottom-right-radius:0}.lg\:rounded-l-none{border-bottom-left-radius:0;border-top-left-radius:0}.lg\:rounded-r-none{border-bottom-right-radius:0;border-top-right-radius:0}.lg\:px-8{padding-left:2rem;padding-right:2rem}.lg\:pt-0{padding-top:0}}@media (min-width:1280px){.xl\:p-10{padding:2.5rem}}.\[\&_svg\]\:pointer-events-none svg{pointer-events:none}.\[\&_svg\]\:size-4 svg{height:1rem;width:1rem}.\[\&_svg\]\:shrink-0 svg{flex-shrink:0}</style>
<style>.toc[data-v-fcddb7e2]{border-left:2px solid #e5e7eb;padding-left:1rem}html[data-v-fcddb7e2]{scroll-behavior:smooth}.toc[data-v-fcddb7e2]::-webkit-scrollbar{display:none}.toc[data-v-fcddb7e2]{-ms-overflow-style:none;scrollbar-width:none}.mobile-toc-overlay-enter-active[data-v-fcddb7e2],.mobile-toc-overlay-leave-active[data-v-fcddb7e2]{transition:opacity .2s ease}.mobile-toc-overlay-enter-from[data-v-fcddb7e2],.mobile-toc-overlay-leave-to[data-v-fcddb7e2]{opacity:0}.overflow-hidden[data-v-fcddb7e2]{padding-right:var(--scrollbar-width,0)}</style>
<style>pre code .line{display:block;min-height:1rem}</style>
<link rel="stylesheet" href="/_nuxt/_...BNFDaBz8.css">
<link rel="stylesheet" href="/_nuxt/ProsePre.B_fgAJq0.css">
<link rel="preload" as="fetch" crossorigin="anonymous" href="/stripe-integration-in-nuxt-3/_payload.json?20f3f421-5963-409a-8a11-55701206fbd4">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/B6WF9WI8.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BH7BxvFy.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BAu9akb8.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DlAUqK2U.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CTo6RmZH.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/D9kgAeI3.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DOLiC23L.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/C-zO7oom.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/C-v3KzvZ.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Dnd51l0P.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/C7T9qRaG.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BeJ5zZAO.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DJtvJD2W.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/fx6abePS.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CBqpqTXb.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/TBHrAv14.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BWqIYteo.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/C2javCq6.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CRX6OFYq.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/tPU-pi7Q.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CkPO_sH0.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CLHu_W0C.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BE9FQOA2.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/378r1KLr.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/PjlgByuq.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BFyD98V0.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CMmg5k5Y.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BAuRHPca.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CsUQ3REY.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Dh8irazX.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Dl7G3IIG.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CEqVfVOH.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BwZbOQwY.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BZHtUxlm.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BIUYdP2N.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Z-jLIUQO.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/D8mupVeU.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/Dyt3ZugK.js">
<link rel="prefetch" as="style" crossorigin href="/_nuxt/useStudio.Tc7-ghOt.css">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/JX3_RDhg.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/DyL3oHOX.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/DmhCkdLl.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/BO6Ml5P-.js">
<meta name="twitter:title" content="Stripe Integration in Nuxt 3">
<meta name="twitter:description" content="Welcome to my Nuxt + Stripe tutorial.
This course covers Authentication with @sidebase/nuxt-auth and Github, Stripe Chec...">
<link rel="icon" type="image/ico" href="/favicon.ico">
<meta property="og:title" content="Stripe Integration in Nuxt 3">
<meta name="description" content="Learn how to seamlessly integrate Stripe's powerful payment processing system into your Nuxt 3 web application. This comprehensive guide covers everything from initial setup to implementing secure checkout flows, enabling you to accept payments and manage transactions with ease. Perfect for developers looking to add robust e-commerce capabilities to their Nuxt 3 projects.">
<meta property="og:description" content="Learn how to seamlessly integrate Stripe's powerful payment processing system into your Nuxt 3 web application. This comprehensive guide covers everything from initial setup to implementing secure checkout flows, enabling you to accept payments and manage transactions with ease. Perfect for developers looking to add robust e-commerce capabilities to their Nuxt 3 projects.">
<script type="module" src="/_nuxt/B6WF9WI8.js" crossorigin></script>
<style>:where(.i-material-symbols\:menu-book-outline){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cpath fill='black' d='M14 9.9V8.2q.825-.35 1.688-.525T17.5 7.5q.65 0 1.275.1T20 7.85v1.6q-.6-.225-1.213-.337T17.5 9q-.95 0-1.825.238T14 9.9m0 5.5v-1.7q.825-.35 1.688-.525T17.5 13q.65 0 1.275.1t1.225.25v1.6q-.6-.225-1.213-.338T17.5 14.5q-.95 0-1.825.225T14 15.4m0-2.75v-1.7q.825-.35 1.688-.525t1.812-.175q.65 0 1.275.1T20 10.6v1.6q-.6-.225-1.213-.338T17.5 11.75q-.95 0-1.825.238T14 12.65M6.5 16q1.175 0 2.288.263T11 17.05V7.2q-1.025-.6-2.175-.9T6.5 6q-.9 0-1.788.175T3 6.7v9.9q.875-.3 1.738-.45T6.5 16m6.5 1.05q1.1-.525 2.213-.787T17.5 16q.9 0 1.763.15T21 16.6V6.7q-.825-.35-1.713-.525T17.5 6q-1.175 0-2.325.3T13 7.2zM12 20q-1.2-.95-2.6-1.475T6.5 18q-1.05 0-2.062.275T2.5 19.05q-.525.275-1.012-.025T1 18.15V6.1q0-.275.138-.525T1.55 5.2q1.15-.6 2.4-.9T6.5 4q1.45 0 2.838.375T12 5.5q1.275-.75 2.663-1.125T17.5 4q1.3 0 2.55.3t2.4.9q.275.125.413.375T23 6.1v12.05q0 .575-.487.875t-1.013.025q-.925-.5-1.937-.775T17.5 18q-1.5 0-2.9.525T12 20m-5-8.35'/%3E%3C/svg%3E")}</style><script>"use strict";(()=>{const t=window,e=document.documentElement,c=["dark","light"],n=getStorageValue("localStorage","nuxt-color-mode")||"system";let i=n==="system"?u():n;const r=e.getAttribute("data-color-mode-forced");r&&(i=r),l(i),t["__NUXT_COLOR_MODE__"]={preference:n,value:i,getColorScheme:u,addColorScheme:l,removeColorScheme:d};function l(o){const s=""+o+"-mode",a="";e.classList?e.classList.add(s):e.className+=" "+s,a&&e.setAttribute("data-"+a,o)}function d(o){const s=""+o+"-mode",a="";e.classList?e.classList.remove(s):e.className=e.className.replace(new RegExp(s,"g"),""),a&&e.removeAttribute("data-"+a)}function f(o){return t.matchMedia("(prefers-color-scheme"+o+")")}function u(){if(t.matchMedia&&f("").media!=="not all"){for(const o of c)if(f(":"+o).matches)return o}return"light"}})();function getStorageValue(t,e){switch(t){case"localStorage":return window.localStorage.getItem(e);case"sessionStorage":return window.sessionStorage.getItem(e);case"cookie":return getCookie(e);default:return null}}function getCookie(t){const c=("; "+window.document.cookie).split("; "+t+"=");if(c.length===2)return c.pop()?.split(";").shift()}</script></head><body><div id="__nuxt"><div class="max-w-3xl mx-auto py-8 px-4"><div class="max-w-lg mx-auto mb-16 lg:max-w-3xl"><header class="flex justify-between items-center mb-16"><h1 class=""><a href="/" class="hover:opacity-75"> Cody Bontecou </a></h1><nav class="flex gap-6 text-gray-600"><a href="/" class="">Writing</a><a href="/about" class="">Learn more</a></nav></header><!--[--><!--[--><!--[--><!--[--><!--]--><div role="region" aria-label="Notifications (F8)" tabindex="-1" style="pointer-events:none;"><!--[--><!----><ol tabindex="-1" class="fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]"><!--[--><!--]--></ol><!----><!--]--></div><!--]--><!--]--><div class="relative" data-v-fcddb7e2><aside class="hidden lg:block fixed right-8 top-32 w-64 max-h-[calc(100vh-200px)] overflow-y-auto" data-v-fcddb7e2><nav class="toc" data-v-fcddb7e2><h2 class="font-medium mb-4" data-v-fcddb7e2>On this page</h2><ul class="space-y-3" data-v-fcddb7e2><!--[--><li class="text-sm" data-v-fcddb7e2><a href="#_01-introduction" class="text-primary hover:text-primary-dark transition-colors duration-200 text-gray-600 hover:text-gray-900" data-v-fcddb7e2>01 - Introduction</a></li><li class="text-sm" data-v-fcddb7e2><a href="#_02-installation" class="text-primary hover:text-primary-dark transition-colors duration-200 text-gray-600 hover:text-gray-900" data-v-fcddb7e2>02 - Installation</a></li><li class="text-sm" data-v-fcddb7e2><a href="#_03-auth" class="text-primary hover:text-primary-dark transition-colors duration-200 text-gray-600 hover:text-gray-900" data-v-fcddb7e2>03 - Auth</a></li><li class="text-sm" data-v-fcddb7e2><a href="#_04-pricing-page" class="text-primary hover:text-primary-dark transition-colors duration-200 text-gray-600 hover:text-gray-900" data-v-fcddb7e2>04 - Pricing Page</a></li><li class="text-sm" data-v-fcddb7e2><a href="#_05-stripe-customer" class="text-primary hover:text-primary-dark transition-colors duration-200 text-gray-600 hover:text-gray-900" data-v-fcddb7e2>05 - Stripe Customer</a></li><li class="text-sm" data-v-fcddb7e2><a href="#_06-stripe-checkout" class="text-primary hover:text-primary-dark transition-colors duration-200 text-gray-600 hover:text-gray-900" data-v-fcddb7e2>06 - Stripe Checkout</a></li><li class="text-sm" data-v-fcddb7e2><a href="#_07-stripe-webhook" class="text-primary hover:text-primary-dark transition-colors duration-200 text-gray-600 hover:text-gray-900" data-v-fcddb7e2>07 - Stripe Webhook</a></li><li class="text-sm" data-v-fcddb7e2><a href="#_08-stripe-customer-portal" class="text-primary hover:text-primary-dark transition-colors duration-200 text-gray-600 hover:text-gray-900" data-v-fcddb7e2>08 - Stripe Customer Portal</a></li><li class="text-sm" data-v-fcddb7e2><a href="#_09-composable-refactor" class="text-primary hover:text-primary-dark transition-colors duration-200 text-gray-600 hover:text-gray-900" data-v-fcddb7e2>09 - Composable Refactor</a></li><li class="text-sm" data-v-fcddb7e2><a href="#_10-multiple-plans" class="text-primary hover:text-primary-dark transition-colors duration-200 text-gray-600 hover:text-gray-900" data-v-fcddb7e2>10 - Multiple Plans</a></li><li class="text-sm" data-v-fcddb7e2><a href="#_11-yearly-plans" class="text-primary hover:text-primary-dark transition-colors duration-200 text-gray-600 hover:text-gray-900" data-v-fcddb7e2>11 - Yearly Plans</a></li><li class="text-sm" data-v-fcddb7e2><a href="#_12-permissions" class="text-primary hover:text-primary-dark transition-colors duration-200 text-gray-600 hover:text-gray-900" data-v-fcddb7e2>12 - Permissions</a></li><li class="text-sm" data-v-fcddb7e2><a href="#_13-deploy" class="text-primary hover:text-primary-dark transition-colors duration-200 text-gray-600 hover:text-gray-900" data-v-fcddb7e2>13 - Deploy</a></li><li class="text-sm" data-v-fcddb7e2><a href="#conclusion" class="text-primary hover:text-primary-dark transition-colors duration-200 text-gray-600 hover:text-gray-900" data-v-fcddb7e2>Conclusion</a></li><!--]--></ul></nav></aside><button class="lg:hidden flex items-center justify-center fixed right-4 bottom-4 z-20 rounded-full p-3 bg-white shadow transition-colors duration-200" aria-label="Open table of contents" data-v-fcddb7e2><span class="iconify i-material-symbols:menu-book-outline w-6 h-6" aria-hidden="true" style="" data-v-fcddb7e2></span></button><!----><!----><main class="flex flex-col justify-center max-w-3xl mx-auto" data-v-fcddb7e2><!--[--><article class="prose lg:prose-lg" data-v-fcddb7e2><h1 class="text-4xl font-normal mb-4" data-v-fcddb7e2>Stripe Integration in Nuxt 3</h1><div class="text-gray-600 text-lg flex mb-10" data-v-fcddb7e2>August 21, 2024 · 41 minute read · <!--[--><a href="/topics/nuxt" class="ml-1 text-gray-600" data-v-fcddb7e2>nuxt,</a><a href="/topics/stripe" class="ml-1 text-gray-600" data-v-fcddb7e2>stripe,</a><a href="/topics/authentication" class="ml-1 text-gray-600" data-v-fcddb7e2>authentication</a><!--]--><ul class="ml-2 flex list-none not-prose gap-x-2" data-v-fcddb7e2><li class="not-prose underline hover:opacity-75 break-keep whitespace-nowrap" data-v-fcddb7e2></li></ul></div><div data-v-fcddb7e2><h2 id="_01-introduction"><a href="#_01-introduction"><!--[-->01 - Introduction<!--]--></a></h2><p><!--[-->Welcome to my Nuxt + Stripe tutorial.
This course covers Authentication with @sidebase/nuxt-auth and Github, Stripe Checkout, Stripe Billing Portal, Stripe Webhooks, Stripe Subscriptions, and more.<!--]--></p><p><!--[-->Each branch of this repo represents a different section of the course. For example, branch 01-installation should be 1:1 with the first video of the course.<!--]--></p><p><!--[-->At the end of this course, you will have a page similar to this setup and deployed online, accepting payments with Stripe.<!--]--></p><p><!--[-->All of the code is hosted on my Github in my <a href="https://github.com/codybontecou/nuxt-stripe" rel="nofollow"><!--[-->nuxt-stripe<!--]--></a> repo. Each branch represents the specific section of the course.<!--]--></p><p><!--[--><img src="https://cln.sh/dKfgxlB3+" alt="landing page|500"><!--]--></p><h2 id="_02-installation"><a href="#_02-installation"><!--[-->02 - Installation<!--]--></a></h2><p><!--[-->Let&#39;s get your project installed and running. This lesson is all about front-loading our dependencies so we don&#39;t have to worry about them in later lessons.<!--]--></p><p><!--[-->Start by creating a Nuxt application if you do not already have one set up. Run the following command to do this:<!--]--></p><p><!--[--><code class=""><!--[-->npx nuxi init nuxt-stripe<!--]--></code><!--]--></p><h3 id="auth-dependencies"><a href="#auth-dependencies"><!--[-->Auth Dependencies<!--]--></a></h3><p><!--[-->We&#39;ll be relying on <a href="https://auth.sidebase.io" rel="nofollow"><!--[-->Nuxt Auth<!--]--></a> for our authentication needs. This is a wrapper around Next Auth that makes it easy to use with Nuxt. There is an issue that makes Nuxt Auth reliant on next-auth version 4.21.1, so we&#39;ll install that version specifically.<!--]--></p><p><!--[--><code class=""><!--[-->npm install @auth/core @sidebase/nuxt-auth@^0.9.0 next-auth@4.21.1<!--]--></code><!--]--></p><h3 id="db-dependencies"><a href="#db-dependencies"><!--[-->DB Dependencies<!--]--></a></h3><p><!--[--><a href="https://www.prisma.io" rel="nofollow"><!--[-->Prisma<!--]--></a> is my go-to ORM for Node.js projects. It&#39;s easy to use and has a great query builder. We&#39;ll be using it to interact with our database.<!--]--></p><p><!--[-->If you prefer a different solution, use it. There&#39;s nothing specific that Prisma solves that other ORM&#39;s and database drivers don&#39;t. It&#39;s just my preference and what I will be showing in the code snippets.<!--]--></p><p><!--[--><code class=""><!--[-->npm install prisma @prisma/client @next-auth/prisma-adapter<!--]--></code><!--]--></p><h3 id="ui-dependencies"><a href="#ui-dependencies"><!--[-->UI Dependencies<!--]--></a></h3><p><!--[-->The UI for this project will be built with <a href="https://tailwindcss.com" rel="nofollow"><!--[-->Tailwind CSS<!--]--></a> and <a href="https://headlessui.com" rel="nofollow"><!--[-->Headless UI<!--]--></a>. Headless UI is a collection of unstyled, fully accessible UI components, designed to integrate beautifully with Tailwind CSS.<!--]--></p><p><!--[-->I&#39;m using components directly from <a href="http://tailwindui.com" rel="nofollow"><!--[-->TailwindUI<!--]--></a>. Because this is a course on Nuxt and Stripe, I won&#39;t be explaining much about the UI. I&#39;m just bringing these dependencies in for presentation reasons.<!--]--></p><p><!--[--><code class=""><!--[-->npx nuxi@latest module add @nuxtjs/tailwindcss<!--]--></code><!--]--></p><p><!--[--><code class=""><!--[-->npm install @headlessui/vue @heroicons/vue<!--]--></code><!--]--></p><h3 id="stripe-dependencies"><a href="#stripe-dependencies"><!--[-->Stripe Dependencies<!--]--></a></h3><p><!--[-->Stripe is easy. We&#39;ll only need one dependency: the Stripe Node.js library.<!--]--></p><p><!--[--><code class=""><!--[-->npm install stripe<!--]--></code><!--]--></p><h3 id="tldr"><a href="#tldr"><!--[-->TLDR:<!--]--></a></h3><p><!--[-->You can expedite this running these commands:<!--]--></p><p><!--[--><code class=""><!--[-->npx nuxi init nuxt-stripe<!--]--></code><!--]--></p><p><!--[--><code class=""><!--[-->npm install @auth/core @sidebase/nuxt-auth next-auth@4.21.1 prisma @prisma/client @next-auth/prisma-adapter @headlessui/vue @heroicons/vue stripe<!--]--></code><!--]--></p><p><!--[--><code class=""><!--[-->npx nuxi@latest module add @nuxtjs/tailwindcss<!--]--></code><!--]--></p><h2 id="_03-auth"><a href="#_03-auth"><!--[-->03 - Auth<!--]--></a></h2><blockquote><!--[--><p><!--[-->Now we can begin!<!--]--></p><!--]--></blockquote><p><!--[-->Authentication requires setting up a few things:<!--]--></p><ol><!--[--><li><!--[-->The <code class=""><!--[-->auth<!--]--></code> and <code class=""><!--[-->runtimeConfig<!--]--></code> sections of the <code class=""><!--[-->nuxt.config.ts<!--]--></code> file.<!--]--></li><li><!--[--><code class=""><!--[-->.env<!--]--></code> file to manage environment variables.<!--]--></li><li><!--[-->The <code class=""><!--[-->[...].ts<!--]--></code> file located at <code class=""><!--[-->server/api/auth/[...].ts<!--]--></code>.<!--]--></li><li><!--[-->Prisma and our database schema<!--]--></li><li><!--[-->Clientside code to sign in and sign out<!--]--></li><!--]--></ol><h3 id="nuxtconfigts"><a href="#nuxtconfigts"><!--[--><code class=""><!--[-->nuxt.config.ts<!--]--></code><!--]--></a></h3><h3 id="_1-nuxt-auth-module"><a href="#_1-nuxt-auth-module"><!--[-->1. nuxt-auth module<!--]--></a></h3><p><!--[-->We need to add our newly installed <code class=""><!--[-->@sidebase/nuxt-auth<!--]--></code> package to our Nuxt config&#39;s <code class=""><!--[-->module<!--]--></code> array.<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code>// nuxt.config.ts

export default defineNuxtConfig({
  ...,
  modules: [&#39;@nuxtjs/tailwindcss&#39;, &#39;@sidebase/nuxt-auth&#39;]
})
</code><!--]--></pre><!--]--><h4 id="runtime-config"><a href="#runtime-config"><!--[-->Runtime Config<!--]--></a></h4><p><!--[-->The recommended way of exposing our environment variables is to use Nuxt&#39;s <a href="https://nuxt.com/docs/guide/going-further/runtime-config" rel="nofollow"><!--[-->Runtime Config<!--]--></a>. This enables us to utilize the <code class=""><!--[-->useRuntimeConfig<!--]--></code> composable on both client and server which gives us access to environment variables.<!--]--></p><p><!--[-->Let&#39;s add the environment variables we need to roll out authentication.<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code>// nuxt.config.ts

export default defineNuxtConfig({
  ...,
  modules: [&#39;@nuxtjs/tailwindcss&#39;, &#39;@sidebase/nuxt-auth&#39;],
  runtimeConfig: {
    AUTH_SECRET: process.env.AUTH_SECRET,
    GITHUB_CLIENT_ID: process.env.GITHUB_CLIENT_ID,
    GITHUB_CLIENT_SECRET: process.env.GITHUB_CLIENT_SECRET,
  }
})
</code><!--]--></pre><!--]--><p><!--[-->I&#39;ll explain where <code class=""><!--[-->AUTH_SECRET<!--]--></code>, <code class=""><!--[-->GITHUB_CLIENT_ID<!--]--></code> and <code class=""><!--[-->GITHUB_CLIENT_SECRET<!--]--></code> come from later in this article.<!--]--></p><h4 id="auth-config"><a href="#auth-config"><!--[-->auth config<!--]--></a></h4><p><!--[-->Now, we need to add the <code class=""><!--[-->auth<!--]--></code> config. The configuration options be explored further in <a href="https://auth.sidebase.io/guide/application-side/configuration" rel="nofollow"><!--[-->Sidebase&#39;s docs<!--]--></a>.<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code>// nuxt.config.ts

export default defineNuxtConfig({
  ...,
  modules: [&#39;@nuxtjs/tailwindcss&#39;, &#39;@sidebase/nuxt-auth&#39;],
  runtimeConfig: {
    AUTH_SECRET: process.env.AUTH_SECRET,
    GITHUB_CLIENT_ID: process.env.GITHUB_CLIENT_ID,
    GITHUB_CLIENT_SECRET: process.env.GITHUB_CLIENT_SECRET,
  },
  auth: {
    originEnvKey: &#39;AUTH_ORIGIN&#39;,
    baseURL: &#39;http://localhost:3000/api/auth&#39;,
    provider: {
      type: &#39;authjs&#39;,
      defaultProvider: &#39;github&#39;,
      addDefaultCallbackUrl: true,
    },
    sessionRefresh: {
      enablePeriodically: true,
      enableOnWindowFocus: true,
    },
  },
})
</code><!--]--></pre><!--]--><p><!--[--><strong><!--[-->Note:<!--]--></strong> I am not doing any custom <code class=""><!--[-->auth<!--]--></code> configuration and am simply providing the default configuration that their <a href="https://auth.sidebase.io/guide/application-side/configuration" rel="nofollow"><!--[-->documentation<!--]--></a> suggests.<!--]--></p><h3 id="_2-env-file"><a href="#_2-env-file"><!--[-->2. .env file<!--]--></a></h3><p><!--[-->The <code class=""><!--[-->.env<!--]--></code> file is where we manage environment variables, specifically, secret keys that we do not want to to end up in source control. Create the file if you do not already have one, and place it in your project&#39;s root directory. This file will grow with time, but initially, we just need three keys:<!--]--></p><!--[--><pre class="language-toml" style=""><!--[--><code>// .env
GITHUB_CLIENT_ID=
GITHUB_CLIENT_SECRET=
AUTH_SECRET=
</code><!--]--></pre><!--]--><p><!--[-->To get the values, you&#39;ll need to fill out this <a href="https://github.com/settings/applications/new" rel="nofollow"><!--[-->Github application<!--]--></a>.  Here&#39;s what my form looks like:<!--]--></p><p><!--[--><img src="https://cln.sh/kJjW3vSQ+" alt="image|500"><!--]--></p><ul><!--[--><li><!--[--><strong><!--[-->Application Name<!--]--></strong>: Name this whatever you like<!--]--></li><li><!--[--><strong><!--[-->Homepage URL:<!--]--></strong> This should be set to the port you are developing your application on. Nuxt&#39;s default is on port 3000 so that is what I set it to. Configure this as needed.<!--]--></li><li><!--[--><strong><!--[-->Authorization callback URL:<!--]--></strong> Same as the Homepage URL, I am using the default port 3000. What is <strong><!--[-->important<!--]--></strong> here is the <code class=""><!--[-->/api/auth/callback/github<!--]--></code>. This is the default endpoint Nuxt Auth provides and is important for our authentication flow.<!--]--></li><!--]--></ul><p><!--[-->You should now see the Client ID and the ability to generate a Client Secret:<!--]--></p><p><!--[--><img src="https://share.cleanshot.com/XM6tYFt8+" alt="github oauth panel|500"><!--]--></p><p><!--[-->Place <strong><!--[-->your<!--]--></strong> Client ID and Client Secret values into your .env file.<!--]--></p><!--[--><pre class="language-toml" style=""><!--[--><code>// .env
GITHUB_CLIENT_ID=Ov23liXNQBrzCfy450re
GITHUB_CLIENT_SECRET=ab00828302cd662072eaffe70c41f048d3879536
AUTH_SECRET=
</code><!--]--></pre><!--]--><blockquote><!--[--><p><!--[-->The values I am showing have already been deleted and will not work. You must generate your own.<!--]--></p><!--]--></blockquote><p><!--[--><code class=""><!--[-->AUTH_SECRET<!--]--></code> is a secret key that we must generate ourselves. The secret is a random string used to hash tokens, sign and encrypt cookie and generate cryptographic keys. This isn&#39;t necessary for development, but is <strong><!--[-->required<!--]--></strong> once the application is deployed.<!--]--></p><p><!--[-->Run <code class=""><!--[-->openssl rand -base64 32<!--]--></code> in your terminal to generate this value. Copy and paste the output into your <code class=""><!--[-->.env<!--]--></code> file and store it within <code class=""><!--[-->AUTH_SECRET<!--]--></code>.<!--]--></p><p><!--[-->You can read more about in the <a href="https://auth.sidebase.io/guide/authjs/nuxt-auth-handler#secret" rel="nofollow"><!--[-->NuxtAuth docs<!--]--></a>.<!--]--></p><h3 id="_3-serverapiauthts"><a href="#_3-serverapiauthts"><!--[-->3. <code class=""><!--[-->server/api/auth/[...].ts<!--]--></code><!--]--></a></h3><p><!--[-->Next up is our <code class=""><!--[-->[...].ts<!--]--></code> file. This will be where the majority of the code that configures our authentication logic is held.<!--]--></p><p><!--[-->If you&#39;re not familiar, <span>...</span> is the Nuxt syntax for a <a href="https://nuxt.com/docs/guide/directory-structure/server#catch-all-route" rel="nofollow"><!--[-->catch-all route<!--]--></a>.<!--]--></p><p><!--[-->By placing it at the endpoint <code class=""><!--[-->api/auth/[...].ts<!--]--></code>, it allows there to be many valid values after <code class=""><!--[-->api/auth/<!--]--></code>. Some of the defaults that are included with @sidebase/nuxt-auth include <code class=""><!--[-->api/auth/signin<!--]--></code> and <code class=""><!--[-->api/auth/signout<!--]--></code>.<!--]--></p><p><!--[-->Let&#39;s start with this code snippet:<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code>// server/api/auth/[...].ts
import GithubProvider from &#39;next-auth/providers/github&#39;
import { NuxtAuthHandler } from &#39;#auth&#39;
import { PrismaAdapter } from &#39;@next-auth/prisma-adapter&#39;
import { PrismaClient } from &#39;@prisma/client&#39;

const runtimeConfig = useRuntimeConfig()
const prisma = new PrismaClient()

export default NuxtAuthHandler({
  secret: runtimeConfig.AUTH_SECRET,
  adapter: PrismaAdapter(prisma),
  providers: [
    // @ts-expect-error
    GithubProvider.default({
      clientId: runtimeConfig.GITHUB_CLIENT_ID,
      clientSecret: runtimeConfig.GITHUB_CLIENT_SECRET,
    }),
  ],
})
</code><!--]--></pre><!--]--><ol><!--[--><li><!--[--><strong><!--[-->Secret:<!--]--></strong> We use our <code class=""><!--[-->runtimeConfig<!--]--></code> to access our <code class=""><!--[-->AUTH_SECRET<!--]--></code> and <code class=""><!--[-->GITHUB_*<!--]--></code> environment variables.<!--]--></li><li><!--[--><strong><!--[-->Adapter:<!--]--></strong> We create a new <code class=""><!--[-->PrismaClient<!--]--></code> that is passed to the NuxtAuthHandler&#39;s <code class=""><!--[-->adapter<!--]--></code>.
<ul><!--[--><li><!--[-->&quot;Adapters are the bridge we use to connect NuxtAuth to your database.&quot; (<a href="https://authjs.dev/getting-started/database?_gl=1*1ry7ee*_gcl_au*NDc1MTI5NzEzLjE3MjM3Njg4Njk." rel="nofollow"><!--[-->docs<!--]--></a>) Adapter&#39;s provide the functions that NuxtAuth call when authentication occurs. For example, when a user is created, NuxtAuth will call the PrismaAdapter&#39;s <code class=""><!--[-->createUser<!--]--></code> function.<!--]--></li><li><!--[--><a href="https://github.com/nextauthjs/next-auth/blob/main/packages/adapter-prisma/src/index.ts" rel="nofollow"><!--[-->Here&#39;s a reference to the PrismaAdapter code if you are curious.<!--]--></a><!--]--></li><!--]--></ul><!--]--></li><li><!--[--><strong><!--[-->Providers<!--]--></strong>: This is an array of the authentication providers we enable.
<ul><!--[--><li><!--[-->In this course, we will only use Github. You can see we import the <code class=""><!--[-->GithubProvider<!--]--></code> from <code class=""><!--[-->next-auth/providers/github<!--]--></code>. There are lots of providers you can hook into in a similar way. Check out <a href="https://authjs.dev/getting-started/providers/github" rel="nofollow"><!--[-->Auth.js&#39; docs<!--]--></a> for a larger list of built-in provider options.<!--]--></li><!--]--></ul><!--]--></li><!--]--></ol><h3 id="_4-prisma-orm-database-schema"><a href="#_4-prisma-orm-database-schema"><!--[-->4. Prisma ORM + Database Schema<!--]--></a></h3><p><!--[--><a href="https://www.prisma.io/orm" rel="nofollow"><!--[-->Prisma ORM<!--]--></a> is the database management tool I chose to use for this tutorial. It helps manage the database schema, database migrations, and database queries using Typescript.<!--]--></p><p><!--[-->When a user logs in, we use the <code class=""><!--[-->PrismaAdapter<!--]--></code> to save the logged in user into our database. This is essential if we are to collect payments from them and persist their subscription status.<!--]--></p><p><!--[-->You should already have Prisma installed. But there is an additional command we have to run:<!--]--></p><p><!--[--><code class=""><!--[-->npx prisma init --datasource-provider sqlite<!--]--></code><!--]--></p><p><!--[-->This will:<!--]--></p><ul><!--[--><li><!--[-->Create a prisma directory in your application.<!--]--></li><li><!--[-->Set the <code class=""><!--[-->DATABASE_URL<!--]--></code> environment variable in your <code class=""><!--[-->.env<!--]--></code> file to a local sqlite database<!--]--></li><li><!--[-->Create a base <code class=""><!--[-->schema.prisma<!--]--></code> file within the prisma directory pointing to your <code class=""><!--[-->DATABASE_URL<!--]--></code><!--]--></li><!--]--></ul><!--[--><pre class="language-ts" style=""><!--[--><code>// schema.prisma
generator client {
  provider = &quot;prisma-client-js&quot;
}

datasource db {
  provider = &quot;sqlite&quot;
  url      = env(&quot;DATABASE_URL&quot;)
}
</code><!--]--></pre><!--]--><p><!--[-->Following Auth.js <a href="https://authjs.dev/getting-started/adapters/prisma" rel="nofollow"><!--[-->Prisma Adapter docs<!--]--></a>, we need to update the schema to:<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code>// schema.prisma
datasource db {
  provider = &quot;sqlite&quot;
  url      = env(&quot;DATABASE_URL&quot;)
}

generator client {
  provider = &quot;prisma-client-js&quot;
}

model User {
  id            String          @id @default(cuid())
  name          String?
  email         String?         @unique
  emailVerified DateTime?
  image         String?
  accounts      Account[]
  sessions      Session[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Account {
  id                String  @id @default(cuid())
  userId            String
  type              String
  provider          String
  providerAccountId String
  refresh_token     String?
  access_token      String?
  expires_at        Int?
  token_type        String?
  scope             String?
  id_token          String?
  session_state     String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([provider, providerAccountId])
}

model Session {
  id           String   @id @default(cuid())
  sessionToken String   @unique
  userId       String
  expires      DateTime
  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model VerificationToken {
  identifier String
  token      String
  expires    DateTime

  @@unique([identifier, token])
}
</code><!--]--></pre><!--]--><p><!--[--><strong><!--[-->Note:<!--]--></strong> I deleted the optional <code class=""><!--[-->Authenticator<!--]--></code> table from the documentation. We will not be implementing WebAuthn support.<!--]--></p><p><!--[-->This schema creates the tables used for the authentication flow. But, we need to run two additional commands:<!--]--></p><p><!--[--><code class=""><!--[-->npx prisma generate<!--]--></code> - This generates Typescript types that mirror your database schema, giving us excellent auto-complete and type-errors.<!--]--></p><p><!--[--><code class=""><!--[-->npx prisma migrate dev<!--]--></code> - This creates the migration file that contains the SQL that is then applied to your database. This command will prompt you to enter a name for the migration. This can be anything and should be used to describe the changes made to your database.<!--]--></p><p><!--[-->Your prisma directory should now look like:<!--]--></p><!--[--><pre class="language-shell" style=""><!--[--><code>prisma
- migrations
-- migrationName directory
--- migration.sql
-- migration_lock.toml
- dev.db
- dev.db-journal
- schema.prisma
</code><!--]--></pre><!--]--><p><!--[-->We should now be hooked up and ready to authenticate on the client.<!--]--></p><h3 id="_5-client-side-authentication"><a href="#_5-client-side-authentication"><!--[-->5. Client-side Authentication<!--]--></a></h3><blockquote><!--[--><p><!--[-->Let&#39;s now interact with the server-side code on the client.<!--]--></p><!--]--></blockquote><p><!--[-->First, convert your <code class=""><!--[-->app.vue<!--]--></code> file to navigate users to <code class=""><!--[-->NuxtPage<!--]--></code>:<!--]--></p><!--[--><pre class="language-html" style=""><!--[--><code>// app.vue
&lt;template&gt;
  &lt;div&gt;
    &lt;NuxtPage /&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code><!--]--></pre><!--]--><p><!--[-->And create a <code class=""><!--[-->pages<!--]--></code> directory with the file <code class=""><!--[-->index.vue<!--]--></code>:<!--]--></p><!--[--><pre class="language-html" style=""><!--[--><code>// pages/index.vue
&lt;script lang=&quot;ts&quot; setup&gt;&lt;/script&gt;

&lt;template&gt;
  &lt;div&gt;Hello World&lt;/div&gt;
&lt;/template&gt;
</code><!--]--></pre><!--]--><p><!--[-->We can now hook into the <a href="https://auth.sidebase.io/guide/application-side/session-access#useauth-composable" rel="nofollow"><!--[-->useAuth<!--]--></a> composable exposed by @sidebase/nuxt-auth and create signin and signout buttons as well as dynamically rendering the user&#39;s authentication status.<!--]--></p><!--[--><pre class="language-html" style=""><!--[--><code>// pages/index.vue
&lt;script lang=&quot;ts&quot; setup&gt;
const { status, signIn, signOut } = useAuth()
&lt;/script&gt;

&lt;template&gt;
  &lt;div&gt;You are currently {{ status }}.&lt;/div&gt;
  &lt;div v-if=&quot;status === &#39;authenticated&#39;&quot;&gt;
    &lt;button @click=&quot;signOut()&quot;&gt;Sign out&lt;/button&gt;
  &lt;/div&gt;
  &lt;div v-else&gt;
    &lt;button @click=&quot;signIn(&#39;github&#39;)&quot;&gt;Sign in with GitHub&lt;/button&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code><!--]--></pre><!--]--><p><!--[--><strong><!--[-->Optional:<!--]--></strong> Here&#39;s a code snippet with a bit of styling:<!--]--></p><!--[--><pre class="language-html" style=""><!--[--><code>// pages/index.vue

&lt;script setup lang=&quot;ts&quot;&gt;
const { status, signIn, signOut } = useAuth()
&lt;/script&gt;

&lt;template&gt;
  &lt;div class=&quot;h-screen w-screen flex items-center justify-center&quot;&gt;
    &lt;div class=&quot;flex flex-col gap-4&quot;&gt;
      &lt;div&gt;You are currently {{ status }}.&lt;/div&gt;
      &lt;div&gt;
        &lt;div v-if=&quot;status === &#39;authenticated&#39;&quot;&gt;
          &lt;button
            class=&quot;flex items-center justify-center px-4 py-2 bg-gray-900 text-white rounded-md hover:bg-gray-700 transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500&quot;
            @click=&quot;signOut()&quot;
          &gt;
            Sign out
          &lt;/button&gt;
        &lt;/div&gt;
        &lt;div v-else&gt;
          &lt;button
            @click=&quot;signIn(&#39;github&#39;)&quot;
            class=&quot;flex items-center justify-center px-4 py-2 bg-gray-900 text-white rounded-md hover:bg-gray-700 transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500&quot;
          &gt;
            &lt;svg
              class=&quot;w-5 h-5 mr-2&quot;
              fill=&quot;currentColor&quot;
              viewBox=&quot;0 0 20 20&quot;
              xmlns=&quot;http://www.w3.org/2000/svg&quot;
            &gt;
              &lt;path
                fill-rule=&quot;evenodd&quot;
                d=&quot;M10 0C4.477 0 0 4.484 0 10.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0110 4.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.203 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.942.359.31.678.921.678 1.856 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0020 10.017C20 4.484 15.522 0 10 0z&quot;
                clip-rule=&quot;evenodd&quot;
              /&gt;
            &lt;/svg&gt;
            Sign in with GitHub
          &lt;/button&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code><!--]--></pre><!--]--><p><!--[-->You should now be able to sign in and out using Github!<!--]--></p><h2 id="_04-pricing-page"><a href="#_04-pricing-page"><!--[-->04 - Pricing Page<!--]--></a></h2><blockquote><!--[--><p><!--[-->This section is optional but I think many people will appreciate it.<!--]--></p><!--]--></blockquote><p><!--[-->We will create the pricing page that people tend to expect when buying an online product:<!--]--></p><p><!--[--><img src="https://cln.sh/dKfgxlB3+" alt="Pricing Page|800"><!--]--></p><h3 id="auth-menu-avatar"><a href="#auth-menu-avatar"><!--[-->Auth Menu / Avatar<!--]--></a></h3><p><!--[-->Let&#39;s start with the avatar in the top right corner.<!--]--></p><p><!--[-->When logged in, this will show the avatar image you are using on Github. When logged out, this will be a simple sign in button. It also has a few dropdown menu options.<!--]--></p><p><!--[--><img src="https://cln.sh/Pq0tptg2+" alt="Auth Menu|300"><!--]--></p><p><!--[-->This component heavily relies on TailwindCSS and <a href="https://headlessui.com/v1/vue" rel="nofollow"><!--[-->HeadlessUI<!--]--></a>.<!--]--></p><p><!--[-->I start with the <code class=""><!--[-->AuthAvatar<!--]--></code>, which is simply the circle with the image in it:<!--]--></p><!--[--><pre class="language-html" style=""><!--[--><code>// components/AuthAvatar.vue
&lt;script lang=&quot;ts&quot; setup&gt;
interface Props {
  src: string | null | undefined
}
defineProps&lt;Props&gt;()
&lt;/script&gt;

&lt;template&gt;
  &lt;img
    v-if=&quot;src&quot;
    class=&quot;inline-block h-10 w-10 rounded-full bg-gray-500&quot;
    :src=&quot;src&quot;
    alt=&quot;User avatar&quot;
  /&gt;
  &lt;span
    v-else
    class=&quot;inline-block h-10 w-10 overflow-hidden rounded-full bg-gray-100&quot;
  &gt;
    &lt;svg
      class=&quot;h-full w-full text-gray-300&quot;
      fill=&quot;currentColor&quot;
      viewBox=&quot;0 0 24 24&quot;
    &gt;
      &lt;path
        d=&quot;M24 20.993V24H0v-2.996A14.977 14.977 0 0112.004 15c4.904 0 9.26 2.354 11.996 5.993zM16.002 8.999a4 4 0 11-8 0 4 4 0 018 0z&quot;
      /&gt;
    &lt;/svg&gt;
  &lt;/span&gt;
&lt;/template&gt;
</code><!--]--></pre><!--]--><p><!--[-->And then I use this within the <code class=""><!--[-->AuthMenu<!--]--></code> component. It&#39;s a relatively simple component once HeadlessUI does the heavy lifting:<!--]--></p><!--[--><pre class="language-html" style=""><!--[--><code>// components/AuthMenu.vue
&lt;script setup lang=&quot;ts&quot;&gt;
import { Popover, PopoverButton, PopoverPanel } from &#39;@headlessui/vue&#39;
const { data, signOut } = useAuth()
const solutions = [
  { name: &#39;Manage Billing&#39;, fn: () =&gt; {} },
  { name: &#39;Sign Out&#39;, fn: signOut },
]
&lt;/script&gt;

&lt;template&gt;
  &lt;Popover class=&quot;relative&quot;&gt;
    &lt;PopoverButton
      class=&quot;inline-flex items-center gap-x-1 text-sm font-semibold leading-6 text-gray-900&quot;
    &gt;
      &lt;AuthAvatar :src=&quot;data?.user?.image&quot; /&gt;
    &lt;/PopoverButton&gt;
    &lt;transition
      enter-active-class=&quot;transition ease-out duration-200&quot;
      enter-from-class=&quot;opacity-0 translate-y-1&quot;
      enter-to-class=&quot;opacity-100 translate-y-0&quot;
      leave-active-class=&quot;transition ease-in duration-150&quot;
      leave-from-class=&quot;opacity-100 translate-y-0&quot;
      leave-to-class=&quot;opacity-0 translate-y-1&quot;
    &gt;
      &lt;PopoverPanel
        class=&quot;absolute left-1/2 z-10 mt-2 flex w-screen max-w-min -translate-x-[90%] px-4&quot;
      &gt;
        &lt;div
          class=&quot;w-44 shrink rounded-xl bg-white p-4 text-sm font-semibold leading-6 text-gray-900 shadow-lg ring-1 ring-gray-900/5&quot;
        &gt;
         &lt;button
            v-for=&quot;item in solutions&quot;
            :key=&quot;item.name&quot;
            @click=&quot;() =&gt; item.fn()&quot;
            class=&quot;block p-2 hover:text-indigo-600&quot;
          &gt;
            {{ item.name }}
          &lt;/button&gt;
        &lt;/div&gt;
      &lt;/PopoverPanel&gt;
    &lt;/transition&gt;
  &lt;/Popover&gt;
&lt;/template&gt;
</code><!--]--></pre><!--]--><h3 id="pricing-section"><a href="#pricing-section"><!--[-->Pricing Section<!--]--></a></h3><p><!--[-->Now, let&#39;s implement the <code class=""><!--[-->PricingSection<!--]--></code>, which contains the cards and the majority of the UI:<!--]--></p><!--[--><pre class="language-html" style=""><!--[--><code>// components/PricingSection.vue
&lt;script setup lang=&quot;ts&quot;&gt;
import { CheckIcon } from &#39;@heroicons/vue/20/solid&#39;
const { status, signIn } = useAuth()
const handleBuyNow = () =&gt; {
  if (status.value === &#39;authenticated&#39;) {
  } else {
    signIn(&#39;github&#39;)
  }
}
const tiers = [
  {
    name: &#39;Freelancer&#39;,
    id: &#39;tier-freelancer&#39;,
    href: &#39;#&#39;,
    priceMonthly: &#39;$24&#39;,
    description: &#39;The essentials to provide your best work for clients.&#39;,
    features: [
      &#39;5 products&#39;,
      &#39;Up to 1,000 subscribers&#39;,
      &#39;Basic analytics&#39;,
      &#39;48-hour support response time&#39;,
    ],
    mostPopular: false,
  },
  {
    name: &#39;Startup&#39;,
    id: &#39;tier-startup&#39;,
    href: &#39;#&#39;,
    priceMonthly: &#39;$32&#39;,
    description: &#39;A plan that scales with your rapidly growing business.&#39;,
    features: [
      &#39;25 products&#39;,
      &#39;Up to 10,000 subscribers&#39;,
      &#39;Advanced analytics&#39;,
      &#39;24-hour support response time&#39;,
      &#39;Marketing automations&#39;,
    ],
    mostPopular: true,
  },
  {
    name: &#39;Enterprise&#39;,
    id: &#39;tier-enterprise&#39;,
    href: &#39;#&#39;,
    priceMonthly: &#39;$48&#39;,
    description: &#39;Dedicated support and infrastructure for your company.&#39;,
    features: [
      &#39;Unlimited products&#39;,
      &#39;Unlimited subscribers&#39;,
      &#39;Advanced analytics&#39;,
      &#39;1-hour, dedicated support response time&#39;,
      &#39;Marketing automations&#39;,
    ],
    mostPopular: false,
  },
]
&lt;/script&gt;

&lt;template&gt;
  &lt;div class=&quot;bg-white py-10&quot;&gt;
    &lt;div class=&quot;mx-auto max-w-7xl px-6 lg:px-8&quot;&gt;
      &lt;div class=&quot;mx-auto max-w-4xl text-center&quot;&gt;
        &lt;h2 class=&quot;text-base font-semibold leading-7 text-indigo-600&quot;&gt;
          Pricing
        &lt;/h2&gt;
        &lt;p
          class=&quot;mt-2 text-4xl font-bold tracking-tight text-gray-900 sm:text-5xl&quot;
        &gt;
          Pricing plans for teams of&amp;nbsp;all&amp;nbsp;sizes
        &lt;/p&gt;
      &lt;/div&gt;
      &lt;p
        class=&quot;mx-auto mt-6 max-w-2xl text-center text-lg leading-8 text-gray-600&quot;
      &gt;
        Distinctio et nulla eum soluta et neque labore quibusdam. Saepe et quasi
        iusto modi velit ut non voluptas in. Explicabo id ut laborum.
      &lt;/p&gt;
      &lt;div
        class=&quot;isolate mx-auto mt-16 grid max-w-md grid-cols-1 gap-y-8 sm:mt-20 lg:mx-0 lg:max-w-none lg:grid-cols-3&quot;
      &gt;
        &lt;div
          v-for=&quot;(tier, tierIdx) in tiers&quot;
          :key=&quot;tier.id&quot;
          :class=&quot;[
            tier.mostPopular ? &#39;lg:z-10 lg:rounded-b-none&#39; : &#39;lg:mt-8&#39;,
            tierIdx === 0 ? &#39;lg:rounded-r-none&#39; : &#39;&#39;,
            tierIdx === tiers.length - 1 ? &#39;lg:rounded-l-none&#39; : &#39;&#39;,
            &#39;flex flex-col justify-between rounded-3xl bg-white p-8 ring-1 ring-gray-200 xl:p-10&#39;,
          ]&quot;
        &gt;
          &lt;div&gt;
            &lt;div class=&quot;flex items-center justify-between gap-x-4&quot;&gt;
              &lt;h3
                :id=&quot;tier.id&quot;
                :class=&quot;[
                  tier.mostPopular ? &#39;text-indigo-600&#39; : &#39;text-gray-900&#39;,
                  &#39;text-lg font-semibold leading-8&#39;,
                ]&quot;
              &gt;
                {{ tier.name }}
              &lt;/h3&gt;
              &lt;p
                v-if=&quot;tier.mostPopular&quot;
                class=&quot;rounded-full bg-indigo-600/10 px-2.5 py-1 text-xs font-semibold leading-5 text-indigo-600&quot;
              &gt;
                Most popular
              &lt;/p&gt;
            &lt;/div&gt;
            &lt;p class=&quot;mt-4 text-sm leading-6 text-gray-600&quot;&gt;
              {{ tier.description }}
            &lt;/p&gt;
            &lt;p class=&quot;mt-6 flex items-baseline gap-x-1&quot;&gt;
              &lt;span class=&quot;text-4xl font-bold tracking-tight text-gray-900&quot;&gt;{{
                tier.priceMonthly
              }}&lt;/span&gt;
              &lt;span class=&quot;text-sm font-semibold leading-6 text-gray-600&quot;
                &gt;/month&lt;/span
              &gt;
            &lt;/p&gt;
            &lt;ul
              role=&quot;list&quot;
              class=&quot;mt-8 space-y-3 text-sm leading-6 text-gray-600&quot;
            &gt;
              &lt;li
                v-for=&quot;feature in tier.features&quot;
                :key=&quot;feature&quot;
                class=&quot;flex gap-x-3&quot;
              &gt;
                &lt;CheckIcon
                  class=&quot;h-6 w-5 flex-none text-indigo-600&quot;
                  aria-hidden=&quot;true&quot;
                /&gt;
                {{ feature }}
              &lt;/li&gt;
            &lt;/ul&gt;
          &lt;/div&gt;
          &lt;button
            @click=&quot;handleBuyNow&quot;
            :aria-describedby=&quot;tier.id&quot;
            :class=&quot;[
              tier.mostPopular
                ? &#39;bg-indigo-600 text-white shadow-sm hover:bg-indigo-500&#39;
                : &#39;text-indigo-600 ring-1 ring-inset ring-indigo-200 hover:ring-indigo-300&#39;,
              &#39;mt-8 block rounded-md px-3 py-2 text-center text-sm font-semibold leading-6 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600&#39;,
            ]&quot;
          &gt;
            Buy plan
          &lt;/button&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code><!--]--></pre><!--]--><p><!--[-->These component&#39;s are entirely UI-related right now with some auth-related logic sprinkled in. In later sections, we will expand on them and implement the Stripe-related code.<!--]--></p><h3 id="appvue"><a href="#appvue"><!--[-->App.vue<!--]--></a></h3><p><!--[-->One thing I like to do is place the <code class=""><!--[-->AuthMenu<!--]--></code> within my <code class=""><!--[-->app.vue<!--]--></code> file in my root. This ensures the user menu is available throughout the web application, giving users the ability to logout and manage their settings.<!--]--></p><!--[--><pre class="language-html" style=""><!--[--><code>// app.vue
&lt;script setup lang=&quot;ts&quot;&gt;
const { status, signIn } = useAuth()
&lt;/script&gt;

&lt;template&gt;
  &lt;div&gt;
    &lt;div class=&quot;right-4 top-4 absolute&quot;&gt;
      &lt;AuthMenu v-if=&quot;status === &#39;authenticated&#39;&quot; /&gt;
      &lt;button v-else @click=&quot;() =&gt; signIn(&#39;github&#39;)&quot;&gt;Sign In&lt;/button&gt;
    &lt;/div&gt;
    &lt;NuxtPage /&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code><!--]--></pre><!--]--><h2 id="_05-stripe-customer"><a href="#_05-stripe-customer"><!--[-->05 - Stripe Customer<!--]--></a></h2><blockquote><!--[--><p><!--[-->Let&#39;s begin integrating Stripe into our Nuxt application<!--]--></p><!--]--></blockquote><p><!--[-->We&#39;re going to begin by creating a <a href="https://docs.stripe.com/api/customers" rel="nofollow"><!--[-->Stripe Customer<!--]--></a> when a user is created in our system, and syncing our data with Stripe&#39;s. The customer will maintain the relationship between our data and Stripe&#39;s and be how we access Stripe&#39;s endpoints.<!--]--></p><h3 id="stripe-environment-setup"><a href="#stripe-environment-setup"><!--[-->Stripe environment setup<!--]--></a></h3><p><!--[-->Like with most 3rd-party API&#39;s we integrate with, we will need to add a few API keys. We&#39;ll place these values into our <code class=""><!--[-->.env<!--]--></code> file.
The last time we worked with our <code class=""><!--[-->.env<!--]--></code> file, it looked like this:<!--]--></p><!--[--><pre class="language-shell" style=""><!--[--><code>// .env
GITHUB_CLIENT_ID=&lt;YOUR_VALUE&gt;
GITHUB_CLIENT_SECRET=&lt;YOUR_VALUE&gt;
AUTH_SECRET=&lt;YOUR_VALUE&gt;
</code><!--]--></pre><!--]--><p><!--[-->Let&#39;s add a few variables to this file:<!--]--></p><!--[--><pre class="language-shell" style=""><!--[--><code># .env

# OAUTH
GITHUB_CLIENT_ID=&lt;YOUR_VALUE&gt;
GITHUB_CLIENT_SECRET=&lt;YOUR_VALUE&gt;

# AUTH
AUTH_SECRET=&lt;YOUR_VALUE&gt;

# DB
DATABASE_URL=&lt;YOUR_VALUE&gt;

# STRIPE
STRIPE_PUBLISHABLE_KEY=
STRIPE_SECRET_KEY=
STRIPE_WEBHOOK_SECRET_KEY=
</code><!--]--></pre><!--]--><p><!--[--><strong><!--[-->Note:<!--]--></strong> When you ran <code class=""><!--[-->npx prisma init --datasource-provider sqlite<!--]--></code> earlier, the <code class=""><!--[-->DATABASE_URL<!--]--></code> value should have been generated. It&#39;s the a path to your database.<!--]--></p><p><!--[-->The new keys we&#39;ll be adding are <code class=""><!--[-->STRIPE_PUBLISHABLE_KEY<!--]--></code>, <code class=""><!--[-->STRIPE_SECRET_KEY<!--]--></code>, and <code class=""><!--[-->STRIPE_WEBHOOK_SECRET_KEY<!--]--></code>.<!--]--></p><p><!--[-->To get these, navigate to <a href="https://stripe.com" rel="nofollow"><!--[-->stripe.com<!--]--></a> and create an account. You should then see a banner similar to this:<!--]--></p><p><!--[--><img src="https://cln.sh/1kcXgYJR+" alt="stripe banner|500"><!--]--></p><blockquote><!--[--><p><!--[-->The highlighted regions are the <code class=""><!--[-->STRIPE_PUBLISHABLE_KEY<!--]--></code> and <code class=""><!--[-->STRIPE_SECRET_KEY<!--]--></code> values.<!--]--></p><!--]--></blockquote><p><!--[--><strong><!--[-->Note:<!--]--></strong> We&#39;ll add the <code class=""><!--[-->STRIPE_WEBHOOK_SECRET_KEY<!--]--></code> value in the next lesson.<!--]--></p><p><!--[-->With these environment variables in place, make sure to add them to your <code class=""><!--[-->runtimeConfig<!--]--></code> within your <code class=""><!--[-->nuxt.config.ts<!--]--></code> file:<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code>export default defineNuxtConfig({
  ...,
  runtimeConfig: {
    AUTH_SECRET: process.env.AUTH_SECRET,
    GITHUB_CLIENT_ID: process.env.GITHUB_CLIENT_ID,
    GITHUB_CLIENT_SECRET: process.env.GITHUB_CLIENT_SECRET,
    STRIPE_PUBLISHABLE_KEY: process.env.STRIPE_PUBLISHABLE_KEY,
    STRIPE_WEBHOOK_SECRET_KEY: process.env.STRIPE_WEBHOOK_SECRET_KEY,
    STRIPE_SECRET_KEY: process.env.STRIPE_SECRET_KEY,
  },
  ...,
})
</code><!--]--></pre><!--]--><h3 id="db-schema-changes"><a href="#db-schema-changes"><!--[-->DB Schema Changes<!--]--></a></h3><p><!--[-->We need to make a few minor adjustments to our Database&#39;s <code class=""><!--[-->Account<!--]--></code> table. We need a <code class=""><!--[-->stripe_customer_id<!--]--></code> value which connects our user&#39;s Account to Stripe so we can query <a href="https://docs.stripe.com/api/customers" rel="nofollow"><!--[-->customer endpoints<!--]--></a>. We&#39;re also going to use a basic <code class=""><!--[-->is_subscribed<!--]--></code> boolean to keep track of whether the user is subscribed or not.<!--]--></p><p><!--[-->Add these values to your <code class=""><!--[-->schema.prisma<!--]--></code> file:<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code>  stripe_customer_id String? @unique
  is_subscribed      Boolean @default(false)
</code><!--]--></pre><!--]--><p><!--[-->Your <code class=""><!--[-->Account<!--]--></code> schema should now look like this:<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code>// schema.prisma
model Account {
  id                String  @id @default(cuid())
  userId            String
  type              String
  provider          String
  providerAccountId String
  refresh_token     String?
  access_token      String?
  expires_at        Int?
  token_type        String?
  scope             String?
  id_token          String?
  session_state     String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  stripe_customer_id String? @unique
  is_subscribed      Boolean @default(false)

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([provider, providerAccountId])
}
</code><!--]--></pre><!--]--><p><!--[-->After these changes, make sure to run <code class=""><!--[-->npx prisma generate<!--]--></code> and <code class=""><!--[-->npx prisma migrate dev<!--]--></code>. Name the migration whatever you think is appropriate.<!--]--></p><h3 id="stripe-util"><a href="#stripe-util"><!--[-->Stripe Util<!--]--></a></h3><p><!--[-->Create a file located at <code class=""><!--[-->server/util/stripe.ts<!--]--></code>. This is a simple utility file that will create a new stripe object that we will pass around our application as needed.<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code>// server/util/stripe.ts
import Stripe from &#39;stripe&#39;

export const stripe = new Stripe(useRuntimeConfig().STRIPE_SECRET_KEY)
</code><!--]--></pre><!--]--><h3 id="create-customer-on-sign-up"><a href="#create-customer-on-sign-up"><!--[-->Create Customer on Sign Up<!--]--></a></h3><p><!--[-->The goal here is after we create a User&#39;s Account in our database we create the Stripe Customer and save the Stripe Customer&#39;s id in our Account table.<!--]--></p><p><!--[-->To do this, we need to hook into the <code class=""><!--[-->PrismaAdapter<!--]--></code> that is used within our <code class=""><!--[-->api/auth/[...].ts<!--]--></code> endpoint, and extend it to call Stripe&#39;s API.<!--]--></p><p><!--[-->In <span>...</span>.ts, import our stripe utility:<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code>import { stripe } from &#39;~/server/utils/stripe&#39;
</code><!--]--></pre><!--]--><p><!--[-->Then in our <code class=""><!--[-->NuxtAuthHandler<!--]--></code>, we need to use the spread operator on our <code class=""><!--[-->PrismaAdapter<!--]--></code> and override the <code class=""><!--[-->linkAccount<!--]--></code> function:<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code> adapter: {
    ...PrismaAdapter(prisma),
    async linkAccount(account) {
      const user = await prisma.user.findUniqueOrThrow({
        where: { id: account.userId },
      })

      if (!user.email) {
        throw new Error(&#39;User email is required to create a Stripe customer&#39;)
      }

      const customer = await stripe.customers.create({ email: user.email })

      return prisma.account.create({
        data: {
          ...account,
          stripe_customer_id: customer.id,
        },
      })
    },
  },
</code><!--]--></pre><!--]--><p><!--[-->You can read further into the <code class=""><!--[-->PrismaAdapter<!--]--></code>&#39;s source code on <a href="https://github.com/nextauthjs/next-auth/blob/main/packages/adapter-prisma/src/index.ts#L48" rel="nofollow"><!--[-->Github<!--]--></a>. It&#39;s simply running <code class=""><!--[-->p.account.create({ data })<!--]--></code>.
We extend this and first get the new user&#39;s email which is required to create a Stripe customer. With the newly acquired user&#39;s email, we create a stripe customer and then run:<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code>prisma.account.create({
    data: {
        ...account,
        stripe_customer_id: customer.id,
    },
})
</code><!--]--></pre><!--]--><p><!--[-->This is nearly the same as the original <code class=""><!--[-->linkAccount<!--]--></code> function, just with the addition of <code class=""><!--[-->stripe_customer_id: customer.id,<!--]--></code>.<!--]--></p><p><!--[-->Your <code class=""><!--[-->api/auth/[...].ts<!--]--></code> file should now look like this:<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code>import { NuxtAuthHandler } from &#39;#auth&#39;
import { PrismaAdapter } from &#39;@next-auth/prisma-adapter&#39;
import { PrismaClient } from &#39;@prisma/client&#39;
import { stripe } from &#39;~/server/utils/stripe&#39;

const runtimeConfig = useRuntimeConfig()
const prisma = new PrismaClient()

export default NuxtAuthHandler({
  secret: runtimeConfig.AUTH_SECRET,
  adapter: {
    ...PrismaAdapter(prisma),
    async linkAccount(account) {
      const user = await prisma.user.findUniqueOrThrow({
        where: { id: account.userId },
      })

      if (!user.email) {
        throw new Error(&#39;User email is required to create a Stripe customer&#39;)
      }

      const customer = await stripe.customers.create({ email: user.email })

      return prisma.account.create({
        data: {
          ...account,
          stripe_customer_id: customer.id,
        },
      })
    },
  },
  providers: [
    // @ts-expect-error
    GithubProvider.default({
      clientId: runtimeConfig.GITHUB_CLIENT_ID,
      clientSecret: runtimeConfig.GITHUB_CLIENT_SECRET,
    }),
  ],
})
</code><!--]--></pre><!--]--><p><!--[-->Now, when you create an account, you should see the <code class=""><!--[-->stripe_customer_id<!--]--></code> column in your <code class=""><!--[-->Account<!--]--></code> database have a unique identifier. You can run <code class=""><!--[-->npx prisma studio<!--]--></code> to serve a a <a href="https://www.prisma.io/studio" rel="nofollow"><!--[-->Prisma Studio<!--]--></a> instance where you can view the data in your browser.<!--]--></p><p><!--[-->Navigate to <a href="https://dashboard.stripe.com/nuxt-stripe/customers" rel="nofollow"><!--[-->https://dashboard.stripe.com/nuxt-stripe/customers<!--]--></a> and you should see the Customer table with that a new value. If you click on the customer, you should see somewhere on that page a Customer ID with a value that matches what is in your database.<!--]--></p><h2 id="_06-stripe-checkout"><a href="#_06-stripe-checkout"><!--[-->06 - Stripe Checkout<!--]--></a></h2><p><!--[-->We&#39;re going to be using <a href="https://stripe.com/payments/checkout" rel="nofollow"><!--[-->Stripe Checkout<!--]--></a> for our payment flow. If you&#39;ve used Stripe in the past, this was probably the flow you used. We will run a function on our server that talks to Stripe and returns a URL.<!--]--></p><p><!--[-->This URL is then passed to our client and redirects users to a page that Stripe hosts. This page handles the transactions, billing information, and subscription information.<!--]--></p><h3 id="product"><a href="#product"><!--[-->Product<!--]--></a></h3><p><!--[-->Before we dive into code, we need to create the product that the user will purchase. Navigate to <a href="https://dashboard.stripe.com/nuxt-stripe/products" rel="nofollow"><!--[-->https://dashboard.stripe.com/nuxt-stripe/products<!--]--></a> and click <code class=""><!--[-->+ Add product<!--]--></code>.<!--]--></p><p><!--[-->I am using three different products in this project to match the three subscription tiers I plan to support: <code class=""><!--[-->startup<!--]--></code>, <code class=""><!--[-->freelance<!--]--></code>, and <code class=""><!--[-->enterprise<!--]--></code>. You may create as many products as you wish with the specific prices and details that match your needs.<!--]--></p><p><!--[-->What is <strong><!--[-->important<!--]--></strong> is clicking the More pricing options option in the Add product drawer. This will bring up a second drawer with a detailed view of our product. Scroll down a bit and you should see a <code class=""><!--[-->Lookup key<!--]--></code> set this to something logical. The lookup key for my Freelancer tier is <code class=""><!--[-->tier-freelancer<!--]--></code>. We will reference these keys in our code.<!--]--></p><h3 id="stripe-checkout-endpoint"><a href="#stripe-checkout-endpoint"><!--[-->Stripe Checkout Endpoint<!--]--></a></h3><blockquote><!--[--><p><!--[-->We&#39;ll start with the Checkout Session endpoint.<!--]--></p><!--]--></blockquote><p><!--[-->Create a file at <code class=""><!--[-->server/api/stripe/create-checkout-session.ts<!--]--></code> that contains the code:<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code>// 1
import { stripe } from &#39;~/server/utils/stripe&#39;
import { getServerSession } from &#39;#auth&#39;
import { PrismaClient } from &#39;@prisma/client&#39;

const prisma = new PrismaClient()

export default eventHandler(async event =&gt; {
  // 2
  const { lookup_key } = await readBody(event)
  // 3
  const authSession = await getServerSession(event)

  if (authSession &amp;&amp; authSession.user?.email) {
    const account = await prisma.account.findFirst({
      where: {
        user: {
          email: authSession.user.email,
        },
      },
    })

    // 4
    if (account &amp;&amp; account.stripe_customer_id &amp;&amp; !account.is_subscribed) {
     // 5
      const prices = await stripe.prices.list({
        lookup_keys: [lookup_key],
        expand: [&#39;data.product&#39;],
      })

      // 6
      const session = await stripe.checkout.sessions.create({
        customer: account.stripe_customer_id,         // 6.1
        billing_address_collection: &#39;auto&#39;,           // 6.2
        line_items: [                                 // 6.3
          {
            price: prices.data[0].id,
            quantity: 1,
          },
        ],
        mode: &#39;subscription&#39;,                         // 6.4
        success_url: `http://localhost:3000/success`, // 6.5
        cancel_url: `http://localhost:3000/cancelled`,
      })

      if (session.url) {
        return { url: session.url }
      }
    }
  }
})
</code><!--]--></pre><!--]--><p><!--[-->I understand this endpoint is a bit hefty, but I&#39;ll try my best to explain what it&#39;s doing:<!--]--></p><ol><!--[--><li><!--[-->We import the <code class=""><!--[-->stripe<!--]--></code> that&#39;s created in our <code class=""><!--[-->server/utils/stripe.ts<!--]--></code> file.<ul><!--[--><li><!--[-->This will be used to get the product and the checkout session.<!--]--></li><!--]--></ul><!--]--></li><li><!--[-->Within our endpoint (<code class=""><!--[-->eventHandler<!--]--></code>), we read from the request body.<ul><!--[--><li><!--[-->In our use case, <code class=""><!--[-->body<!--]--></code> is only used to acquire the <code class=""><!--[-->lookup_key<!--]--></code> so we de-structure the body object and extract the <code class=""><!--[-->lookup_key<!--]--></code> variable.<!--]--></li><!--]--></ul><!--]--></li><li><!--[-->We use Nuxt Auth&#39;s <a href="https://auth.sidebase.io/guide/authjs/server-side/session-access" rel="nofollow"><!--[-->getServerSession<!--]--></a> function to ensure whoever is calling this endpoint is logged in and save the session data into a variable.<ul><!--[--><li><!--[-->This session variable has the user&#39;s email, which we will use to get access to the <code class=""><!--[-->Account<!--]--></code> table which then gives us access to the <code class=""><!--[-->account.stripe_customer_id<!--]--></code>.<!--]--></li><!--]--></ul><!--]--></li><li><!--[-->We do a basic check <code class=""><!--[-->if (account &amp;&amp; account.stripe_customer_id &amp;&amp; !account.is_subscribed)<!--]--></code> to ensure the account exists, it has a stripe customer id, and it is not currently subscribed.<!--]--></li><li><!--[-->If this is the case, we run <code class=""><!--[-->stripe.prices.list()<!--]--></code> with the <code class=""><!--[-->lookup_key<!--]--></code> that is specific to our product to get the <strong><!--[-->prices<!--]--></strong> of the product.<ul><!--[--><li><!--[-->Prices is plural because this will eventually be used to manage monthly and/or yearly subscriptions.<!--]--></li><!--]--></ul><!--]--></li><li><!--[-->With the prices and <code class=""><!--[-->stripe_customer_id<!--]--></code>, we are able to call <code class=""><!--[-->stripe.checkout.sessions.create()<!--]--></code>.<ol><!--[--><li><!--[-->We set the customer to stripe_customer_id<!--]--></li><li><!--[--><code class=""><!--[-->billing_address_collection<!--]--></code> is set to <code class=""><!--[-->&#39;auto&#39;<!--]--></code>.<!--]--></li><li><!--[--><code class=""><!--[-->line_items<!--]--></code> is set to the price and quantity of the product we are selling. In this case, a single subscription.<!--]--></li><li><!--[--><code class=""><!--[-->mode<!--]--></code> defines the fact that we are selling a recurring subscription.<!--]--></li><li><!--[--><code class=""><!--[-->success_url<!--]--></code> and <code class=""><!--[-->cancel_url<!--]--></code> are defined to tell Stripe where to redirect users based on certain actions they interact with on the generated checkout page. We&#39;ll build these pages later on in this lesson.<!--]--></li><!--]--></ol><!--]--></li><!--]--></ol><h3 id="client-side-checkout"><a href="#client-side-checkout"><!--[-->Client-side Checkout<!--]--></a></h3><p><!--[-->With our endpoint setup, let&#39;s interact with it on the frontend. We&#39;ll implement this login within our <code class=""><!--[-->PricingSection.vue<!--]--></code> component.<!--]--></p><p><!--[-->I&#39;m able to encompass the majority of this logic with a new <code class=""><!--[-->checkout<!--]--></code> function:<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code>// components/PricingSection.vue
const checkout = async () =&gt; {
  // 1
  const PRICE_LOOKUP_KEY = &#39;tier-freelancer&#39;
  // 2
  const res = await $fetch(&#39;/api/stripe/create-checkout-session&#39;, {
    method: &#39;POST&#39;,
    body: {
      lookup_key: PRICE_LOOKUP_KEY,
    },
  })

  if (res) {
    // 3
    await navigateTo(res.url, {
      external: true,
    })
  }
}
</code><!--]--></pre><!--]--><ol><!--[--><li><!--[-->We are manually setting the lookup_key that we pass to our <code class=""><!--[-->create-checkout-session<!--]--></code> endpoint.
<ul><!--[--><li><!--[-->This will eventually be dynamic and adjust based on the card we click on.<!--]--></li><!--]--></ul><!--]--></li><li><!--[-->Here is a simple fetch request to our endpoint.<!--]--></li><li><!--[-->We use Nuxt&#39;s <a href="https://nuxt.com/docs/api/utils/navigate-to" rel="nofollow"><!--[-->navigateTo<!--]--></a> helper function with the <code class=""><!--[-->external<!--]--></code> option to redirect users to the url that&#39;s returned.<!--]--></li><!--]--></ol><p><!--[-->We then hook this in to our <code class=""><!--[-->handleBuyNow<!--]--></code> function:<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code>// components/PricingSection.vue
const handleBuyNow = async () =&gt; {
  if (status.value === &#39;authenticated&#39;) {
    await checkout()
  } else {
    signIn(&#39;github&#39;)
  }
}
</code><!--]--></pre><!--]--><h3 id="successcancel-pages"><a href="#successcancel-pages"><!--[-->Success/Cancel Pages<!--]--></a></h3><p><!--[-->Remember our <code class=""><!--[-->create-checkout-session<!--]--></code> endpoint had the following lines in the <code class=""><!--[-->stripe.sessions.create()<!--]--></code> function call?<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code>success_url: `http://localhost:3000/success`,
cancel_url: `http://localhost:3000/cancelled`,
</code><!--]--></pre><!--]--><p><!--[-->The <code class=""><!--[-->success<!--]--></code> and <code class=""><!--[-->cancelled<!--]--></code> pages are technically optional, but you do need to implement some client-side logic to handle the success and cancelled states that occur in the checkout session. So, we&#39;ll go the easy route and just create proper pages.<!--]--></p><ul><!--[--><li><!--[-->The success state is the page that Stripe redirects a user to after successfully subscribing.<!--]--></li><li><!--[-->The cancelled state is the page that Stripe redirects a user to after clicking the back button during the checkout session.<!--]--></li><!--]--></ul><p><!--[-->Let&#39;s create them.<!--]--></p><p><!--[-->In your <code class=""><!--[-->pages<!--]--></code> directory, create <code class=""><!--[-->success.vue<!--]--></code> and <code class=""><!--[-->cancelled.vue<!--]--></code> file.<!--]--></p><p><!--[-->I&#39;m not going to do anything creative here, and instead just be direct. I recommend in a proper production app you implement a nice UI state and flow for users that hit these pages.<!--]--></p><!--[--><pre class="language-html" style=""><!--[--><code>// pages/success.vue
&lt;template&gt;
  &lt;div&gt;Success!!&lt;/div&gt;
&lt;/template&gt;
</code><!--]--></pre><!--]--><!--[--><pre class="language-html" style=""><!--[--><code>// pages/cancelled.vue
&lt;template&gt;
  &lt;div&gt;Cancelled!!&lt;/div&gt;
&lt;/template&gt;
</code><!--]--></pre><!--]--><h3 id="stripe-checkout-page"><a href="#stripe-checkout-page"><!--[-->Stripe Checkout Page<!--]--></a></h3><p><!--[-->Now, when you&#39;re logged in and click a Buy plan button, you should see the Stripe Checkout page open:<!--]--></p><p><!--[--><img src="https://cln.sh/FZDtmlLr+" alt="checkout page|500"><!--]--></p><p><!--[-->You can fill in the form using Stripe&#39;s <a href="https://docs.stripe.com/testing" rel="nofollow"><!--[-->test card numbers<!--]--></a>. I typically use their Visa example because it&#39;s easy to remember: <code class=""><!--[-->4242424242424242<!--]--></code>.<!--]--></p><p><!--[-->When you properly fill in the form and click subscribe you should expect to see a few things:<!--]--></p><ol><!--[--><li><!--[-->You should be redirected to your <code class=""><!--[-->/success<!--]--></code> page.<!--]--></li><li><!--[-->You should see a new row in your Stripe Transactions located here: <a href="https://dashboard.stripe.com/nuxt-stripe/payments" rel="nofollow"><!--[-->https://dashboard.stripe.com/nuxt-stripe/payments<!--]--></a><!--]--></li><li><!--[-->You should <strong><!--[-->NOT<!--]--></strong> see <code class=""><!--[-->is_subscribed<!--]--></code> set to true in your database.<!--]--></li><!--]--></ol><p><!--[-->There is still some work to do before the subscription status is reflected in our application, but we are getting close. We now have the transaction taking place and are accepting money through Stripe. We are just missing the step where Stripe tells our server that a successful payment took place. We&#39;ll implement this in the next section.<!--]--></p><h2 id="_07-stripe-webhook"><a href="#_07-stripe-webhook"><!--[-->07 - Stripe Webhook<!--]--></a></h2><p><!--[-->We&#39;ll receive Stripe events by creating a webhook endpoint that Stripe can communicate through. (<a href="https://docs.stripe.com/webhooks" rel="nofollow"><!--[-->docs<!--]--></a>).<!--]--></p><p><!--[-->We&#39;ll need to populate the <code class=""><!--[-->STRIPE_WEBHOOK_SECRET_KEY<!--]--></code> environment variable from earlier.<!--]--></p><h3 id="ngrok"><a href="#ngrok"><!--[-->Ngrok<!--]--></a></h3><p><!--[-->To do this, we&#39;ll need to expose our site to the web so that Stripe can access it.<!--]--></p><p><!--[-->My go-to for rapidly exposing my endpoints to the web is <a href="https://ngrok.com" rel="nofollow"><!--[-->ngrok<!--]--></a>. Download it <a href="https://ngrok.com/download" rel="nofollow"><!--[-->here<!--]--></a> and follow the documentation, get your auth token, and set up ngrok&#39;s CLI.<!--]--></p><p><!--[-->You should be able to run the following command in your terminal:<!--]--></p><!--[--><pre class="language-shell" style=""><!--[--><code>ngrok http 3000
</code><!--]--></pre><!--]--><p><!--[--><strong><!--[-->Note:<!--]--></strong> Make sure your Nuxt application is running on port 3000 (the default port) before you run the ngrok command<!--]--></p><p><!--[-->Your terminal should now look like this:<!--]--></p><p><!--[--><img src="https://cln.sh/h2gqjQmz+" alt="ngrok terminal|500"><!--]--></p><p><!--[-->The <code class=""><!--[-->Forwarding<!--]--></code> URL is important. I&#39;m highlighting it here so that you see it. We will carry this over into the next section.<!--]--></p><h3 id="stripe_webhook_secret_key"><a href="#stripe_webhook_secret_key"><!--[-->STRIPE_WEBHOOK_SECRET_KEY<!--]--></a></h3><p><!--[-->With our server online, navigate to <a href="https://dashboard.stripe.com/nuxt-stripe/webhooks" rel="nofollow"><!--[-->https://dashboard.stripe.com/nuxt-stripe/webhooks<!--]--></a> and click <code class=""><!--[-->+ Add endpoint<!--]--></code> and add the following:<!--]--></p><p><!--[--><code class=""><!--[-->Endpoint URL<!--]--></code>: Paste the ngrok <code class=""><!--[-->Forwarding<!--]--></code> url from earlier. Then, add <code class=""><!--[-->/api/stripe/webhook<!--]--></code> to the end. This endpoint hasn&#39;t been created yet, but we will take care of that soon.<!--]--></p><p><!--[--><code class=""><!--[-->Description<!--]--></code> is optional.<!--]--></p><p><!--[--><code class=""><!--[-->Listen to<!--]--></code>: Events on your account<!--]--></p><p><!--[--><code class=""><!--[-->Select events to listen to<!--]--></code>: Click <code class=""><!--[-->+ Select events<!--]--></code> and search for <em><!--[-->subscription<!--]--></em>. Toggle on <code class=""><!--[-->customer.subscription.created<!--]--></code> and <code class=""><!--[-->customer.subscription.deleted<!--]--></code> and click <code class=""><!--[-->Add events<!--]--></code>.<!--]--></p><p><!--[-->Your form should similar to this:<!--]--></p><p><!--[--><img src="https://cln.sh/W9ZDN7Cm+" alt="Stripe events webhook|500"><!--]--></p><p><!--[-->Now submit the form with <code class=""><!--[-->Add endpoint<!--]--></code>.<!--]--></p><p><!--[-->This should redirect you to a details page on Stripe for your newly submitted Webhook. Look for <code class=""><!--[-->Signing secret<!--]--></code> and click <code class=""><!--[-->Reveal<!--]--></code>. The value that is shown is your <code class=""><!--[-->STRIPE_WEBHOOK_SECRET_KEY<!--]--></code>. Copy and paste it into your <code class=""><!--[-->.env<!--]--></code> file.<!--]--></p><h3 id="webhook-endpoint"><a href="#webhook-endpoint"><!--[-->Webhook Endpoint<!--]--></a></h3><p><!--[-->This one may seem a bit meaty, but a good portion of it is simple error handling. I&#39;ll try my best to explain the code snippet to you:<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code>// server/api/stripe/webhook.ts
import { PrismaClient } from &#39;@prisma/client&#39;
import { stripe } from &#39;~/server/utils/stripe&#39;

const prisma = new PrismaClient()
const runtimeConfig = useRuntimeConfig()

export default eventHandler(async event =&gt; {
  // 1
  const body = await readRawBody(event, false)
  let stripeEvent: any = body
  let subscription
  let status
  // 2
  const signature = getHeader(event, &#39;stripe-signature&#39;)

  if (!body) {
    return { error: &#39;Invalid request body&#39; }
  }

  if (!signature) {
    return { error: &#39;Invalid stripe-signature&#39; }
  }

  try {
    // 3
    stripeEvent = stripe.webhooks.constructEvent(
      body,
      signature,
      runtimeConfig.STRIPE_WEBHOOK_SECRET_KEY
    )
  } catch (err) {
    const error = createError({
      statusCode: 400,
      statusMessage: `Webhook error: ${err}`,
    })
    return sendError(event, error)
  }
  // 4
  switch (stripeEvent.type) {
    // 5
    case &#39;customer.subscription.deleted&#39;:
      subscription = stripeEvent.data.object
      status = subscription.status

      await prisma.account.update({
        where: {
          stripe_customer_id: subscription.customer,
        },
        data: {
          is_subscribed: false,
        },
      })

      break
    // 6
    case &#39;customer.subscription.created&#39;:
      subscription = stripeEvent.data.object
      status = subscription.status

      await prisma.account.update({
        where: {
          stripe_customer_id: subscription.customer,
        },
        data: {
          is_subscribed: true,
        },
      })

      break
    default:
      console.log(`Unhandled event type ${stripeEvent.type}.`)
  }
  return { received: true }
})
</code><!--]--></pre><!--]--><blockquote><!--[--><p><!--[-->At this point, I assume you are familiar with useRuntimeConfig, Prisma, and Stripe constants.<!--]--></p><!--]--></blockquote><ol><!--[--><li><!--[--><a href="https://h3.unjs.io/utils/request#readrawbodyevent-encoding" rel="nofollow"><!--[-->readRawBody<!--]--></a> - Stripe requires the raw body when running <code class=""><!--[-->stripe.webhooks.constructEvent()<!--]--></code>, so we use <code class=""><!--[-->readRawBody<!--]--></code> here. The second parameter, <code class=""><!--[-->false<!--]--></code>, returns it as a <code class=""><!--[-->Buffer<!--]--></code>.<!--]--></li><li><!--[--><code class=""><!--[-->stripe-signature<!--]--></code> - Stripe will send us this header which is passed to the <code class=""><!--[-->constructEvent<!--]--></code> function.<!--]--></li><li><!--[-->We pass the <code class=""><!--[-->body<!--]--></code>, <code class=""><!--[-->signature<!--]--></code>, and <code class=""><!--[-->STRIPE_WEBHOOK_SECRET_KEY<!--]--></code> to construct the Webhook that Stripe sent to us.<!--]--></li><li><!--[-->Now we create a switch statement against the stripe event. I&#39;m only interested in the <code class=""><!--[-->customer.subscription.deleted<!--]--></code> and <code class=""><!--[-->customer.subscription.created<!--]--></code> events, but you can extend this to receive any of the events listed during the <code class=""><!--[-->STRIPE_WEBHOOK_SECRET_KEY<!--]--></code> setup.<!--]--></li><li><!--[-->On the <code class=""><!--[-->customer.subscription.deleted<!--]--></code> event, we find the <code class=""><!--[-->Account<!--]--></code> that contains the <code class=""><!--[-->stripe_customer_id<!--]--></code> that matches the subscription&#39;s customer id. Then we update the <code class=""><!--[-->is_subscribed<!--]--></code> value to false.<!--]--></li><li><!--[-->On the <code class=""><!--[-->customer.subscription.created<!--]--></code> event, we do the same, just this time we update <code class=""><!--[-->is_subscribed<!--]--></code> value to true.<!--]--></li><!--]--></ol><p><!--[-->With this in place, you should be able to go through the Stripe Checkout form and this time, when you successfully submit it, your webhook&#39;s detail page should show the <code class=""><!--[-->customer.subscription.created<!--]--></code> event log:<!--]--></p><p><!--[--><img src="https://cln.sh/b0scQrQ5+" alt="subscription created log|700"><!--]--></p><blockquote><!--[--><p><!--[-->It should be successful, but if it&#39;s not, read the logs. 99% of the time, it&#39;s an API key issue.<!--]--></p><!--]--></blockquote><p><!--[-->With a successful creation webhook event, you should now see <code class=""><!--[-->is_subscribed<!--]--></code> is <code class=""><!--[-->true<!--]--></code> within your Database&#39;s Account table.<!--]--></p><p><!--[--><img src="https://cln.sh/fZbV8B7q+" alt="is subscribed true|500"><!--]--></p><p><!--[-->With this in place, we have successfully implemented a basic subscription system. In the next few sections we will expand on this further to allow our users to manage their subscriptions in a Stripe Portal, chose between multiple subscription tiers, chose between yearly and monthly with dynamic pricing, and manage site permissions based on the subscription chosen.<!--]--></p><h2 id="_08-stripe-customer-portal"><a href="#_08-stripe-customer-portal"><!--[-->08 - Stripe Customer Portal<!--]--></a></h2><p><!--[-->The next step in our Stripe integration is subscription management. We&#39;re accepting users money and updating their subscription status in our database to reflect whether they&#39;ve paid or not.<!--]--></p><p><!--[-->Now we need to give users the ability to manage their subscription. This includes cancelling it, changing their payment method, and seeing their payment history.<!--]--></p><p><!--[-->Luckily for us, the majority of this is taken care of within Stripe. Similar to the Checkout experience, we  need to create the dashboard session url and redirect our users to it.<!--]--></p><h3 id="generate-billingportal-url"><a href="#generate-billingportal-url"><!--[-->Generate BillingPortal URL<!--]--></a></h3><!--[--><pre class="language-ts" style=""><!--[--><code>// server/api/stripe/create-portal-session.ts
import { stripe } from &#39;~/server/utils/stripe&#39;
import { getServerSession } from &#39;#auth&#39;
import { PrismaClient } from &#39;@prisma/client&#39;

const prisma = new PrismaClient()
const baseUrl = &#39;http://localhost:3000&#39;

export default eventHandler(async event =&gt; {
  const session = await getServerSession(event)

  if (!session?.user?.email) {
    return { error: &#39;User not authenticated&#39; }
  }

  const account = await prisma.account.findFirst({
    where: {
      user: {
        email: session.user.email,
      },
    },
  })

  if (!account?.stripe_customer_id) {
    return { error: &#39;Stripe customer not found&#39; }
  }
  // 1
  const portalSession = await stripe.billingPortal.sessions.create({
    customer: account.stripe_customer_id,
    return_url: baseUrl,
  })

  return { url: portalSession.url }
})
</code><!--]--></pre><!--]--><p><!--[-->I&#39;m assuming most of this is getting repetitive and you understand it. But a quick refresher, we get the auth session to ensure the user is logged in and then get their Account so we have access to <code class=""><!--[-->stripe_customer_id<!--]--></code>.<!--]--></p><ol><!--[--><li><!--[-->With <code class=""><!--[-->stripe_customer_id<!--]--></code>, we call <code class=""><!--[-->stripe.billingPortal.sessions.create()<!--]--></code> which generates a URL that we can navigate to on the frontend.<!--]--></li><!--]--></ol><h3 id="usestripe-composable"><a href="#usestripe-composable"><!--[-->useStripe Composable<!--]--></a></h3><p><!--[-->Consuming this endpoint and navigating to the billing portal is straight forward and very similar to the checkout experience:<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code>const navigateToStripeDashboard = async () =&gt; {
    const res = await $fetch(&#39;/api/stripe/create-portal-session&#39;, {
      method: &#39;POST&#39;,
    })

    if (res &amp;&amp; &#39;url&#39; in res) {
      await navigateTo(res.url, {
        external: true,
      })
    } else {
      console.error(&#39;Error creating portal session:&#39;, res.error)
    }
}
</code><!--]--></pre><!--]--><p><!--[-->But at this stage, our <code class=""><!--[-->PricingSection<!--]--></code> component is becoming a bit cluttered, so I decided to move the Stripe-specific functions into a <a href="https://vuejs.org/guide/reusability/composables" rel="nofollow"><!--[-->composable<!--]--></a> called <code class=""><!--[-->useStripe<!--]--></code>.<!--]--></p><p><!--[-->Create a new directory called <code class=""><!--[-->composables<!--]--></code> and within it a file called <code class=""><!--[-->useStripe<!--]--></code>.<!--]--></p><p><!--[-->Extract the checkout function and the tiers from <code class=""><!--[-->PricingSection<!--]--></code> and place them along with our new <code class=""><!--[-->navigateToStripeDashboard<!--]--></code> function into our new file.<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code>// composables/useStripe
export function useStripe() {
  const checkout = async () =&gt; {
    const PRICE_LOOKUP_KEY = &#39;tier-freelancer&#39;

    const res = await $fetch(&#39;/api/stripe/create-checkout-session&#39;, {
      method: &#39;POST&#39;,
      body: {
        lookup_key: PRICE_LOOKUP_KEY,
      },
    })

    if (res) {
      await navigateTo(res.url, {
        external: true,
      })
    }
  }

  const navigateToStripeDashboard = async () =&gt; {
    const res = await $fetch(&#39;/api/stripe/create-portal-session&#39;, {
      method: &#39;POST&#39;,
    })

    if (res &amp;&amp; &#39;url&#39; in res) {
      await navigateTo(res.url, {
        external: true,
      })
    } else {
      console.error(&#39;Error creating portal session:&#39;, res.error)
    }
  }

  const tiers = [
    {
      name: &#39;Freelancer&#39;,
      id: &#39;tier-freelancer&#39;,
      href: &#39;#&#39;,
      priceMonthly: &#39;$24&#39;,
      description: &#39;The essentials to provide your best work for clients.&#39;,
      features: [
        &#39;5 products&#39;,
        &#39;Up to 1,000 subscribers&#39;,
        &#39;Basic analytics&#39;,
        &#39;48-hour support response time&#39;,
      ],
      mostPopular: false,
    },
    {
      name: &#39;Startup&#39;,
      id: &#39;tier-startup&#39;,
      href: &#39;#&#39;,
      priceMonthly: &#39;$32&#39;,
      description: &#39;A plan that scales with your rapidly growing business.&#39;,
      features: [
        &#39;25 products&#39;,
        &#39;Up to 10,000 subscribers&#39;,
        &#39;Advanced analytics&#39;,
        &#39;24-hour support response time&#39;,
        &#39;Marketing automations&#39;,
      ],
      mostPopular: true,
    },
    {
      name: &#39;Enterprise&#39;,
      id: &#39;tier-enterprise&#39;,
      href: &#39;#&#39;,
      priceMonthly: &#39;$48&#39;,
      description: &#39;Dedicated support and infrastructure for your company.&#39;,
      features: [
        &#39;Unlimited products&#39;,
        &#39;Unlimited subscribers&#39;,
        &#39;Advanced analytics&#39;,
        &#39;1-hour, dedicated support response time&#39;,
        &#39;Marketing automations&#39;,
      ],
      mostPopular: false,
    },
  ]

  return { checkout, navigateToStripeDashboard, tiers }
}
</code><!--]--></pre><!--]--><p><!--[-->Now, we can easily re-use these functions throughout our application. You may notice that we&#39;ve been using a composable this entire time with <code class=""><!--[-->useAuth<!--]--></code>.<!--]--></p><p><!--[-->We&#39;ll start using it in our <code class=""><!--[-->AuthMenu<!--]--></code> component. Extract the <code class=""><!--[-->navigateToeStripeDashboard<!--]--></code> function from the <code class=""><!--[-->useStripe<!--]--></code> composable:<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code>const { navigateToStripeDashboard } = useStripe()
</code><!--]--></pre><!--]--><p><!--[-->Then update the <code class=""><!--[-->solutions<!--]--></code> array, replacing the Manage Billing object&#39;s function with our newly defined <code class=""><!--[-->navigateToStripeDashboard<!--]--></code>.<!--]--></p><!--[--><pre class="language-html" style=""><!--[--><code>// components/AuthMenu.vue
&lt;script setup lang=&quot;ts&quot;&gt;
...
const { data, signOut } = useAuth()
const { navigateToStripeDashboard } = useStripe()
const solutions = [
  { name: &#39;Manage Billing&#39;, fn: navigateToStripeDashboard },
  { name: &#39;Sign Out&#39;, fn: signOut },
]
&lt;/script&gt;
&lt;template&gt;
    ...
&lt;/template&gt;
</code><!--]--></pre><!--]--><p><!--[-->Now, when you click the <code class=""><!--[-->Manage Billing<!--]--></code> button within your <code class=""><!--[-->AuthMenu<!--]--></code> dropdown, it should navigate you to a <code class=""><!--[-->billing.stripe.com<!--]--></code> url.<!--]--></p><p><!--[--><img src="https://cln.sh/TBQ7mHth+" alt="stripe billing portal|500"><!--]--></p><p><!--[-->Here you can update or cancel your plan!<!--]--></p><h2 id="_09-composable-refactor"><a href="#_09-composable-refactor"><!--[-->09 - Composable Refactor<!--]--></a></h2><h3 id="issubscribed-check"><a href="#issubscribed-check"><!--[-->isSubscribed Check<!--]--></a></h3><p><!--[-->I want to check against the <code class=""><!--[-->isSubscribed<!--]--></code> value we have attached to our user&#39;s Account to dynamically render content based on this value.<!--]--></p><p><!--[-->To do this, we&#39;re going to tap into Authjs&#39; <a href="https://next-auth.js.org/configuration/callbacks#session-callback" rel="nofollow"><!--[-->session callback<!--]--></a>. The session callback is ran whenever a session is checked.<!--]--></p><p><!--[-->Navigate to our <code class=""><!--[-->api/auth/[...]ts<!--]--></code> file and add a <code class=""><!--[-->callback<!--]--></code> within our <code class=""><!--[-->NuxtAuthHandler<!--]--></code>:<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code>// api/auth/[...].ts
export default NuxtAuthHandler({
  ...,
  callbacks: {
    // Adding subscription status to default useAuth data object.
    async session({ session }) {
      if (session.user?.email) {
        const accounts = await getAccountsByEmail(session.user.email)

        return {
          ...session,
          user: {
            ...session.user,
            isSubscribed: accounts[0].is_subscribed,
          },
        }
      }

      return {
        ...session,
        user: {
          ...session.user,
          isSubscribed: undefined,
        },
      }
    },
  },
})

</code><!--]--></pre><!--]--><!--[--><pre class="language-ts" style=""><!--[--><code>if (session.user?.email) {
    const accounts = await getAccountsByEmail(session.user.email)

    return {
      ...session,
      user: {
        ...session.user,
        isSubscribed: accounts[0].is_subscribed,
      },
    }
}
</code><!--]--></pre><!--]--><p><!--[-->This is checking if the user is logged in and if it does, it queries for the user&#39;s Account. Once we have the Account, we return the <code class=""><!--[-->...session<!--]--></code>, which is the default returned object, but we go into it&#39;s nested <code class=""><!--[-->user<!--]--></code> object and extend it with <code class=""><!--[-->isSubscribed: accounts[0].is_subscribed<!--]--></code>.<!--]--></p><p><!--[-->Here I am using a utility query called <code class=""><!--[-->getAccountsByEmail<!--]--></code>. Create a file at <code class=""><!--[-->server/utils/queries/getAccountsByEmail.ts<!--]--></code> and in it, the code:<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code>// server/utils/queries/getAccountsByEmail.ts`
import { PrismaClient } from &#39;@prisma/client&#39;
const prisma = new PrismaClient()

export const getAccountsByEmail = async (email: string) =&gt; {
  return await prisma.account.findMany({
    where: {
      user: {
        email: email,
      },
    },
  })
}
</code><!--]--></pre><!--]--><p><!--[-->It&#39;s a basic Prisma query. But I can see myself using this one often so I decided to extract it into its own function.<!--]--></p><p><!--[-->Now, when we run extract <code class=""><!--[-->data<!--]--></code> from <code class=""><!--[-->useAuth<!--]--></code> and navigate through the <code class=""><!--[-->data<!--]--></code> object to get the <code class=""><!--[-->isSubscribed<!--]--></code> value::<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code>const { data } = useAuth()
data.value?.user?.isSubscribed
</code><!--]--></pre><!--]--><p><!--[-->I use this in our <code class=""><!--[-->PricingSection<!--]--></code> component to adjust the pricing card&#39;s text and functionality.<!--]--></p><!--[--><pre class="language-html" style=""><!--[--><code>// components/PricingSection.vue
&lt;script setup lang=&quot;ts&quot;&gt;
const { status, signIn, data } = useAuth()
const { checkout, navigateToStripeDashboard, tiers } = useStripe()

const handleBuyNow = async () =&gt; {
  if (data.value?.user?.isSubscribed) {
    await navigateToStripeDashboard()
  } else if (status.value === &#39;authenticated&#39;) {
    await checkout()
  } else {
    signIn(&#39;github&#39;)
  }
}

const buttonText = computed(() =&gt; {
  if (data.value?.user?.isSubscribed) {
    return &#39;Manage Subscription&#39;
  } else if (status.value === &#39;authenticated&#39;) {
    return &#39;Buy Now&#39;
  } else {
    return &#39;Sign In to Buy&#39;
  }
})
&lt;/script&gt;

&lt;template&gt;
...
  &lt;button
    @click=&quot;handleBuyNow&quot;
    :aria-describedby=&quot;tier.id&quot;
    :class=&quot;...&quot;
&gt;
    {{ buttonText }}
  &lt;/button&gt;
...
&lt;/template&gt;
</code><!--]--></pre><!--]--><p><!--[-->I cut away the majority of the html and css here, just to showcase the button&#39;s dynamic <code class=""><!--[-->handleBuyNow<!--]--></code> function and computed <code class=""><!--[-->buttonText<!--]--></code>.<!--]--></p><p><!--[-->Now, if the user is subscribed, the button will say &quot;Manage Subscription&quot; and clicking it will navigate the user to the Billing Portal.<!--]--></p><p><!--[-->If the user is logged in but not subscribed, it will say &quot;Buy Now&quot; and navigate the user to the Checkout Portal.<!--]--></p><p><!--[-->If the user is not logged in, it will say &quot;Sign in to Buy&quot; and clicking it will log the user in.<!--]--></p><h3 id="typescript-adjustment"><a href="#typescript-adjustment"><!--[-->Typescript adjustment<!--]--></a></h3><p><!--[-->If you&#39;re using Typescript, you may see a few red lines yelling at you. This is because we are extending the Auth&#39;s User object within the Session Callback, but we are not informing our client side Typescript that this is happening.<!--]--></p><p><!--[-->To clean this up and make Typescript happy, create a file at <code class=""><!--[-->types/next-auth.d.ts<!--]--></code> and add the following code:<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code>// types/next-auth.d.ts
mport NextAuth, { DefaultSession } from &#39;next-auth&#39;

declare module &#39;next-auth&#39; {
  /**
   * Returned by `useSession`, `getSession` and received as a prop on the `SessionProvider`
   */
  interface Session {
    user: {
      /** The user&#39;s Stripe subscription status. */
      isSubscribed: boolean
    } &amp; DefaultSession[&#39;user&#39;]
  }
}
</code><!--]--></pre><!--]--><p><!--[-->This overrides the <code class=""><!--[-->Session<!--]--></code> interface defined by next-auth and extends it with the <code class=""><!--[-->user.isSubscribed<!--]--></code> field.<!--]--></p><h2 id="_10-multiple-plans"><a href="#_10-multiple-plans"><!--[-->10 - Multiple Plans<!--]--></a></h2><p><!--[-->Awhile back I mentioned we would get rid of the hard coded <code class=""><!--[-->PRICE_LOOKUP_KEY<!--]--></code>. The reason we don&#39;t like it is because it&#39;s limiting our checkout to a single subscription plan. Our goal is to support multiple prices and plans, so let&#39;s make the necessary adjustments.<!--]--></p><h3 id="multiple-products"><a href="#multiple-products"><!--[-->Multiple Products<!--]--></a></h3><p><!--[-->Before digging into the code we need to add additional products in our Stripe dashboard.<!--]--></p><p><!--[-->Navigate to Stripe&#39;s <a href="https://dashboard.stripe.com/nuxt-stripe/products?active=true" rel="nofollow"><!--[-->Product catalog<!--]--></a> and add two additional products. Ensure your product&#39;s information matches whatever you have within <code class=""><!--[-->composables/useStripe<!--]--></code>&#39;s tiers object.<!--]--></p><p><!--[-->Here is my <code class=""><!--[-->tiers<!--]--></code> for reference:<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code>// composables/useStripe
const tiers = [
    {
      name: &#39;Freelancer&#39;,
      id: &#39;tier-freelancer&#39;,
      href: &#39;#&#39;,
      priceMonthly: &#39;$24&#39;,
      description: &#39;The essentials to provide your best work for clients.&#39;,
      features: [
        &#39;5 products&#39;,
        &#39;Up to 1,000 subscribers&#39;,
        &#39;Basic analytics&#39;,
        &#39;48-hour support response time&#39;,
      ],
      mostPopular: false,
    },
    {
      name: &#39;Startup&#39;,
      id: &#39;tier-startup&#39;,
      href: &#39;#&#39;,
      priceMonthly: &#39;$32&#39;,
      description: &#39;A plan that scales with your rapidly growing business.&#39;,
      features: [
        &#39;25 products&#39;,
        &#39;Up to 10,000 subscribers&#39;,
        &#39;Advanced analytics&#39;,
        &#39;24-hour support response time&#39;,
        &#39;Marketing automations&#39;,
      ],
      mostPopular: true,
    },
    {
      name: &#39;Enterprise&#39;,
      id: &#39;tier-enterprise&#39;,
      href: &#39;#&#39;,
      priceMonthly: &#39;$48&#39;,
      description: &#39;Dedicated support and infrastructure for your company.&#39;,
      features: [
        &#39;Unlimited products&#39;,
        &#39;Unlimited subscribers&#39;,
        &#39;Advanced analytics&#39;,
        &#39;1-hour, dedicated support response time&#39;,
        &#39;Marketing automations&#39;,
      ],
      mostPopular: false,
    },
  ]
</code><!--]--></pre><!--]--><p><!--[-->Ensure the new products you create have a <code class=""><!--[-->lookup_key<!--]--></code> that matches the <code class=""><!--[-->tier<!--]--></code>  object&#39;s <code class=""><!--[-->id<!--]--></code> field.
In my case, I have <code class=""><!--[-->tier-freelancer<!--]--></code>, <code class=""><!--[-->tier-startup<!--]--></code>, and <code class=""><!--[-->tier-enterprise<!--]--></code>.<!--]--></p><p><!--[-->Also ensure the rest of the data matches what you create in Stripe&#39;s dashboard i.e. Price, name, etc.<!--]--></p><h3 id="code-adjustments"><a href="#code-adjustments"><!--[-->Code Adjustments<!--]--></a></h3><p><!--[-->In our <code class=""><!--[-->useStripe<!--]--></code> composable, adjust <code class=""><!--[-->checkout<!--]--></code> to take a lookup_key parameter:<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code>// composables/useStripe
export function useStripe() {
  const checkout = async (lookupKey: string) =&gt; {
    const res = await $fetch(&#39;/api/stripe/create-checkout-session&#39;, {
      method: &#39;POST&#39;,
      body: {
        lookup_key: lookupKey,
      },
    })

    if (res) {
      await navigateTo(res.url, {
        external: true,
      })
    }
  }
  ...
}
</code><!--]--></pre><!--]--><p><!--[-->Now let&#39;s adjust where we are calling <code class=""><!--[-->checkout<!--]--></code> in our <code class=""><!--[-->PricingSection<!--]--></code> component:<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code>// components/PricingSection
const handleBuyNow = async (lookupKey: string) =&gt; {
  if (data.value?.user?.isSubscribed) {
    await navigateToStripeDashboard()
  } else if (status.value === &#39;authenticated&#39;) {
    await checkout(lookupKey)
  } else {
    signIn(&#39;github&#39;)
  }
}
</code><!--]--></pre><!--]--><p><!--[-->We adjust our <code class=""><!--[-->handleBuyNow<!--]--></code> function to accept a <code class=""><!--[-->lookupUp<!--]--></code> parameter that we then pass into our <code class=""><!--[-->checkout<!--]--></code> function.<!--]--></p><p><!--[-->Then in our template, we can adjust the button that calls the <code class=""><!--[-->handleBuyNow<!--]--></code> function to take in a parameter:<!--]--></p><!--[--><pre class="language-html" style=""><!--[--><code>// components/PricingSection
&lt;template&gt;
...
  &lt;button
    @click=&quot;() =&gt; handleBuyNow(tier.id)&quot;
    :aria-describedby=&quot;tier.id&quot;
    :class=&quot;...&quot;
&gt;
    {{ buttonText }}
  &lt;/button&gt;
...
&lt;/template&gt;
</code><!--]--></pre><!--]--><p><!--[-->We are iterating over each tier earlier in the template code, so we have access to the tier&#39;s id which we can then setup in Stripe&#39;s dashboard as our Product&#39;s lookup keys.<!--]--></p><p><!--[-->With this in place, you should be able to go through the Checkout flow and see that the plan changes based on which tier&#39;s Card you click on. It should match the price, name, and other values you set in Stripe&#39;s Product Catalog when creating the new Product(s).<!--]--></p><h3 id="plans"><a href="#plans"><!--[-->Plans<!--]--></a></h3><p><!--[-->There&#39;s nothing in our Database that saves this information so we are unable to render things based on which plan the user paid for.<!--]--></p><h4 id="account-table"><a href="#account-table"><!--[-->Account Table<!--]--></a></h4><p><!--[-->The solution I take for this problem is to extend my database schema to hold onto this information using a <code class=""><!--[-->plan<!--]--></code> column in my Account schema:<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code>// prisma/schema.prisma
model Account {
  id                String  @id @default(cuid())
  userId            String
  type              String
  provider          String
  providerAccountId String
  refresh_token     String?
  access_token      String?
  expires_at        Int?
  token_type        String?
  scope             String?
  id_token          String?
  session_state     String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  stripe_customer_id String? @unique
  is_subscribed      Boolean @default(false)

  plan               String  @default(&quot;tier-free&quot;)

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)
  @@unique([provider, providerAccountId])
}```

&gt; I set the default value to `tier-free`.

The reason I keep `is_subscribed` as well as `plan` as two separate database columns is because you may want to have logic that recommends users to re-subscribe to their old plan using deals or other methods.

With this updated schema, run our Prisma commands again:

```shell
npx prisma generate
npx prisma migrate dev
</code><!--]--></pre><!--]--><h4 id="auth-endpoint"><a href="#auth-endpoint"><!--[-->Auth Endpoint<!--]--></a></h4><p><!--[-->Now update our Auth endpoint&#39;s session <code class=""><!--[-->callback<!--]--></code> to expand on the returned user object, providing the user Account&#39;s <code class=""><!--[-->plan<!--]--></code>.<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code>// server/api/auth/[...].ts
callbacks: {
    // Adding subscription status to default useAuth data object.
    async session({ session }) {
      if (session.user?.email) {
        const accounts = await getAccountsByEmail(session.user.email)

        return {
          ...session,
          user: {
            ...session.user,
            isSubscribed: accounts[0].is_subscribed,
            plan: accounts[0].plan,
          },
        }
      }
      return {
        ...session,
        user: {
          ...session.user,
          isSubscribed: false,
          plan: &#39;tier-free&#39;,
        },
      }
</code><!--]--></pre><!--]--><h4 id="webhook-updates"><a href="#webhook-updates"><!--[-->Webhook Updates<!--]--></a></h4><p><!--[-->We also have to update our Webhook so that Stripe passes us back the plan information when the subscription is successfully created.<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code>// server/api/stripe/webhook.ts
case &#39;customer.subscription.created&#39;:
  subscription = stripeEvent.data.object
  plan = stripeEvent.data.object.items.data[0].price.lookup_key

  await prisma.account.update({
    where: {
      stripe_customer_id: subscription.customer,
    },
    data: {
      is_subscribed: true,
      plan,
    },
  })
</code><!--]--></pre><!--]--><p><!--[-->Now that there are multiple plans, the user will have the ability to modify their plan in the Billing Portal. They can now go from Plan A → Plan B and visa-versa.<!--]--></p><p><!--[-->In my case, they may start out as a Freelancer, and decide they want additional pro features and sign up for an Enterprise user.<!--]--></p><p><!--[-->Stripe will send a webhook event called <code class=""><!--[-->customer.subscription.updated<!--]--></code> when this occurs. So, let&#39;s listen for it and update our user&#39;s Account accordingly:<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code>// server/api/stripe/webhook.ts
case &#39;customer.subscription.updated&#39;:
  subscription = stripeEvent.data.object
  plan = stripeEvent.data.object.items.data[0].price.lookup_key

  await prisma.account.update({
    where: {
      stripe_customer_id: subscription.customer,
    },
    data: {
      plan,
    },
  })
</code><!--]--></pre><!--]--><p><!--[-->Be sure to update your Webhook in Stripe&#39;s webhook settings so that Stripe sends this additional event.<!--]--></p><p><!--[--><img src="https://cln.sh/7ZBMSsq9+" alt="webhook settings|350"><!--]--></p><h4 id="typescript-session-interface"><a href="#typescript-session-interface"><!--[-->Typescript Session Interface<!--]--></a></h4><p><!--[-->Let&#39;s quickly extend the Session interface so that Typescript doesn&#39;t yell at us when we decide to access this <code class=""><!--[-->plan<!--]--></code> variable on the client.<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code>// types/next-auth.d.ts
import NextAuth, { DefaultSession } from &#39;next-auth&#39;

declare module &#39;next-auth&#39; {
  /**
   * Returned by `useSession`, `getSession` and received as a prop on the `SessionProvider`
   */
  interface Session {
    user: {
      /** The user&#39;s Stripe subscription status. */
      isSubscribed: boolean
      plan: string
    } &amp; DefaultSession[&#39;user&#39;]
  }
}
</code><!--]--></pre><!--]--><h2 id="_11-yearly-plans"><a href="#_11-yearly-plans"><!--[-->11 - Yearly Plans<!--]--></a></h2><blockquote><!--[--><p><!--[-->&quot;Buy 10 months, get two free!&quot;<!--]--></p><!--]--></blockquote><p><!--[-->Site&#39;s love to provide a discount with annual billing. So, let me show you how to incorporate it into your application.<!--]--></p><p><!--[-->I&#39;m sure many of you have seen this toggle:<!--]--></p><p><!--[--><img src="https://cln.sh/mxcRdNZB+" alt="yearly plan toggle!500"><!--]--></p><p><!--[-->Good news is, it&#39;s easy! The majority of the work is frontend-related, with a minor bit of Stripe work within their dashboard.<!--]--></p><h3 id="additional-product-pricing"><a href="#additional-product-pricing"><!--[-->Additional Product Pricing<!--]--></a></h3><p><!--[-->Visit each Product&#39;s details page on Stripe&#39;s Product Catalog page. Right now, we should only have one Price in the Pricing table. Click the <code class=""><!--[-->+<!--]--></code> button and add a new price. This time, make sure the <code class=""><!--[-->Billing period<!--]--></code> is yearly, the price reflects this new period, and add a <code class=""><!--[-->Lookup key<!--]--></code> that&#39;s unique to the yearly price.<!--]--></p><p><!--[--><img src="https://cln.sh/PGN833RN+" alt="Additional Pricing|500"><!--]--></p><h3 id="ui"><a href="#ui"><!--[-->UI<!--]--></a></h3><p><!--[-->We need to create a Toggle component. I&#39;ll call this component <code class=""><!--[-->ToggleWithText<!--]--></code>.<!--]--></p><!--[--><pre class="language-html" style=""><!--[--><code>// components/ToggleWithText.vue
&lt;script setup lang=&quot;ts&quot;&gt;
import { Switch, SwitchGroup, SwitchLabel } from &#39;@headlessui/vue&#39;
const enabled = defineModel&lt;boolean&gt;({ default: false })
&lt;/script&gt;

&lt;template&gt;
  &lt;SwitchGroup as=&quot;div&quot; class=&quot;flex items-center&quot;&gt;
    &lt;Switch
      v-model=&quot;enabled&quot;
      :class=&quot;[
        enabled ? &#39;bg-indigo-600&#39; : &#39;bg-gray-200&#39;,
        &#39;relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-indigo-600 focus:ring-offset-2&#39;,
      ]&quot;
    &gt;
      &lt;span
        aria-hidden=&quot;true&quot;
        :class=&quot;[
          enabled ? &#39;translate-x-5&#39; : &#39;translate-x-0&#39;,
          &#39;pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out&#39;,
        ]&quot;
      /&gt;
    &lt;/Switch&gt;
    &lt;SwitchLabel as=&quot;span&quot; class=&quot;ml-3 text-sm&quot;&gt;
      &lt;span class=&quot;font-medium text-gray-900&quot;&gt;Annual Billing&lt;/span&gt;
    &lt;/SwitchLabel&gt;
  &lt;/SwitchGroup&gt;
&lt;/template&gt;
</code><!--]--></pre><!--]--><p><!--[-->This gives us the ability to pass a <code class=""><!--[-->v-model<!--]--></code> and have a reusable toggle component.<!--]--></p><!--[--><pre class="language-html" style=""><!--[--><code>&lt;ToggleWithText v-model=&quot;yearlyEnabled&quot; /&gt;
</code><!--]--></pre><!--]--><p><!--[-->Now we&#39;re going to use this toggle in our <code class=""><!--[-->PricingSection<!--]--></code> component. Add a new ref:<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code>const yearlyEnabled = ref(false)
</code><!--]--></pre><!--]--><p><!--[-->As well as a new computed property:<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code>const filteredTiers = computed(() =&gt; {
  return tiers.filter(tier =&gt;
    yearlyEnabled.value ? tier.type === &#39;yearly&#39; : tier.type === &#39;monthly&#39;
  )
})
</code><!--]--></pre><!--]--><p><!--[-->Our <code class=""><!--[-->PricingSection<!--]--></code> component&#39;s <code class=""><!--[-->script<!--]--></code> should now look like the following:<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code>// components/PricingSection
&lt;script setup lang=&quot;ts&quot;&gt;
import { CheckIcon } from &#39;@heroicons/vue/20/solid&#39;

const yearlyEnabled = ref(false)
const { status, signIn, data } = useAuth()
const { checkout, navigateToStripeDashboard, tiers } = useStripe()

const handleBuyNow = async (lookupKey: string) =&gt; {
  if (data.value?.user?.isSubscribed) {
    await navigateToStripeDashboard()
  } else if (status.value === &#39;authenticated&#39;) {
    await checkout(lookupKey)
  } else {
    signIn(&#39;github&#39;)
  }
}

const buttonText = computed(() =&gt; {
  if (data.value?.user?.isSubscribed) {
    return &#39;Manage Subscription&#39;
  } else if (status.value === &#39;authenticated&#39;) {
    return &#39;Buy Now&#39;
  } else {
    return &#39;Sign In to Buy&#39;
  }
})

const filteredTiers = computed(() =&gt; {
  return tiers.filter(tier =&gt;
    yearlyEnabled.value ? tier.type === &#39;yearly&#39; : tier.type === &#39;monthly&#39;
  )
})
&lt;/script&gt;
</code><!--]--></pre><!--]--><p><!--[-->Now let&#39;s add the toggle with our new <code class=""><!--[-->yearlyEnabled<!--]--></code> ref to our template. We&#39;ll also iterate over <code class=""><!--[-->filteredTiers<!--]--></code> rather than just <code class=""><!--[-->tiers<!--]--></code>:<!--]--></p><!--[--><pre class="language-html" style=""><!--[--><code>// components/PricingSection

&lt;template&gt;
  &lt;div class=&quot;bg-white py-10&quot;&gt;
    &lt;div class=&quot;mx-auto max-w-7xl px-6 lg:px-8&quot;&gt;
      &lt;div class=&quot;mx-auto max-w-4xl text-center&quot;&gt;
        &lt;h2 class=&quot;text-base font-semibold leading-7 text-indigo-600&quot;&gt;
          Pricing
        &lt;/h2&gt;
        &lt;p
          class=&quot;mt-2 text-4xl font-bold tracking-tight text-gray-900 sm:text-5xl&quot;
        &gt;
          Pricing plans for teams of&amp;nbsp;all&amp;nbsp;sizes
        &lt;/p&gt;
      &lt;/div&gt;
      &lt;p
        class=&quot;mx-auto mt-6 max-w-2xl text-center text-lg leading-8 text-gray-600&quot;
      &gt;
        Distinctio et nulla eum soluta et neque labore quibusdam. Saepe et quasi
        iusto modi velit ut non voluptas in. Explicabo id ut laborum.
      &lt;/p&gt;

      &lt;div class=&quot;flex items-center justify-center mt-10 -mb-14&quot;&gt;
        &lt;ToggleWithText v-model=&quot;yearlyEnabled&quot; /&gt;
      &lt;/div&gt;

      &lt;div
        class=&quot;isolate mx-auto mt-16 grid max-w-md grid-cols-1 gap-y-8 sm:mt-20 lg:mx-0 lg:max-w-none lg:grid-cols-3&quot;
      &gt;
        &lt;div
          v-for=&quot;(tier, tierIdx) in filteredTiers&quot;
          :key=&quot;tier.id&quot;
          :class=&quot;[
            tier.mostPopular ? &#39;lg:z-10 lg:rounded-b-none&#39; : &#39;lg:mt-8&#39;,
            tierIdx === 0 ? &#39;lg:rounded-r-none&#39; : &#39;&#39;,
            tierIdx === tiers.length - 1 ? &#39;lg:rounded-l-none&#39; : &#39;&#39;,
            &#39;flex flex-col justify-between rounded-3xl bg-white p-8 ring-1 ring-gray-200 xl:p-10&#39;,
          ]&quot;
        &gt;
          &lt;div&gt;
            &lt;div class=&quot;flex items-center justify-between gap-x-4&quot;&gt;
              &lt;h3
                :id=&quot;tier.id&quot;
                :class=&quot;[
                  tier.mostPopular ? &#39;text-indigo-600&#39; : &#39;text-gray-900&#39;,
                  &#39;text-lg font-semibold leading-8&#39;,
                ]&quot;
              &gt;
                {{ tier.name }}
              &lt;/h3&gt;
              &lt;p
                v-if=&quot;tier.mostPopular&quot;
                class=&quot;rounded-full bg-indigo-600/10 px-2.5 py-1 text-xs font-semibold leading-5 text-indigo-600&quot;
              &gt;
                Most popular
              &lt;/p&gt;
            &lt;/div&gt;
            &lt;p class=&quot;mt-4 text-sm leading-6 text-gray-600&quot;&gt;
              {{ tier.description }}
            &lt;/p&gt;
            &lt;p class=&quot;mt-6 flex items-baseline gap-x-1&quot;&gt;
              &lt;span class=&quot;text-4xl font-bold tracking-tight text-gray-900&quot;&gt;
                {{ tier.price }}
              &lt;/span&gt;
              &lt;span class=&quot;text-sm font-semibold leading-6 text-gray-600&quot;&gt;
                {{ yearlyEnabled ? &#39;/year&#39; : &#39;/month&#39; }}
              &lt;/span&gt;
            &lt;/p&gt;
            &lt;ul
              role=&quot;list&quot;
              class=&quot;mt-8 space-y-3 text-sm leading-6 text-gray-600&quot;
            &gt;
              &lt;li
                v-for=&quot;feature in tier.features&quot;
                :key=&quot;feature&quot;
                class=&quot;flex gap-x-3&quot;
              &gt;
                &lt;CheckIcon
                  class=&quot;h-6 w-5 flex-none text-indigo-600&quot;
                  aria-hidden=&quot;true&quot;
                /&gt;
                {{ feature }}
              &lt;/li&gt;
            &lt;/ul&gt;
          &lt;/div&gt;
          &lt;button
            @click=&quot;() =&gt; handleBuyNow(tier.id)&quot;
            :aria-describedby=&quot;tier.id&quot;
            :class=&quot;[
              tier.mostPopular
                ? &#39;bg-indigo-600 text-white shadow-sm hover:bg-indigo-500&#39;
                : &#39;text-indigo-600 ring-1 ring-inset ring-indigo-200 hover:ring-indigo-300&#39;,
              &#39;mt-8 block rounded-md px-3 py-2 text-center text-sm font-semibold leading-6 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600&#39;,
            ]&quot;
          &gt;
            {{ buttonText }}
          &lt;/button&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/template&gt;
</code><!--]--></pre><!--]--><p><!--[-->Now, we need to update our tiers to include the yearly amounts.<!--]--></p><p><!--[-->Here&#39;s an example of one of the yearly tiers:<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code>{
  name: &#39;Freelancer&#39;,
  id: &#39;tier-freelancer-yearly&#39;,
  href: &#39;#&#39;,
  price: &#39;$240&#39;,
  description: &#39;The essentials to provide your best work for clients.&#39;,
  features: [
    &#39;5 products&#39;,
    &#39;Up to 1,000 subscribers&#39;,
    &#39;Basic analytics&#39;,
    &#39;48-hour support response time&#39;,
  ],
  mostPopular: false,
  type: &#39;yearly&#39;,
},
</code><!--]--></pre><!--]--><p><!--[-->The only difference between this tier and the monthly version is the <code class=""><!--[-->id<!--]--></code> and <code class=""><!--[-->type<!--]--></code> field. But, this is up to you. You can adjust this object however you like. The key is <code class=""><!--[-->type: &#39;yearly&#39;<!--]--></code> - this is how we will filter the tier.<!--]--></p><p><!--[-->Here&#39;s my entire <code class=""><!--[-->tiers<!--]--></code> value when updated with the yearly objects:<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code>const tiers = [
    {
      name: &#39;Freelancer&#39;,
      id: &#39;tier-freelancer&#39;,
      href: &#39;#&#39;,
      price: &#39;$24&#39;,
      description: &#39;The essentials to provide your best work for clients.&#39;,
      features: [
        &#39;5 products&#39;,
        &#39;Up to 1,000 subscribers&#39;,
        &#39;Basic analytics&#39;,
        &#39;48-hour support response time&#39;,
      ],
      mostPopular: false,
      type: &#39;monthly&#39;,
    },
    {
      name: &#39;Startup&#39;,
      id: &#39;tier-startup&#39;,
      href: &#39;#&#39;,
      price: &#39;$32&#39;,
      description: &#39;A plan that scales with your rapidly growing business.&#39;,
      features: [
        &#39;25 products&#39;,
        &#39;Up to 10,000 subscribers&#39;,
        &#39;Advanced analytics&#39;,
        &#39;24-hour support response time&#39;,
        &#39;Marketing automations&#39;,
      ],
      mostPopular: true,
      type: &#39;monthly&#39;,
    },
    {
      name: &#39;Enterprise&#39;,
      id: &#39;tier-enterprise&#39;,
      href: &#39;#&#39;,
      price: &#39;$48&#39;,
      description: &#39;Dedicated support and infrastructure for your company.&#39;,
      features: [
        &#39;Unlimited products&#39;,
        &#39;Unlimited subscribers&#39;,
        &#39;Advanced analytics&#39;,
        &#39;1-hour, dedicated support response time&#39;,
        &#39;Marketing automations&#39;,
      ],
      mostPopular: false,
      type: &#39;monthly&#39;,
    },

    {
      name: &#39;Freelancer&#39;,
      id: &#39;tier-freelancer-yearly&#39;,
      href: &#39;#&#39;,
      price: &#39;$240&#39;,
      description: &#39;The essentials to provide your best work for clients.&#39;,
      features: [
        &#39;5 products&#39;,
        &#39;Up to 1,000 subscribers&#39;,
        &#39;Basic analytics&#39;,
        &#39;48-hour support response time&#39;,
      ],
      mostPopular: false,
      type: &#39;yearly&#39;,
    },
    {
      name: &#39;Startup&#39;,
      id: &#39;tier-startup-yearly&#39;,
      href: &#39;#&#39;,
      price: &#39;$320&#39;,
      description: &#39;A plan that scales with your rapidly growing business.&#39;,
      features: [
        &#39;25 products&#39;,
        &#39;Up to 10,000 subscribers&#39;,
        &#39;Advanced analytics&#39;,
        &#39;24-hour support response time&#39;,
        &#39;Marketing automations&#39;,
      ],
      mostPopular: true,
      type: &#39;yearly&#39;,
    },
    {
      name: &#39;Enterprise&#39;,
      id: &#39;tier-enterprise-yearly&#39;,
      href: &#39;#&#39;,
      price: &#39;$480&#39;,
      description: &#39;Dedicated support and infrastructure for your company.&#39;,
      features: [
        &#39;Unlimited products&#39;,
        &#39;Unlimited subscribers&#39;,
        &#39;Advanced analytics&#39;,
        &#39;1-hour, dedicated support response time&#39;,
        &#39;Marketing automations&#39;,
      ],
      mostPopular: false,
      type: &#39;yearly&#39;,
    },
]
</code><!--]--></pre><!--]--><p><!--[-->With these changes in place, you should now see the <code class=""><!--[-->plan<!--]--></code> value reflected in your database.<!--]--></p><h2 id="_12-permissions"><a href="#_12-permissions"><!--[-->12 - Permissions<!--]--></a></h2><p><!--[-->I want to show you how we can easily adjust permissions on our site with our <code class=""><!--[-->plan<!--]--></code> value.<!--]--></p><p><!--[-->Our user&#39;s <code class=""><!--[-->plan<!--]--></code> value is being passed to the client in the <code class=""><!--[-->data<!--]--></code> variable extracted from <code class=""><!--[-->useAuth<!--]--></code>:<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code>const { data } = useAuth()
// data.user.plan
</code><!--]--></pre><!--]--><p><!--[-->Let&#39;s play with it in our <code class=""><!--[-->AuthMenu<!--]--></code> component:<!--]--></p><!--[--><pre class="language-html" style=""><!--[--><code>// components/AuthMenu.vue
&lt;script setup lang=&quot;ts&quot;&gt;
import { Popover, PopoverButton, PopoverPanel } from &#39;@headlessui/vue&#39;
const { data, signOut } = useAuth()
const { navigateToStripeDashboard } = useStripe()
const solutions = [
  { name: &#39;Manage Billing&#39;, fn: navigateToStripeDashboard },
  { name: &#39;Sign Out&#39;, fn: signOut },
]
&lt;/script&gt;
&lt;template&gt;
    ...
      &lt;AuthAvatar :src=&quot;data?.user?.image&quot; :plan=&quot;data?.user?.plan&quot; /&gt;
    ...
&lt;/template&gt;
</code><!--]--></pre><!--]--><p><!--[-->Pass our <code class=""><!--[-->AuthAvatar<!--]--></code> component a new prop: <code class=""><!--[-->:plan=&quot;data?.user?.plan&quot;<!--]--></code><!--]--></p><p><!--[-->And update the <code class=""><!--[-->Prop<!--]--></code> interface in our <code class=""><!--[-->AuthAvatar<!--]--></code> component:<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code>interface Props {
  src: string | null | undefined
  plan: string | null | undefined
}
</code><!--]--></pre><!--]--><p><!--[-->Then add this dynamic class to your Avatar&#39;s img element.<!--]--></p><!--[--><pre class="language-ts" style=""><!--[--><code>:class=&quot;{
  &#39;border-indigo-500&#39;: plan?.includes(&#39;tier-freelance&#39;),
  &#39;border-red-500&#39;: plan?.includes(&#39;tier-startup&#39;),
  &#39;border-green-500&#39;: plan?.includes(&#39;tier-enterprise&#39;),
}&quot;
</code><!--]--></pre><!--]--><p><!--[-->So now the Avatar image should have a colorful border depending on which tier you&#39;re in.<!--]--></p><p><!--[-->Final <code class=""><!--[-->AuthAvatar<!--]--></code> code:<!--]--></p><!--[--><pre class="language-html" style=""><!--[--><code>&lt;script lang=&quot;ts&quot; setup&gt;
interface Props {
  src: string | null | undefined
  plan: string | null | undefined
}
defineProps&lt;Props&gt;()
&lt;/script&gt;
&lt;template&gt;
  &lt;img
    v-if=&quot;src&quot;
    class=&quot;inline-block h-10 w-10 rounded-full bg-gray-500 border-2&quot;
    :class=&quot;{
      &#39;border-indigo-500&#39;: plan?.includes(&#39;tier-freelance&#39;),
      &#39;border-red-500&#39;: plan?.includes(&#39;tier-startup&#39;),
      &#39;border-green-500&#39;: plan?.includes(&#39;tier-enterprise&#39;),
    }&quot;
    :src=&quot;src&quot;
    alt=&quot;User avatar&quot;
  /&gt;
  &lt;span
    v-else
    class=&quot;inline-block h-10 w-10 overflow-hidden rounded-full bg-gray-100&quot;
  &gt;
    &lt;svg
      class=&quot;h-full w-full text-gray-300&quot;
      fill=&quot;currentColor&quot;
      viewBox=&quot;0 0 24 24&quot;
    &gt;
      &lt;path
        d=&quot;M24 20.993V24H0v-2.996A14.977 14.977 0 0112.004 15c4.904 0 9.26 2.354 11.996 5.993zM16.002 8.999a4 4 0 11-8 0 4 4 0 018 0z&quot;
      /&gt;
    &lt;/svg&gt;
  &lt;/span&gt;
&lt;/template&gt;
</code><!--]--></pre><!--]--><p><!--[-->This is a very simple example, but it showcases how easy it is to now dynamically show content based on the user&#39;s subscription tier.<!--]--></p><h2 id="_13-deploy"><a href="#_13-deploy"><!--[-->13 - Deploy<!--]--></a></h2><blockquote><!--[--><p><!--[-->Coming soon...<!--]--></p><!--]--></blockquote><h2 id="conclusion"><a href="#conclusion"><!--[-->Conclusion<!--]--></a></h2><blockquote><!--[--><p><!--[-->And that&#39;s it!<!--]--></p><!--]--></blockquote><p><!--[-->I hope this was able to help you along your journey to integrating payments into your Nuxt application. This article has been a long time coming.<!--]--></p><p><!--[-->Let me know if you have any questions, comments, or concerns. If you run into errors in the code, please let me know and I&#39;ll update the examples to help future readers.<!--]--></p></div></article><!--]--><div class="rounded-lg bg-card text-card-foreground shadow-sm mt-10 lg:w-2/3" data-v-fcddb7e2><!--[--><div class="flex flex-col gap-y-1.5 p-6"><!--[--><h3 class="text-2xl font-semibold leading-none tracking-tight"><!--[-->Newsletter<!--]--></h3><p class="text-sm text-muted-foreground"><!--[-->Subscribe to get my latest content. No spam.<!--]--></p><!--]--></div><div class="p-6 pt-0"><!--[--><form><div class="flex flex-col gap-2"><div class="flex space-x-1.5"><input class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50" name="emailInput" type="email" placeholder="Enter your email" value><button class="inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&amp;_svg]:pointer-events-none [&amp;_svg]:size-4 [&amp;_svg]:shrink-0 bg-primary text-primary-foreground shadow hover:bg-primary/90 h-9 px-4 py-2 self-end" type="submit"><!--[-->Submit<!--]--></button></div></div></form><!--]--></div><!--]--></div><section class="mt-10" data-v-fcddb7e2></section><div data-orientation="horizontal" role="separator" class="shrink-0 bg-border relative h-px w-full my-20" data-v-fcddb7e2><!--[--><!--]--></div><div data-v-fcddb7e2><h2 class="mb-6" data-v-fcddb7e2>You might also enjoy</h2><ul data-v-fcddb7e2><!--[--><li class="flex items-baseline leading-tight mb-1"><div class="flex-shrink-0 text-gray-600 text-md pr-6 font-mono">2023 · 02</div><a href="/lets-setup-nuxt-3-with-cypress" class="opacity-90 hover:opacity-50 hover:underline text-lg truncate">Lets setup Nuxt 3 with Cypress</a></li><li class="flex items-baseline leading-tight mb-1"><div class="flex-shrink-0 text-gray-600 text-md pr-6 font-mono">2022 · 05</div><a href="/how-to-use-vuetify-with-nuxt-3" class="opacity-90 hover:opacity-50 hover:underline text-lg truncate">How to use Vuetify with Nuxt 3</a></li><li class="flex items-baseline leading-tight mb-1"><div class="flex-shrink-0 text-gray-600 text-md pr-6 font-mono">2022 · 02</div><a href="/using-url-query-params-in-nuxt-3" class="opacity-90 hover:opacity-50 hover:underline text-lg truncate">Using URL Query Params in Nuxt 3</a></li><li class="flex items-baseline leading-tight mb-1"><div class="flex-shrink-0 text-gray-600 text-md pr-6 font-mono">2022 · 02</div><a href="/silently-update-url-nuxt-3" class="opacity-90 hover:opacity-50 hover:underline text-lg truncate">Silently Update URL in Nuxt 3</a></li><li class="flex items-baseline leading-tight mb-1"><div class="flex-shrink-0 text-gray-600 text-md pr-6 font-mono">2023 · 01</div><a href="/getting-youtube-channel-id-using-their-api" class="opacity-90 hover:opacity-50 hover:underline text-lg truncate">Getting Youtube Channel ID Using Their API</a></li><!--]--></ul></div></main></div><!--]--></div></div></div><div id="teleports"></div>
<script type="application/json" data-nuxt-data="nuxt-app" data-ssr="true" id="__NUXT_DATA__" data-src="/stripe-integration-in-nuxt-3/_payload.json?20f3f421-5963-409a-8a11-55701206fbd4">[{"state":1,"once":13,"_errors":14,"serverRendered":6,"path":17,"prerenderedAt":18},["Reactive",2],{"$snuxt-i18n-meta":3,"$scolor-mode":4,"$ssite-config":8},{},{"preference":5,"value":5,"unknown":6,"forced":7},"system",true,false,{"currentLocale":9,"defaultLocale":9,"env":10,"name":11,"url":12},"eng_Latn","production","Cody Bontecou","https://codybontecou.com",["Set"],["ShallowReactive",15],{"post-/stripe-integration-in-nuxt-3":16,"allArticles":16,"content-query-y3YS6eYMVA":16},null,"/stripe-integration-in-nuxt-3",1733866075805]</script>
<script>window.__NUXT__={};window.__NUXT__.config={public:{mdc:{components:{prose:true,map:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote","code-inline":"prose-code-inline",code:"ProseCodeInline",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"}},headings:{anchorLinks:{h1:true,h2:true,h3:true,h4:true,h5:true,h6:true}}},content:{locales:[],defaultLocale:"",integrity:1733866043570,experimental:{stripQueryParameters:false,advanceQuery:false,clientDB:false},respectPathCase:false,api:{baseURL:"/api/_content"},navigation:{fields:[]},tags:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote","code-inline":"prose-code-inline",code:"ProseCodeInline",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"},highlight:false,wsUrl:"",documentDriven:false,host:"",trailingSlash:false,search:"",contentHead:true,anchorLinks:true},i18n:{baseUrl:"",defaultLocale:"eng_Latn",defaultDirection:"ltr",strategy:"no_prefix",lazy:false,rootRedirect:"",routesNameSeparator:"___",defaultLocaleRouteNameSuffix:"default",skipSettingLocaleOnNavigate:false,differentDomains:false,trailingSlash:false,configLocales:[{code:"eng_Latn",title:"English"}],locales:{eng_Latn:{domain:""}},detectBrowserLanguage:{alwaysRedirect:false,cookieCrossOrigin:false,cookieDomain:"",cookieKey:"nuxt_i18n",cookieSecure:false,fallbackLocale:"",redirectOn:"root",useCookie:true},experimental:{localeDetector:"",switchLocalePathLinkSSR:false,autoImportTranslationFunctions:false},multiDomainLocales:false},gtag:{enabled:true,initMode:"auto",id:"G-3NM0E524EK",initCommands:[],config:{},tags:[],loadingStrategy:"defer",url:"https://www.googletagmanager.com/gtag/js"},studio:{apiURL:"https://api.nuxt.studio",iframeMessagingAllowedOrigins:""}},app:{baseURL:"/",buildId:"20f3f421-5963-409a-8a11-55701206fbd4",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script></body></html>