[{"data":1,"prerenderedAt":1406},["ShallowReactive",2],{"post-/topics/Testing":3},[4,289,776,976],{"_path":5,"_dir":6,"_draft":7,"_partial":7,"_locale":6,"title":8,"description":9,"type":10,"author":11,"date":14,"last_modified_date":14,"slug":15,"dropdown":16,"meta":17,"canonicalUrl":31,"topics":32,"created_at":36,"last_modified":37,"body":38,"_type":284,"_id":285,"_source":286,"_file":287,"_stem":15,"_extension":288},"/mocking-http-responses-in-elixir-and-phoenix","",false,"Mocking HTTP Responses in Elixir and Phoenix","A quick walkthrough of the configuration needed to support mocks and modules only used within your Elixir tests","post",{"name":12,"image":13},"Cody Bontecou","/assets/img/cody.64b57256.jpg","2023-08-13T00:00:00.000Z","mocking-http-responses-in-elixir-and-phoenix","Elixir",[18,20,23,25,27,29],{"name":19,"content":9},"og:description",{"name":21,"content":22},"og:image","https://codybontecou.com/images/mocking-http-responses-in-elixir-and-phoenix.png",{"name":24,"content":9},"og:image:alt",{"name":26,"content":8},"og:title",{"name":28,"content":8},"twitter:title",{"name":30,"content":8},"twitter:text:title","https://codybontecou.com/mocking-http-responses-in-elixir-and-phoenix.html",[33,34,35],"elixir","testing","mocking","2024-10-31T14:26","2024-11-09T21:19",{"type":39,"children":40,"toc":278},"root",[41,49,59,66,71,82,87,96,116,122,143,167,194,203,208,259,265],{"type":42,"tag":43,"props":44,"children":45},"element","p",{},[46],{"type":47,"value":48},"text","I just came across this error while attempting to mock the response of a 3rd party api:",{"type":42,"tag":43,"props":50,"children":51},{},[52],{"type":42,"tag":53,"props":54,"children":56},"code",{"className":55},[],[57],{"type":47,"value":58},"** (UndefinedFunctionError) function LeagueInfoMocks.get_live/0 is undefined (module LeagueInfoMocks is not available)",{"type":42,"tag":60,"props":61,"children":63},"h2",{"id":62},"the-problem",[64],{"type":47,"value":65},"The Problem",{"type":42,"tag":43,"props":67,"children":68},{},[69],{"type":47,"value":70},"I couldn't wrap my head around it. I have this simple mock module defined:",{"type":42,"tag":72,"props":73,"children":77},"pre",{"className":74,"code":76,"language":33,"meta":6},[75],"language-elixir","defmodule LeagueInfoMocks do\n  def get_live do\n    %{...}\n  end\nend\n\n",[78],{"type":42,"tag":53,"props":79,"children":80},{"__ignoreMap":6},[81],{"type":47,"value":76},{"type":42,"tag":43,"props":83,"children":84},{},[85],{"type":47,"value":86},"And a test module to interact with the get_live function:",{"type":42,"tag":72,"props":88,"children":91},{"className":89,"code":90,"language":33,"meta":6},[75],"defmodule LeagueInfoTest do\n  use ExUnit.Case\n  test \"format_info\" do\n    data = LeagueInfoMocks.get_live()\n\n    [match | _tail] = data\n\n    assert LeagueInfo.format_info(data) == %{...}\n  end\nend\n\n",[92],{"type":42,"tag":53,"props":93,"children":94},{"__ignoreMap":6},[95],{"type":47,"value":90},{"type":42,"tag":43,"props":97,"children":98},{},[99,101,107,109,114],{"type":47,"value":100},"But running ",{"type":42,"tag":53,"props":102,"children":104},{"className":103},[],[105],{"type":47,"value":106},"mix test",{"type":47,"value":108}," would consistently give me the ",{"type":42,"tag":53,"props":110,"children":112},{"className":111},[],[113],{"type":47,"value":58},{"type":47,"value":115},".",{"type":42,"tag":60,"props":117,"children":119},{"id":118},"the-solution",[120],{"type":47,"value":121},"The Solution",{"type":42,"tag":43,"props":123,"children":124},{},[125,127,133,135,141],{"type":47,"value":126},"Most articles and threads mentioned moving the ",{"type":42,"tag":53,"props":128,"children":130},{"className":129},[],[131],{"type":47,"value":132},"LeagueInfoMocks",{"type":47,"value":134}," module in the ",{"type":42,"tag":53,"props":136,"children":138},{"className":137},[],[139],{"type":47,"value":140},"test/support/*",{"type":47,"value":142}," directory, so I did. This didn't change the error message.",{"type":42,"tag":43,"props":144,"children":145},{},[146,148,157,159,165],{"type":47,"value":147},"I eventually found ",{"type":42,"tag":149,"props":150,"children":154},"a",{"href":151,"rel":152},"https://stackoverflow.com/a/73967553/6642089",[153],"nofollow",[155],{"type":47,"value":156},"this",{"type":47,"value":158}," Stackoverflow comment that mentioned some configuration needed in the ",{"type":42,"tag":53,"props":160,"children":162},{"className":161},[],[163],{"type":47,"value":164},"mix.exs",{"type":47,"value":166}," file.",{"type":42,"tag":43,"props":168,"children":169},{},[170,172,178,180,185,187,192],{"type":47,"value":171},"Supposedly, ",{"type":42,"tag":53,"props":173,"children":175},{"className":174},[],[176],{"type":47,"value":177},"mix phx.new",{"type":47,"value":179}," adds the ",{"type":42,"tag":53,"props":181,"children":183},{"className":182},[],[184],{"type":47,"value":140},{"type":47,"value":186}," support when a Phoenix project is created. In my case, I'm building off of a simple Elixir application. This required me to configure my ",{"type":42,"tag":53,"props":188,"children":190},{"className":189},[],[191],{"type":47,"value":164},{"type":47,"value":193}," file to look like so:",{"type":42,"tag":72,"props":195,"children":198},{"className":196,"code":197,"language":33,"meta":6},[75],"defmodule LolesportsConsumer.MixProject do\n  use Mix.Project\n\n  def project do\n    [\n      app: :lolesports_consumer,\n      version: \"0.1.0\",\n      elixir: \"~> 1.15\",\n      start_permanent: Mix.env() == :prod,\n      deps: deps(),\n      elixirc_paths: elixirc_paths(Mix.env())\n    ]\n  end\n\n  # Run \"mix help compile.app\" to learn about applications.\n  def application do\n    [\n      extra_applications: [:logger]\n    ]\n  end\n\n  # Run \"mix help deps\" to learn about dependencies.\n  defp deps do\n    [\n      {:httpoison, \"~> 2.1\"},\n      {:jason, \"~> 1.4\"}\n    ]\n  end\n\n  defp elixirc_paths(:test), do: [\"lib\", \"test/support\"]\n  defp elixirc_paths(_), do: [\"lib\"]\nend\n\n",[199],{"type":42,"tag":53,"props":200,"children":201},{"__ignoreMap":6},[202],{"type":47,"value":197},{"type":42,"tag":43,"props":204,"children":205},{},[206],{"type":47,"value":207},"The key differences were:",{"type":42,"tag":209,"props":210,"children":211},"ol",{},[212,232],{"type":42,"tag":213,"props":214,"children":215},"li",{},[216,218,224,226],{"type":47,"value":217},"Adding ",{"type":42,"tag":53,"props":219,"children":221},{"className":220},[],[222],{"type":47,"value":223},"elixirc_paths: elixirc_paths(Mix.env())",{"type":47,"value":225}," to ",{"type":42,"tag":53,"props":227,"children":229},{"className":228},[],[230],{"type":47,"value":231},"project",{"type":42,"tag":213,"props":233,"children":234},{},[235,237],{"type":47,"value":236},"Adding these two lines to the file:\n",{"type":42,"tag":238,"props":239,"children":240},"ul",{},[241,250],{"type":42,"tag":213,"props":242,"children":243},{},[244],{"type":42,"tag":53,"props":245,"children":247},{"className":246},[],[248],{"type":47,"value":249},"defp elixirc_paths(:test), do: [\"lib\", \"test/support\"]",{"type":42,"tag":213,"props":251,"children":252},{},[253],{"type":42,"tag":53,"props":254,"children":256},{"className":255},[],[257],{"type":47,"value":258},"defp elixirc_paths(_), do: [\"lib\"]",{"type":42,"tag":60,"props":260,"children":262},{"id":261},"conclusion",[263],{"type":47,"value":264},"Conclusion",{"type":42,"tag":43,"props":266,"children":267},{},[268,270,276],{"type":47,"value":269},"With these configuration changes, I am able to properly call ",{"type":42,"tag":53,"props":271,"children":273},{"className":272},[],[274],{"type":47,"value":275},"LeagueInfoMocks.get_live()",{"type":47,"value":277}," and write tests against an expected HTTP response.",{"title":6,"searchDepth":279,"depth":279,"links":280},2,[281,282,283],{"id":62,"depth":279,"text":65},{"id":118,"depth":279,"text":121},{"id":261,"depth":279,"text":264},"markdown","content:mocking-http-responses-in-elixir-and-phoenix.md","content","mocking-http-responses-in-elixir-and-phoenix.md","md",{"_path":290,"_dir":6,"_draft":7,"_partial":7,"_locale":6,"title":291,"description":292,"type":10,"author":293,"date":295,"last_modified_date":295,"slug":296,"dropdown":297,"meta":298,"canonicalUrl":306,"topics":307,"created_at":36,"last_modified":37,"body":310,"_type":284,"_id":774,"_source":286,"_file":775,"_stem":296,"_extension":288},"/cypress-component-testing-with-nuxt-3","Cypress Component Testing with Nuxt 3","Showing the setup needed to get Cypress Component Testing working alongside Nuxt 3",{"name":12,"image":294},"https://codybontecou.com/images/cody-abstract.jpeg","2023-03-20T00:00:00.000Z","cypress-component-testing-with-nuxt-3","Cypress",[299,300,302,303,304,305],{"name":19,"content":292},{"name":21,"content":301},"https://codybontecou.com/images/cypress-component-testing-with-nuxt-3.png",{"name":24,"content":292},{"name":26,"content":291},{"name":28,"content":291},{"name":30,"content":291},"https://codybontecou.com/cypress-component-testing-with-nuxt-3.html",[308,309,297],"Testing","Nuxt",{"type":39,"children":311,"toc":763},[312,321,327,338,344,353,359,372,383,388,401,410,423,432,437,459,466,474,479,487,509,520,533,546,555,561,574,579,592,603,616,625,638,647,653,667,672,692,705,714,725,734,739,744,750],{"type":42,"tag":313,"props":314,"children":315},"blockquote",{},[316],{"type":42,"tag":43,"props":317,"children":318},{},[319],{"type":47,"value":320},"This is a guide on setting up Cypress Component Testing with Nuxt 3.",{"type":42,"tag":60,"props":322,"children":324},{"id":323},"initialize-nuxt-project",[325],{"type":47,"value":326},"Initialize Nuxt project",{"type":42,"tag":72,"props":328,"children":333},{"code":329,"language":330,"meta":6,"className":331},"npx nuxi init nuxt-project\ncd nuxt-project\nnpm install\n","shell",[332],"language-shell",[334],{"type":42,"tag":53,"props":335,"children":336},{"__ignoreMap":6},[337],{"type":47,"value":329},{"type":42,"tag":60,"props":339,"children":341},{"id":340},"install-initialize-cypress",[342],{"type":47,"value":343},"Install + initialize Cypress",{"type":42,"tag":72,"props":345,"children":348},{"code":346,"language":330,"meta":6,"className":347},"npm install cypress typescript --save-dev\nnpx cypress open\n",[332],[349],{"type":42,"tag":53,"props":350,"children":351},{"__ignoreMap":6},[352],{"type":47,"value":346},{"type":42,"tag":60,"props":354,"children":356},{"id":355},"configure-cypress",[357],{"type":47,"value":358},"Configure Cypress",{"type":42,"tag":43,"props":360,"children":361},{},[362,364,370],{"type":47,"value":363},"Create a ",{"type":42,"tag":53,"props":365,"children":367},{"className":366},[],[368],{"type":47,"value":369},"cypress.config.ts",{"type":47,"value":371}," file in your root directory and add the following:",{"type":42,"tag":72,"props":373,"children":378},{"code":374,"language":375,"meta":6,"className":376},"// cypress.config.ts\nimport { defineConfig } from 'cypress'\n\nmodule.exports = defineConfig({\n  component: {\n    devServer: {\n      framework: 'vue',\n      bundler: 'vite',\n    },\n  },\n})\n","ts",[377],"language-ts",[379],{"type":42,"tag":53,"props":380,"children":381},{"__ignoreMap":6},[382],{"type":47,"value":374},{"type":42,"tag":43,"props":384,"children":385},{},[386],{"type":47,"value":387},"This is the baseline configuration that works for Vue projects. Nuxt projects require more configuration to get going.",{"type":42,"tag":43,"props":389,"children":390},{},[391,393,399],{"type":47,"value":392},"In your root directory, create an additional configuration file. I use ",{"type":42,"tag":53,"props":394,"children":396},{"className":395},[],[397],{"type":47,"value":398},"vite.config.cypress.component.ts",{"type":47,"value":400},". In it, paste the following:",{"type":42,"tag":72,"props":402,"children":405},{"code":403,"language":375,"meta":6,"className":404},"// `vite.config.cypress.component.ts`\nimport vue from '@vitejs/plugin-vue'\n\nexport default {\n  plugins: [\n    vue({\n      template: {\n        compilerOptions: {\n          isCustomElement: tag => tag.includes('-'),\n        },\n      },\n    }),\n  ],\n}\n",[377],[406],{"type":42,"tag":53,"props":407,"children":408},{"__ignoreMap":6},[409],{"type":47,"value":403},{"type":42,"tag":43,"props":411,"children":412},{},[413,415,421],{"type":47,"value":414},"Now, add this config to your ",{"type":42,"tag":53,"props":416,"children":418},{"className":417},[],[419],{"type":47,"value":420},"cypres.config.ts",{"type":47,"value":422}," file so that it looks like so:",{"type":42,"tag":72,"props":424,"children":427},{"code":425,"language":375,"meta":6,"className":426},"// cypress.config.ts\nimport { defineConfig } from 'cypress'\nimport viteConfig from '~/vite.config.cypress.component.js'\n\nmodule.exports = defineConfig({\n  component: {\n    devServer: {\n      framework: 'vue',\n      bundler: 'vite',\n      viteConfig,\n    },\n  },\n})\n",[377],[428],{"type":42,"tag":53,"props":429,"children":430},{"__ignoreMap":6},[431],{"type":47,"value":425},{"type":42,"tag":43,"props":433,"children":434},{},[435],{"type":47,"value":436},"Unfortunately, I don't know exactly what this configuration is doing behind the scenes. I just know it works.",{"type":42,"tag":43,"props":438,"children":439},{},[440,442,449,451,458],{"type":47,"value":441},"I found this code snippet in ",{"type":42,"tag":149,"props":443,"children":446},{"href":444,"rel":445},"https://github.com/cypress-io/cypress/discussions/21184#discussioncomment-4971326",[153],[447],{"type":47,"value":448},"this Github thread",{"type":47,"value":450}," by ",{"type":42,"tag":149,"props":452,"children":455},{"href":453,"rel":454},"https://github.com/elwinvaneede",[153],[456],{"type":47,"value":457},"@elwinvaneede",{"type":47,"value":115},{"type":42,"tag":460,"props":461,"children":463},"h3",{"id":462},"additional-cypress-component-config",[464],{"type":47,"value":465},"Additional Cypress Component Config",{"type":42,"tag":313,"props":467,"children":468},{},[469],{"type":42,"tag":43,"props":470,"children":471},{},[472],{"type":47,"value":473},"We need a few more files to make Cypress happy.",{"type":42,"tag":43,"props":475,"children":476},{},[477],{"type":47,"value":478},"Create a cypress directory containing a component and a support directory in our root directory.",{"type":42,"tag":72,"props":480,"children":482},{"code":481},"├── nuxt-project/\n└── component/\n│ ├── Hello.cy.ts\n└── support/\n│ ├── component-index.html\n│ ├── component.ts\n",[483],{"type":42,"tag":53,"props":484,"children":485},{"__ignoreMap":6},[486],{"type":47,"value":481},{"type":42,"tag":238,"props":488,"children":489},{},[490],{"type":42,"tag":213,"props":491,"children":492},{},[493,499,501],{"type":42,"tag":494,"props":495,"children":496},"strong",{},[497],{"type":47,"value":498},"component-index.html",{"type":47,"value":500}," is the base HTML file that Cypress mounts our components to.\n",{"type":42,"tag":238,"props":502,"children":503},{},[504],{"type":42,"tag":213,"props":505,"children":506},{},[507],{"type":47,"value":508},"This file looks like so:",{"type":42,"tag":72,"props":510,"children":515},{"code":511,"language":512,"meta":6,"className":513},"// support/component-index.html\n\u003C!DOCTYPE html>\n\u003Chtml>\n  \u003Chead>\n    \u003Cmeta charset=\"utf-8\" />\n    \u003Cmeta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\" />\n    \u003Cmeta name=\"viewport\" content=\"width=device-width,initial-scale=1.0\" />\n    \u003Ctitle>Components App\u003C/title>\n  \u003C/head>\n  \u003Cbody>\n    \u003Cdiv data-cy-root>\u003C/div>\n  \u003C/body>\n\u003C/html>\n","html",[514],"language-html",[516],{"type":42,"tag":53,"props":517,"children":518},{"__ignoreMap":6},[519],{"type":47,"value":511},{"type":42,"tag":238,"props":521,"children":522},{},[523],{"type":42,"tag":213,"props":524,"children":525},{},[526,531],{"type":42,"tag":494,"props":527,"children":528},{},[529],{"type":47,"value":530},"component.ts",{"type":47,"value":532}," is where we write specific configurations for our component tests.",{"type":42,"tag":43,"props":534,"children":535},{},[536,538,544],{"type":47,"value":537},"This file will provide the ",{"type":42,"tag":53,"props":539,"children":541},{"className":540},[],[542],{"type":47,"value":543},"mount",{"type":47,"value":545}," function:",{"type":42,"tag":72,"props":547,"children":550},{"code":548,"language":375,"meta":6,"className":549},"// support/component.ts\nimport { mount } from 'cypress/vue'\n\ndeclare global {\n  namespace Cypress {\n    interface Chainable {\n      mount: typeof mount\n    }\n  }\n}\n\nCypress.Commands.add('mount', mount)\n",[377],[551],{"type":42,"tag":53,"props":552,"children":553},{"__ignoreMap":6},[554],{"type":47,"value":548},{"type":42,"tag":60,"props":556,"children":558},{"id":557},"running-the-component-test-runner",[559],{"type":47,"value":560},"Running the Component Test Runner",{"type":42,"tag":43,"props":562,"children":563},{},[564,566,572],{"type":47,"value":565},"When you run ",{"type":42,"tag":53,"props":567,"children":569},{"className":568},[],[570],{"type":47,"value":571},"npx cypress open",{"type":47,"value":573},", you should see the component test dashboard with a green configured button. Click it, then Chrome, then Start Component Testing in Chrome, and now we should see our spec runner.",{"type":42,"tag":43,"props":575,"children":576},{},[577],{"type":47,"value":578},"In our Nuxt project, let's create a basic component to test against.",{"type":42,"tag":43,"props":580,"children":581},{},[582,584,590],{"type":47,"value":583},"For funsies, I'm just creating a ",{"type":42,"tag":53,"props":585,"children":587},{"className":586},[],[588],{"type":47,"value":589},"Hello.vue",{"type":47,"value":591}," component with the following:",{"type":42,"tag":72,"props":593,"children":598},{"code":594,"language":595,"meta":6,"className":596},"// components/Hello.vue\n\u003Ctemplate>\n  \u003Cbutton>Hello World\u003C/button>\n\u003C/template>\n","vue",[597],"language-vue",[599],{"type":42,"tag":53,"props":600,"children":601},{"__ignoreMap":6},[602],{"type":47,"value":594},{"type":42,"tag":43,"props":604,"children":605},{},[606,608,614],{"type":47,"value":607},"I'm rendering this within my root ",{"type":42,"tag":53,"props":609,"children":611},{"className":610},[],[612],{"type":47,"value":613},"app.vue",{"type":47,"value":615}," file:",{"type":42,"tag":72,"props":617,"children":620},{"code":618,"language":595,"meta":6,"className":619},"// app.vue\n\u003Ctemplate>\n  \u003Cdiv>\n    \u003CHello />\n  \u003C/div>\n\u003C/template>\n",[597],[621],{"type":42,"tag":53,"props":622,"children":623},{"__ignoreMap":6},[624],{"type":47,"value":618},{"type":42,"tag":43,"props":626,"children":627},{},[628,630,636],{"type":47,"value":629},"Now we can mount this component in a cypress test. In our ",{"type":42,"tag":53,"props":631,"children":633},{"className":632},[],[634],{"type":47,"value":635},"cypress/component/Hello.cy.ts",{"type":47,"value":637}," file, paste the following:",{"type":42,"tag":72,"props":639,"children":642},{"code":640,"language":375,"meta":6,"className":641},"// cypress/component/Hello.cy.ts\nimport Hello from '../../components/Hello.vue'\n\ndescribe('Hello.cy', () => {\n  it('renders', () => {\n    cy.mount(Hello)\n  })\n})\n",[377],[643],{"type":42,"tag":53,"props":644,"children":645},{"__ignoreMap":6},[646],{"type":47,"value":640},{"type":42,"tag":60,"props":648,"children":650},{"id":649},"styling-our-components-with-tailwindcss-within-the-tests",[651],{"type":47,"value":652},"Styling Our Components with TailwindCSS Within the Tests",{"type":42,"tag":43,"props":654,"children":655},{},[656,658,665],{"type":47,"value":657},"You're probably using a library such as ",{"type":42,"tag":149,"props":659,"children":662},{"href":660,"rel":661},"https://tailwindcss.com/",[153],[663],{"type":47,"value":664},"TailwindCSS",{"type":47,"value":666}," to style your component. If that's the case, you'll notice your component isn't styled when running within the component test runner.",{"type":42,"tag":43,"props":668,"children":669},{},[670],{"type":47,"value":671},"Let's fix that.",{"type":42,"tag":43,"props":673,"children":674},{},[675,677,683,685,690],{"type":47,"value":676},"Every tutorial I found said I should be able to import my css file within my ",{"type":42,"tag":53,"props":678,"children":680},{"className":679},[],[681],{"type":47,"value":682},"cypress/support/component.ts",{"type":47,"value":684}," file or link to it using the ",{"type":42,"tag":53,"props":686,"children":688},{"className":687},[],[689],{"type":47,"value":498},{"type":47,"value":691}," file. I'm not sure why, but neither of these solutions worked for me.",{"type":42,"tag":43,"props":693,"children":694},{},[695,697,703],{"type":47,"value":696},"Instead, I needed to create a Cypress plugin for tailwind at ",{"type":42,"tag":53,"props":698,"children":700},{"className":699},[],[701],{"type":47,"value":702},"cypress/plugins/tailwind.ts",{"type":47,"value":704}," with the following:",{"type":42,"tag":72,"props":706,"children":709},{"code":707,"language":375,"meta":6,"className":708},"// cypress/support/component.ts\nbefore(() => {\n  cy.exec('npx tailwindcss -i ./assets/css/main.css -m').then(({ stdout }) => {\n    if (!document.head.querySelector('#tailwind-style')) {\n      const link = document.createElement('style')\n      link.id = 'tailwind-style'\n      link.innerHTML = stdout\n\n      document.head.appendChild(link)\n    }\n  })\n})\n",[377],[710],{"type":42,"tag":53,"props":711,"children":712},{"__ignoreMap":6},[713],{"type":47,"value":707},{"type":42,"tag":43,"props":715,"children":716},{},[717,719,724],{"type":47,"value":718},"Then import this plugin into your ",{"type":42,"tag":53,"props":720,"children":722},{"className":721},[],[723],{"type":47,"value":682},{"type":47,"value":615},{"type":42,"tag":72,"props":726,"children":729},{"code":727,"language":375,"meta":6,"className":728},"// cypress/support/component.ts\nimport { mount } from 'cypress/vue'\nimport '../plugins/tailwind'\n\ndeclare global {\n  namespace Cypress {\n    interface Chainable {\n      mount: typeof mount\n    }\n  }\n}\n\nCypress.Commands.add('mount', mount)\n",[377],[730],{"type":42,"tag":53,"props":731,"children":732},{"__ignoreMap":6},[733],{"type":47,"value":727},{"type":42,"tag":43,"props":735,"children":736},{},[737],{"type":47,"value":738},"From what I understand, this is compiling Tailwind and appending the css output to a style tag that is then loaded into the component test runner's HTML.",{"type":42,"tag":43,"props":740,"children":741},{},[742],{"type":47,"value":743},"This does create a bit of lag, but it's the only way I've been able to solve this problem.",{"type":42,"tag":60,"props":745,"children":747},{"id":746},"source-code",[748],{"type":47,"value":749},"Source Code",{"type":42,"tag":43,"props":751,"children":752},{},[753,755,762],{"type":47,"value":754},"You can view the code for this project at this ",{"type":42,"tag":149,"props":756,"children":759},{"href":757,"rel":758},"https://github.com/CodyBontecou/cypress-component-testing-with-nuxt-3",[153],[760],{"type":47,"value":761},"repository",{"type":47,"value":115},{"title":6,"searchDepth":279,"depth":279,"links":764},[765,766,767,771,772,773],{"id":323,"depth":279,"text":326},{"id":340,"depth":279,"text":343},{"id":355,"depth":279,"text":358,"children":768},[769],{"id":462,"depth":770,"text":465},3,{"id":557,"depth":279,"text":560},{"id":649,"depth":279,"text":652},{"id":746,"depth":279,"text":749},"content:cypress-component-testing-with-nuxt-3.md","cypress-component-testing-with-nuxt-3.md",{"_path":777,"_dir":6,"_draft":7,"_partial":7,"_locale":6,"title":778,"description":779,"type":10,"author":780,"date":781,"last_modified_date":781,"slug":782,"dropdown":783,"topics":784,"meta":787,"canonicalUrl":795,"created_at":36,"last_modified":37,"body":796,"_type":284,"_id":974,"_source":286,"_file":975,"_stem":782,"_extension":288},"/lets-setup-nuxt-3-with-cypress","Lets setup Nuxt 3 with Cypress","Cypress is an excellent E2E testing tool. Let's set it up in a fresh Nuxt 3 project to connect two modern web tools.",{"name":12,"image":294},"2023-02-02T00:00:00.000Z","lets-setup-nuxt-3-with-cypress","NuxtJS",[785,786,595,34],"nuxt","cypress",[788,789,791,792,793,794],{"name":19,"content":779},{"name":21,"content":790},"https://codybontecou.com/images/lets-setup-nuxt-3-with-cypress.png",{"name":24,"content":779},{"name":26,"content":778},{"name":28,"content":778},{"name":30,"content":778},"https://codybontecou.com/lets-setup-nuxt-3-with-cypress.html",{"type":39,"children":797,"toc":969},[798,806,819,824,828,836,840,849,884,890,902,923,934,945,950,955],{"type":42,"tag":313,"props":799,"children":800},{},[801],{"type":42,"tag":43,"props":802,"children":803},{},[804],{"type":47,"value":805},"This is a quick guide on setting up Cypress End-to-End Testing with Nuxt 3.",{"type":42,"tag":43,"props":807,"children":808},{},[809,811,817],{"type":47,"value":810},"I noticed ",{"type":42,"tag":149,"props":812,"children":815},{"href":813,"rel":814},"https://github.com/cypress-io/cypress/discussions/21184",[153],[816],{"type":47,"value":448},{"type":47,"value":818}," about users struggling to get Cypress working with Nuxt 3.",{"type":42,"tag":43,"props":820,"children":821},{},[822],{"type":47,"value":823},"I found the setup straightforward and decided to share how to do it.",{"type":42,"tag":60,"props":825,"children":826},{"id":323},[827],{"type":47,"value":326},{"type":42,"tag":72,"props":829,"children":831},{"className":830,"code":329,"language":330,"meta":6},[332],[832],{"type":42,"tag":53,"props":833,"children":834},{"__ignoreMap":6},[835],{"type":47,"value":329},{"type":42,"tag":60,"props":837,"children":838},{"id":340},[839],{"type":47,"value":343},{"type":42,"tag":72,"props":841,"children":844},{"className":842,"code":843,"language":330,"meta":6},[332],"npm install cypress --save-dev\nnpx cypress open\n",[845],{"type":42,"tag":53,"props":846,"children":847},{"__ignoreMap":6},[848],{"type":47,"value":843},{"type":42,"tag":43,"props":850,"children":851},{},[852,854,859,861,867,869,875,877,883],{"type":47,"value":853},"Running ",{"type":42,"tag":53,"props":855,"children":857},{"className":856},[],[858],{"type":47,"value":571},{"type":47,"value":860}," should spawn the cypress test runner. Click ",{"type":42,"tag":53,"props":862,"children":864},{"className":863},[],[865],{"type":47,"value":866},"E2E Testing",{"type":47,"value":868},", then ",{"type":42,"tag":53,"props":870,"children":872},{"className":871},[],[873],{"type":47,"value":874},"Chrome",{"type":47,"value":876}," for the browser option, and then click ",{"type":42,"tag":53,"props":878,"children":880},{"className":879},[],[881],{"type":47,"value":882},"Start E2E Testing in Chrome",{"type":47,"value":115},{"type":42,"tag":60,"props":885,"children":887},{"id":886},"cypress-e2e-tests",[888],{"type":47,"value":889},"Cypress E2E Tests",{"type":42,"tag":43,"props":891,"children":892},{},[893,895,900],{"type":47,"value":894},"During the Cypress initialization, the ",{"type":42,"tag":53,"props":896,"children":898},{"className":897},[],[899],{"type":47,"value":786},{"type":47,"value":901}," folder should have been created.",{"type":42,"tag":43,"props":903,"children":904},{},[905,907,913,915,921],{"type":47,"value":906},"By default, Cypress looks for any ",{"type":42,"tag":53,"props":908,"children":910},{"className":909},[],[911],{"type":47,"value":912},"*.cy.*",{"type":47,"value":914}," file within your ",{"type":42,"tag":53,"props":916,"children":918},{"className":917},[],[919],{"type":47,"value":920},"cypress/e2e",{"type":47,"value":922}," directory.",{"type":42,"tag":43,"props":924,"children":925},{},[926,928],{"type":47,"value":927},"For simplicity's sake, I have the following test in ",{"type":42,"tag":53,"props":929,"children":931},{"className":930},[],[932],{"type":47,"value":933},"cypress/e2e/spec.cy.js",{"type":42,"tag":72,"props":935,"children":940},{"className":936,"code":938,"language":939,"meta":6},[937],"language-js","// cypress/e2e/spec.cy.js\ndescribe('template spec', () => {\n  it('passes', () => {\n    cy.visit('http://localhost:3000/')\n  })\n})\n","js",[941],{"type":42,"tag":53,"props":942,"children":943},{"__ignoreMap":6},[944],{"type":47,"value":938},{"type":42,"tag":43,"props":946,"children":947},{},[948],{"type":47,"value":949},"This test should pass while your Nuxt 3 application runs on port 3000. It just opens the browser and asserts it loaded.",{"type":42,"tag":43,"props":951,"children":952},{},[953],{"type":47,"value":954},"And that's it. We now have Cypress E2E tests running against our Nuxt 3 application. Hope you enjoyed.",{"type":42,"tag":43,"props":956,"children":957},{},[958,960,967],{"type":47,"value":959},"Here's the ",{"type":42,"tag":149,"props":961,"children":964},{"href":962,"rel":963},"https://github.com/CodyBontecou/lets-setup-nuxt-3-with-cypress",[153],[965],{"type":47,"value":966},"Github Repo",{"type":47,"value":968}," for reference.",{"title":6,"searchDepth":279,"depth":279,"links":970},[971,972,973],{"id":323,"depth":279,"text":326},{"id":340,"depth":279,"text":343},{"id":886,"depth":279,"text":889},"content:lets-setup-nuxt-3-with-cypress.md","lets-setup-nuxt-3-with-cypress.md",{"_path":977,"_dir":6,"_draft":7,"_partial":7,"_locale":6,"title":978,"description":979,"type":10,"author":980,"date":981,"category":982,"dropdown":983,"tags":984,"meta":988,"canonicalUrl":997,"topics":998,"created_at":36,"last_modified":37,"body":999,"_type":284,"_id":1403,"_source":286,"_file":1404,"_stem":1405,"_extension":288},"/mocking-api-with-msw-and-typescript","Mocking an API request with Mock Service Worker and Typescript","Use mswjs - Mock Service Worker - to mock an API request to Medium's API within a Typescript project.",{"name":12,"image":294},"2020-07-25T00:00:00.000Z","tutorials","NodeJS",[985,986,987,985],"mswjs","Code","Automated Testing",[989,990,991,993,995,996],{"name":26,"content":978},{"name":19,"content":979},{"name":21,"content":992},"https://codybontecou.com/images/MSW-Meta.png",{"name":24,"content":994},"Illustration of a man with a baret waving his hands with Reddit and Typescript logos above him",{"name":28,"content":978},{"name":30,"content":978},"https://codybontecou.com/mocking-api-with-msw-and-typescript.html",[985,34,35],{"type":39,"children":1000,"toc":1393},[1001,1009,1023,1028,1033,1045,1051,1065,1079,1085,1097,1110,1115,1124,1129,1138,1185,1191,1205,1215,1228,1237,1243,1248,1260,1265,1270,1279,1284,1295,1304,1310,1315,1324,1334,1354,1363,1367,1372,1377,1381],{"type":42,"tag":313,"props":1002,"children":1003},{},[1004],{"type":42,"tag":43,"props":1005,"children":1006},{},[1007],{"type":47,"value":1008},"Testing software is essential to the development cycle of building applications. A strong test suite gives the developer(s) a sense of freedom to organize and refactor the codebase as needed without fear of unknowingly breaking something.",{"type":42,"tag":43,"props":1010,"children":1011},{},[1012,1014,1021],{"type":47,"value":1013},"I'm using ",{"type":42,"tag":149,"props":1015,"children":1018},{"href":1016,"rel":1017},"https://github.com/CodyBontecou/blogflow.io/",[153],[1019],{"type":47,"value":1020},"Blogflow.io",{"type":47,"value":1022}," as a means to learn Typescript while simultaneously building a tool to help automate distributing blog posts throughout the web.",{"type":42,"tag":43,"props":1024,"children":1025},{},[1026],{"type":47,"value":1027},"A large portion of this application requires integrating 3rd party APIs to communicate with services such as Medium, Hashnode, Reddit, etc.",{"type":42,"tag":43,"props":1029,"children":1030},{},[1031],{"type":47,"value":1032},"It's tough to test against 3rd party APIs. We don't want to hit their endpoints every time we run our test suite. Instead, we choose to mock the response, making the assumption that given specific inputs, they API will output a specific response.",{"type":42,"tag":43,"props":1034,"children":1035},{},[1036,1043],{"type":42,"tag":149,"props":1037,"children":1040},{"href":1038,"rel":1039},"https://mswjs.io/",[153],[1041],{"type":47,"value":1042},"Mock Service Worker (MSW)",{"type":47,"value":1044}," provides a simple way to intercept these API calls so that our tests aren't hitting 3rd party endpoints and interacting with live data.",{"type":42,"tag":60,"props":1046,"children":1048},{"id":1047},"setup-and-installation",[1049],{"type":47,"value":1050},"Setup and Installation",{"type":42,"tag":43,"props":1052,"children":1053},{},[1054,1056,1063],{"type":47,"value":1055},"I was going to walk you through setting MSW up but they provide such clear ",{"type":42,"tag":149,"props":1057,"children":1060},{"href":1058,"rel":1059},"https://mswjs.io/docs/getting-started/install",[153],[1061],{"type":47,"value":1062},"documentation",{"type":47,"value":1064}," that I think doing anything besides linking you to them would be an injustice.",{"type":42,"tag":43,"props":1066,"children":1067},{},[1068,1070,1077],{"type":47,"value":1069},"You're welcome to view my ",{"type":42,"tag":149,"props":1071,"children":1074},{"href":1072,"rel":1073},"https://github.com/CodyBontecou/blogflow.io",[153],[1075],{"type":47,"value":1076},"repo",{"type":47,"value":1078}," if you would like to see how I set it up in my project alongside packages like dotenv and Typescript.",{"type":42,"tag":60,"props":1080,"children":1082},{"id":1081},"mocking-mediums-api",[1083],{"type":47,"value":1084},"Mocking Medium's API",{"type":42,"tag":43,"props":1086,"children":1087},{},[1088,1090,1095],{"type":47,"value":1089},"Everything below assumes you followed the ",{"type":42,"tag":149,"props":1091,"children":1093},{"href":1092},"#installation",[1094],{"type":47,"value":1050},{"type":47,"value":1096}," or have an understanding of MSW.",{"type":42,"tag":43,"props":1098,"children":1099},{},[1100,1102,1109],{"type":47,"value":1101},"In order to mock Medium's Create a Post request, I checked their API ",{"type":42,"tag":149,"props":1103,"children":1106},{"href":1104,"rel":1105},"https://github.com/Medium/medium-api-docs#32-publications",[153],[1107],{"type":47,"value":1108},"here",{"type":47,"value":115},{"type":42,"tag":43,"props":1111,"children":1112},{},[1113],{"type":47,"value":1114},"They provide an example response:",{"type":42,"tag":72,"props":1116,"children":1119},{"className":1117,"code":1118,"language":939,"meta":6},[937],"HTTP/1.1 201 OK\nContent-Type: application/json; charset=utf-8\n\n{\n  \"data\": {\n    \"id\": \"e6f36a\",\n    \"title\": \"Liverpool FC\",\n    \"authorId\": \"5303d74c64f66366f00cb9b2a94f3251bf5\",\n    \"tags\": [\"football\", \"sport\", \"Liverpool\"],\n    \"url\": \"https://medium.com/@majelbstoat/liverpool-fc-e6f36a\",\n    \"canonicalUrl\": \"http://jamietalbot.com/posts/liverpool-fc\",\n    \"publishStatus\": \"public\",\n    \"publishedAt\": 1442286338435,\n    \"license\": \"all-rights-reserved\",\n    \"licenseUrl\": \"https://medium.com/policy/9db0094a1e0f\"\n  }\n",[1120],{"type":42,"tag":53,"props":1121,"children":1122},{"__ignoreMap":6},[1123],{"type":47,"value":1118},{"type":42,"tag":43,"props":1125,"children":1126},{},[1127],{"type":47,"value":1128},"Mocking this with MSW was simple. It was nearly a copy paste:",{"type":42,"tag":72,"props":1130,"children":1133},{"className":1131,"code":1132,"language":375,"meta":6},[377],"//  src/mocks/handlers.ts\n\nimport { rest } from 'msw'\n\nexport const handlers = [\n1. rest.post('https://api.medium.com/*', (req, res, ctx) => {\n    return res(\n2.    ctx.status(201),\n3.    ctx.json({\n        data: {\n          id: 'e6f36a',\n          title: 'Liverpool FC',\n          authorId: '5303d74c64f66366f00cb9b2a94f3251bf5',\n          tags: ['football', 'sport', 'Liverpool'],\n          url: 'https://medium.com/@majelbstoat/liverpool-fc-e6f36a',\n          canonicalUrl: 'http://jamietalbot.com/posts/liverpool-fc',\n          publishStatus: 'public',\n          publishedAt: 1442286338435,\n          license: 'all-rights-reserved',\n          licenseUrl: 'https://medium.com/policy/9db0094a1e0f',\n        },\n      })\n    )\n  }),\n]\n",[1134],{"type":42,"tag":53,"props":1135,"children":1136},{"__ignoreMap":6},[1137],{"type":47,"value":1132},{"type":42,"tag":209,"props":1139,"children":1140},{},[1141,1175,1180],{"type":42,"tag":213,"props":1142,"children":1143},{},[1144,1146,1152,1153,1157,1159,1165,1167,1173],{"type":47,"value":1145},"I set this handler to intercept POST requests to any URL that starts with ",{"type":42,"tag":53,"props":1147,"children":1149},{"className":1148},[],[1150],{"type":47,"value":1151},"https://api.medium.com/*",{"type":47,"value":115},{"type":42,"tag":1154,"props":1155,"children":1156},"br",{},[],{"type":47,"value":1158},"The ",{"type":42,"tag":53,"props":1160,"children":1162},{"className":1161},[],[1163],{"type":47,"value":1164},"*",{"type":47,"value":1166}," represents a wildcard meaning anytime my application attempts to send a POST request to a URL starting with ",{"type":42,"tag":149,"props":1168,"children":1171},{"href":1169,"rel":1170},"https://api.medium.com/",[153],[1172],{"type":47,"value":1169},{"type":47,"value":1174},", it will intercept it and return the provided response at 3.",{"type":42,"tag":213,"props":1176,"children":1177},{},[1178],{"type":47,"value":1179},"We are setting the HTTP response status code we'd like to test against.",{"type":42,"tag":213,"props":1181,"children":1182},{},[1183],{"type":47,"value":1184},"This is where we define the JSON response that we wish to be returned from the POST request.",{"type":42,"tag":60,"props":1186,"children":1188},{"id":1187},"edge-cases",[1189],{"type":47,"value":1190},"Edge cases",{"type":42,"tag":43,"props":1192,"children":1193},{},[1194,1196,1203],{"type":47,"value":1195},"Certain packages require additional configuration. These are primarily ",{"type":42,"tag":149,"props":1197,"children":1200},{"href":1198,"rel":1199},"https://jestjs.io/",[153],[1201],{"type":47,"value":1202},"jest",{"type":47,"value":1204}," issues rather than MSW, but I ran into them while setting this up. I decided to document it incase anyone else runs into these issues like I did.",{"type":42,"tag":460,"props":1206,"children":1208},{"id":1207},"dotenv",[1209],{"type":42,"tag":149,"props":1210,"children":1213},{"href":1211,"rel":1212},"https://github.com/motdotla/dotenv",[153],[1214],{"type":47,"value":1207},{"type":42,"tag":43,"props":1216,"children":1217},{},[1218,1220,1226],{"type":47,"value":1219},"Within your ",{"type":42,"tag":53,"props":1221,"children":1223},{"className":1222},[],[1224],{"type":47,"value":1225},"jest.config.ts",{"type":47,"value":1227}," file, make sure you have the following:",{"type":42,"tag":72,"props":1229,"children":1232},{"className":1230,"code":1231,"language":939,"meta":6},[937],"// jest.config.ts\nmodule.exports = {\n  setupFiles: ['dotenv/config'],\n}\n",[1233],{"type":42,"tag":53,"props":1234,"children":1235},{"__ignoreMap":6},[1236],{"type":47,"value":1231},{"type":42,"tag":460,"props":1238,"children":1240},{"id":1239},"setuptests-file",[1241],{"type":47,"value":1242},"setupTests file",{"type":42,"tag":43,"props":1244,"children":1245},{},[1246],{"type":47,"value":1247},"You'll need to set up your jest tests to listen, reset, and close the MSW server.",{"type":42,"tag":43,"props":1249,"children":1250},{},[1251,1253,1259],{"type":47,"value":1252},"If you use Create React App, you may already have a file named ",{"type":42,"tag":53,"props":1254,"children":1256},{"className":1255},[],[1257],{"type":47,"value":1258},"src/setupTests.js",{"type":47,"value":115},{"type":42,"tag":43,"props":1261,"children":1262},{},[1263],{"type":47,"value":1264},"Otherwise, you'll need to create a setup file yourself.",{"type":42,"tag":43,"props":1266,"children":1267},{},[1268],{"type":47,"value":1269},"Then, add in the following code:",{"type":42,"tag":72,"props":1271,"children":1274},{"className":1272,"code":1273,"language":375,"meta":6},[377],"// src/setupTests.js\nimport { server } from './mocks/server.js'\n\n// Establish API mocking before all tests.\nbeforeAll(() => server.listen())\n\n// Reset any request handlers that we may add during the tests,\n// so they don't affect other tests.\nafterEach(() => server.resetHandlers())\n\n// Clean up after the tests are finished.\nafterAll(() => server.close())\n",[1275],{"type":42,"tag":53,"props":1276,"children":1277},{"__ignoreMap":6},[1278],{"type":47,"value":1273},{"type":42,"tag":43,"props":1280,"children":1281},{},[1282],{"type":47,"value":1283},"This sets your Jest testing environment up to start the MSW server, reset it, and close it after different stages of the Jest lifecycle.",{"type":42,"tag":43,"props":1285,"children":1286},{},[1287,1289,1294],{"type":47,"value":1288},"You'll then want to add a line to your ",{"type":42,"tag":53,"props":1290,"children":1292},{"className":1291},[],[1293],{"type":47,"value":1225},{"type":47,"value":615},{"type":42,"tag":72,"props":1296,"children":1299},{"className":1297,"code":1298,"language":375,"meta":6},[377],"// jest.config.ts\nmodule.exports = {\n  setupFilesAfterEnv: ['\u003CrootDir>/src/setupTests.ts'],\n}\n",[1300],{"type":42,"tag":53,"props":1301,"children":1302},{"__ignoreMap":6},[1303],{"type":47,"value":1298},{"type":42,"tag":460,"props":1305,"children":1307},{"id":1306},"error-enoent-no-such-file-or-directory-open-file",[1308],{"type":47,"value":1309},"Error: ENOENT: no such file or directory, open \"file\"",{"type":42,"tag":43,"props":1311,"children":1312},{},[1313],{"type":47,"value":1314},"I'm reading markdown files in Blogflow. Before writing my tests, I was using relative paths like so:",{"type":42,"tag":72,"props":1316,"children":1319},{"className":1317,"code":1318,"language":939,"meta":6},[937],"const data = matter(readFile('./file.md'))\n",[1320],{"type":42,"tag":53,"props":1321,"children":1322},{"__ignoreMap":6},[1323],{"type":47,"value":1318},{"type":42,"tag":43,"props":1325,"children":1326},{},[1327,1329],{"type":47,"value":1328},"My tests didn't like that and threw the error ",{"type":42,"tag":53,"props":1330,"children":1332},{"className":1331},[],[1333],{"type":47,"value":1309},{"type":42,"tag":43,"props":1335,"children":1336},{},[1337,1344,1346,1352],{"type":42,"tag":149,"props":1338,"children":1341},{"href":1339,"rel":1340},"https://stackoverflow.com/a/59179782/6642089",[153],[1342],{"type":47,"value":1343},"This",{"type":47,"value":1345}," Stackoverflow post explained I needed to use ",{"type":42,"tag":53,"props":1347,"children":1349},{"className":1348},[],[1350],{"type":47,"value":1351},"_dirname",{"type":47,"value":1353},". This code now looks like the snippet below. Now my tests and code run as expected.",{"type":42,"tag":72,"props":1355,"children":1358},{"className":1356,"code":1357,"language":939,"meta":6},[937],"const data = matter(readFile(__dirname + '/file.md'))\n",[1359],{"type":42,"tag":53,"props":1360,"children":1361},{"__ignoreMap":6},[1362],{"type":47,"value":1357},{"type":42,"tag":60,"props":1364,"children":1365},{"id":261},[1366],{"type":47,"value":264},{"type":42,"tag":43,"props":1368,"children":1369},{},[1370],{"type":47,"value":1371},"This is all fairly new to me, but I believe there is value in this sort of testing.",{"type":42,"tag":43,"props":1373,"children":1374},{},[1375],{"type":47,"value":1376},"One immediate case is mocking response's that are loaded into components. It's tough to get every state through live data. It's much easier to mock certain HTTP status codes and response objects that will change the way a component is rendered.",{"type":42,"tag":1378,"props":1379,"children":1380},"hr",{},[],{"type":42,"tag":43,"props":1382,"children":1383},{},[1384,1386],{"type":47,"value":1385},"I hope this article was helpful. Let me know if you have any questions, comments, or suggestions on Twitter ",{"type":42,"tag":149,"props":1387,"children":1390},{"href":1388,"rel":1389},"https://twitter.com/CodyBontecou",[153],[1391],{"type":47,"value":1392},"@codybontecou",{"title":6,"searchDepth":279,"depth":279,"links":1394},[1395,1396,1397,1402],{"id":1047,"depth":279,"text":1050},{"id":1081,"depth":279,"text":1084},{"id":1187,"depth":279,"text":1190,"children":1398},[1399,1400,1401],{"id":1207,"depth":770,"text":1207},{"id":1239,"depth":770,"text":1242},{"id":1306,"depth":770,"text":1309},{"id":261,"depth":279,"text":264},"content:mocking-api-with-msw-and-typescript.md","mocking-api-with-msw-and-typescript.md","mocking-api-with-msw-and-typescript",1732246651067]